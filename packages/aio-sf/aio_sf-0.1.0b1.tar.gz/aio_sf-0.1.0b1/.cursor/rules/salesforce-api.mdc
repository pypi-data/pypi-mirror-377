---
description: "Salesforce API integration patterns and best practices"
---

# Salesforce API Integration Patterns

## Authentication Flow
1. **Client Credentials** (Recommended): Use OAuth client credentials flow
2. **Static Token**: Use existing access token
3. **Refresh Token**: Use refresh token to obtain access tokens

## Bulk API 2.0 Usage
- Use for large data queries (>2000 records)
- Supports both sync and async query execution
- Handles pagination automatically via locators
- Provides resume capability for interrupted queries

## Schema Handling
```python
# Get field metadata for proper type mapping
fields_metadata = await get_bulk_fields(sf, 'Contact')
schema = create_schema_from_metadata(fields_metadata)

# Schema automatically filters to match query fields
query_result = await bulk_query(sf, "SELECT Id, Name FROM Contact")
await write_query_to_parquet_async(query_result, "contacts.parquet", schema=schema)
```

## Type Mapping
- Salesforce types â†’ PyArrow types automatically handled
- Support for: string, boolean, int, double, currency, percent, date, datetime, reference, picklist, id
- Empty strings converted to null when `convert_empty_to_null=True`

## API Versioning
- Default: v60.0
- Configurable per connection
- Consistent across all API calls within a connection
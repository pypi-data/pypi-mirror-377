# ChangeLog

## v0.3.0 以来的变更 (48 commits)

基于git commit分析，以下是0.3.0版本以来的主要变更说明：

## 核心功能增强

### 1. 命令行参数扩展
- **新增 --run 参数**: 增加新的命令行运行参数 (47687ca)

### 2. 上下文管理重构 
- **上下文系统重构**: 全面重构上下文管理机制 (31c0200, eedac5c)
- **修补context命令**: 修复和改进 /context 和 /plugin 命令 (2361f3d, 12255c9)

### 3. 任务执行系统改进
- **任务状态管理**: 重构任务状态保存和重放功能 (fc11c1e, 267f0f0)
- **数据对象分离**: 实现数据和对象的分离架构 (ec01d76)
- **执行结果对象**: 定义新的执行结果对象结构 (57ad7c4)

## 技术架构升级

### 4. 事件系统重构
- **强类型事件系统**: 实现新的强类型事件系统 (dd67b53, 4b49fa3)
- **ToolCall机制**: 重构工具调用机制 (fc11c1e, 280adac)
- **事件名称调整**: 统一事件命名规范 (9d656e5, 368a14a)

### 5. MCP集成
- **MCP客户端**: 集成MCP(Model Context Protocol)客户端 (ccb0216, df1afcd)
- **更新MCP库**: 升级libmcp依赖 (fef064b, 51ab6e4)
- **错误处理**: 改进MCP相关错误处理 (ef6b341)

### 6. 代码质量提升
- **代码清理**: 大量代码清理和重构工作 (36c92f0, 931593d, bc5c983)
- **接口重构**: 重构核心接口设计 (1f735f7)
- **缓存修复**: 修复缓存相关问题 (529a702)

## 功能增强

### 7. Agent模式改进
- **实时数据接口**: 为agent模式增加实时数据获取接口 (36b07ab)
- **兼容性提升**: 增加向后兼容性支持 (158bd3b)

### 8. 命令修复
- **修补多个命令**: 修复 /block、/step 等命令 (1d88f76, 5477e99)
- **自定义命令**: 改进自定义命令提示功能 (8a34787)

### 9. 其他改进
- **权限处理**: 处理权限相关问题 (cc526ab)
- **错误日志**: 改进错误日志机制 (cec2a70)
- **代码块编辑**: 修改代码块编辑实现 (bd11b4e, 280adac)

## 版本整合
- **版本合并**: 将version/0.4.0分支合并到knownsec (e5c9190)
- **社区贡献**: 合并来自社区的PR #111和其他贡献 (384b1df, ef6b341)

## 总结

总体而言，0.3.0以来的更新主要集中在：
1. **架构重构**: 全面重构上下文管理和事件系统
2. **系统集成**: 集成MCP协议支持
3. **代码质量**: 大量代码清理和重构工作
4. **功能完善**: 改进命令行参数、Agent模式等功能

这些更新为系统的稳定性、扩展性和维护性奠定了更好的基础。
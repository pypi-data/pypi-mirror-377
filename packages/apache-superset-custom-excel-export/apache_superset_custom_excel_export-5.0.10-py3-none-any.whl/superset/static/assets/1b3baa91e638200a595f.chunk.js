"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[4169],{87320:(e,t,a)=>{a.r(t),a.d(t,{default:()=>K});var d,s=a(2445),i=a(95579),l=a(72234),o=a(35742),r=a(27366),n=a(61225),c=a(96540),u=a(71519),h=a(58561),b=a.n(h),m=a(30703),g=a(50500),p=a(41933),y=a(88461),_=a(25627),f=a(83197),S=a(97470),w=a(27395),v=a(52879),T=a(44344),k=a(4780),D=a(51713),F=a(62221),Y=a(5261),C=a(38380),A=a(73312),H=a(23193),I=a(69088),z=a(97183),P=a(58998);!function(e){e.PUBLISHED="published",e.DRAFT="draft"}(d||(d={}));var O=a(84666),x=a(79099),B=a(7464);const M=(0,i.t)('The passwords for the databases below are needed in order to import them together with the dashboards. Please note that the "Secure Extra" and "Certificate" sections of the database configuration are not present in export files, and should be added manually after the import if they are needed.'),E=(0,i.t)("You are importing one or more dashboards that already exist. Overwriting might cause you to lose some of your work. Are you sure you want to overwrite?"),L=l.I4.div`
  color: ${({theme:e})=>e.colors.grayscale.base};
`,N=["id","dashboard_title","published","url","slug","changed_by","changed_by.id","changed_by.first_name","changed_by.last_name","changed_on_delta_humanized","owners","owners.id","owners.first_name","owners.last_name","tags.id","tags.name","tags.type","status","certified_by","certification_details","changed_on"],K=(0,Y.Ay)((function(e){var t;const{addDangerToast:a,addSuccessToast:l,user:h}=e,{roles:Y}=(0,n.d4)((e=>e.user)),K=(0,O.L)("can_read","Tag",Y),{state:{loading:R,resourceCount:G,resourceCollection:U,bulkSelectEnabled:j},setResourceCollection:J,hasPerm:W,fetchData:$,toggleBulkSelect:V,refreshData:q}=(0,g.RU)("dashboard",(0,i.t)("dashboard"),a,void 0,void 0,void 0,void 0,N),X=(0,c.useMemo)((()=>U.map((e=>e.id))),[U]),[Q,Z]=(0,g.oG)("dashboard",X,a),[ee,te]=(0,c.useState)(null),[ae,de]=(0,c.useState)(null),[se,ie]=(0,c.useState)(!1),[le,oe]=(0,c.useState)([]),[re,ne]=(0,c.useState)(!1),[ce,ue]=(0,c.useState)([]),[he,be]=(0,c.useState)([]),[me,ge]=(0,c.useState)([]),pe=(0,F.SX)(null==h||null==(t=h.userId)?void 0:t.toString(),null),ye=W("can_write"),_e=W("can_write"),fe=W("can_write"),Se=W("can_export"),we=[{id:"changed_on_delta_humanized",desc:!0}];function ve(e){te(e)}function Te(e){return o.A.get({endpoint:`/api/v1/dashboard/${e.id}`}).then((({json:e={}})=>{J(U.map((t=>{var a;if(t.id===(null==e||null==(a=e.result)?void 0:a.id)){const{changed_by_name:a,changed_by:d,dashboard_title:s="",slug:i="",json_metadata:l="",changed_on_delta_humanized:o,url:r="",certified_by:n="",certification_details:c="",owners:u,tags:h}=e.result;return{...t,changed_by_name:a,changed_by:d,dashboard_title:s,slug:i,json_metadata:l,changed_on_delta_humanized:o,url:r,certified_by:n,certification_details:c,owners:u,tags:h}}return t})))}),(0,m.JF)((e=>a((0,i.t)("An error occurred while fetching dashboards: %s",e)))))}const ke=e=>{const t=e.map((({id:e})=>e));(0,k.A)("dashboard",t,(()=>{ne(!1)})),ne(!0)},De=(0,c.useMemo)((()=>[{Cell:({row:{original:{id:e}}})=>(null==h?void 0:h.userId)&&(0,s.Y)(p.$,{itemId:e,saveFaveStar:Q,isStarred:Z[e]}),Header:"",id:"id",disableSortBy:!0,size:"xs",hidden:!(null!=h&&h.userId)},{Cell:({row:{original:{url:e,dashboard_title:t,certified_by:a,certification_details:d}}})=>(0,s.FD)(u.N_,{to:e,title:t,children:[a&&(0,s.FD)(s.FK,{children:[(0,s.Y)(y.T,{certifiedBy:a,details:d})," "]}),t]}),Header:(0,i.t)("Name"),accessor:"dashboard_title",id:"dashboard_title"},{Cell:({row:{original:{status:e}}})=>(0,s.Y)(_.x,{isPublished:e===d.PUBLISHED}),Header:(0,i.t)("Status"),accessor:"published",size:"xl",id:"published"},{Cell:({row:{original:{tags:e=[]}}})=>(0,s.Y)(T.Sk,{tags:e.filter((e=>"TagTypes.custom"===e.type||e.type===I.U.Custom)),maxTags:3}),Header:(0,i.t)("Tags"),accessor:"tags",disableSortBy:!0,hidden:!(0,r.G7)(r.TO.TaggingSystem),id:"tags"},{Cell:({row:{original:{owners:e=[]}}})=>(0,s.Y)(T.WM,{users:e}),Header:(0,i.t)("Owners"),accessor:"owners",disableSortBy:!0,size:"xl",id:"owners"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:t}}})=>(0,s.Y)(T.UW,{date:e,user:t}),Header:(0,i.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl",id:"changed_on_delta_humanized"},{Cell:({row:{original:e}})=>(0,s.FD)(L,{className:"actions",children:[fe&&(0,s.Y)(f.h,{title:(0,i.t)("Please confirm"),description:(0,s.FD)(s.FK,{children:[(0,i.t)("Are you sure you want to delete")," ",(0,s.Y)("b",{children:e.dashboard_title}),"?"]}),onConfirm:()=>(0,m.yT)(e,q,l,a),children:e=>(0,s.Y)(S.m,{id:"delete-action-tooltip",title:(0,i.t)("Delete"),placement:"bottom",children:(0,s.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:e,children:(0,s.Y)(C.F.DeleteOutlined,{iconSize:"l","data-test":"dashboard-list-trash-icon"})})})}),Se&&(0,s.Y)(S.m,{id:"export-action-tooltip",title:(0,i.t)("Export"),placement:"bottom",children:(0,s.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>ke([e]),children:(0,s.Y)(C.F.UploadOutlined,{iconSize:"l"})})}),_e&&(0,s.Y)(S.m,{id:"edit-action-tooltip",title:(0,i.t)("Edit"),placement:"bottom",children:(0,s.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>ve(e),children:(0,s.Y)(C.F.EditOutlined,{"data-test":"edit-alt",iconSize:"l"})})})]}),Header:(0,i.t)("Actions"),id:"actions",hidden:!_e&&!fe&&!Se,disableSortBy:!0},{accessor:H.H.ChangedBy,hidden:!0,id:H.H.ChangedBy}]),[null==h?void 0:h.userId,_e,fe,Se,Q,Z,q,l,a]),Fe=(0,c.useMemo)((()=>({Header:(0,i.t)("Favorite"),key:"favorite",id:"id",urlDisplay:"favorite",input:"select",operator:T.c0.DashboardIsFav,unfilteredLabel:(0,i.t)("Any"),selects:[{label:(0,i.t)("Yes"),value:!0},{label:(0,i.t)("No"),value:!1}]})),[]),Ye=(0,c.useMemo)((()=>[{Header:(0,i.t)("Name"),key:"search",id:"dashboard_title",input:"search",operator:T.c0.TitleOrSlug},{Header:(0,i.t)("Status"),key:"published",id:"published",input:"select",operator:T.c0.Equals,unfilteredLabel:(0,i.t)("Any"),selects:[{label:(0,i.t)("Published"),value:!0},{label:(0,i.t)("Draft"),value:!1}]},...(0,r.G7)(r.TO.TaggingSystem)&&K?[{Header:(0,i.t)("Tag"),key:"tags",id:"tags",input:"select",operator:T.c0.DashboardTagById,unfilteredLabel:(0,i.t)("All"),fetchSelects:z.m}]:[],{Header:(0,i.t)("Owner"),key:"owner",id:"owners",input:"select",operator:T.c0.RelationManyMany,unfilteredLabel:(0,i.t)("All"),fetchSelects:(0,m.u1)("dashboard","owners",(0,m.JF)((e=>a((0,i.t)("An error occurred while fetching dashboard owner values: %s",e)))),e.user),paginate:!0,dropdownStyle:{minWidth:B.f8}},...null!=h&&h.userId?[Fe]:[],{Header:(0,i.t)("Certified"),key:"certified",id:"id",urlDisplay:"certified",input:"select",operator:T.c0.DashboardIsCertified,unfilteredLabel:(0,i.t)("Any"),selects:[{label:(0,i.t)("Yes"),value:!0},{label:(0,i.t)("No"),value:!1}]},{Header:(0,i.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:T.c0.RelationOneMany,unfilteredLabel:(0,i.t)("All"),fetchSelects:(0,m.u1)("dashboard","changed_by",(0,m.JF)((e=>(0,i.t)("An error occurred while fetching dataset datasource values: %s",e))),h),paginate:!0,dropdownStyle:{minWidth:B.f8}}]),[a,Fe,e.user]),Ce=[{desc:!1,id:"dashboard_title",label:(0,i.t)("Alphabetical"),value:"alphabetical"},{desc:!0,id:"changed_on_delta_humanized",label:(0,i.t)("Recently modified"),value:"recently_modified"},{desc:!1,id:"changed_on_delta_humanized",label:(0,i.t)("Least recently modified"),value:"least_recently_modified"}],Ae=(0,c.useCallback)((e=>(0,s.Y)(P.A,{dashboard:e,hasPerm:W,bulkSelectEnabled:j,showThumbnails:pe?pe.thumbnails:(0,r.G7)(r.TO.Thumbnails),userId:null==h?void 0:h.userId,loading:R,openDashboardEditModal:ve,saveFavoriteStatus:Q,favoriteStatus:Z[e.id],handleBulkDashboardExport:ke,onDelete:e=>de(e)})),[j,Z,W,R,null==h?void 0:h.userId,Q,pe]),He=[];return ye&&He.push({name:(0,s.Y)(S.m,{id:"import-tooltip",title:(0,i.t)("Import dashboards"),placement:"bottomRight",children:(0,s.Y)(C.F.DownloadOutlined,{iconSize:"l","data-test":"import-button"})}),buttonStyle:"link",onClick:()=>{ie(!0)}}),(fe||Se)&&He.push({name:(0,i.t)("Bulk select"),buttonStyle:"secondary","data-test":"bulk-select",onClick:V}),ye&&He.push({icon:(0,s.Y)(C.F.PlusOutlined,{iconSize:"m"}),name:(0,i.t)("Dashboard"),buttonStyle:"primary",onClick:()=>{(0,x.V)("/dashboard/new",{assign:!0})}}),(0,s.FD)(s.FK,{children:[(0,s.Y)(D.A,{name:(0,i.t)("Dashboards"),buttons:He}),(0,s.Y)(f.h,{title:(0,i.t)("Please confirm"),description:(0,i.t)("Are you sure you want to delete the selected dashboards?"),onConfirm:function(e){return o.A.delete({endpoint:`/api/v1/dashboard/?q=${b().encode(e.map((({id:e})=>e)))}`}).then((({json:e={}})=>{q(),l(e.message)}),(0,m.JF)((e=>a((0,i.t)("There was an issue deleting the selected dashboards: ",e)))))},children:e=>{const t=(0,r.G7)(r.TO.TaggingSystem),d=[];return fe&&d.push({key:"delete",name:(0,i.t)("Delete"),type:"danger",onSelect:e}),Se&&d.push({key:"export",name:(0,i.t)("Export"),type:"primary",onSelect:ke}),(0,s.FD)(s.FK,{children:[ee&&(0,s.Y)(A.A,{dashboardId:ee.id,show:!0,onHide:()=>te(null),onSubmit:Te}),ae&&(0,s.Y)(w.T,{description:(0,s.FD)(s.FK,{children:[(0,i.t)("Are you sure you want to delete")," ",(0,s.Y)("b",{children:ae.dashboard_title}),"?"]}),onConfirm:()=>{(0,m.yT)(ae,q,l,a,void 0,null==h?void 0:h.userId),de(null)},onHide:()=>de(null),open:!!ae,title:(0,i.t)("Please confirm")}),(0,s.Y)(T.uO,{bulkActions:d,bulkSelectEnabled:j,cardSortSelectOptions:Ce,className:"dashboard-list-view",columns:De,count:G,data:U,disableBulkSelect:V,fetchData:$,refreshData:q,filters:Ye,initialSort:we,loading:R,pageSize:25,addSuccessToast:l,addDangerToast:a,showThumbnails:pe?pe.thumbnails:(0,r.G7)(r.TO.Thumbnails),renderCard:Ae,defaultViewMode:(0,r.G7)(r.TO.ListviewsDefaultCardView)?"card":"table",enableBulkTag:t,bulkTagResourceName:"dashboard"})]})}}),(0,s.Y)(T.zb,{resourceName:"dashboard",resourceLabel:(0,i.t)("dashboard"),passwordsNeededMessage:M,confirmOverwriteMessage:E,addDangerToast:a,addSuccessToast:l,onModelImport:()=>{ie(!1),q(),l((0,i.t)("Dashboard imported"))},show:se,onHide:()=>{ie(!1)},passwordFields:le,setPasswordFields:oe,sshTunnelPasswordFields:ce,setSSHTunnelPasswordFields:ue,sshTunnelPrivateKeyFields:he,setSSHTunnelPrivateKeyFields:be,sshTunnelPrivateKeyPasswordFields:me,setSSHTunnelPrivateKeyPasswordFields:ge}),re&&(0,s.Y)(v.R,{})]})}))}}]);
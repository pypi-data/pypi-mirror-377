"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7616],{20473:(e,t,a)=>{a.d(t,{A:()=>S});var n=a(2445),i=a(96540),r=a(58561),o=a.n(r),d=a(84335),l=a(15509),s=a(62799),c=a(17355),h=a(39304),u=a(25729),g=a(72234),m=a(35742),b=a(95579),p=a(97567),y=a(70856);const f=g.I4.div`
  .ant-select-dropdown {
    max-height: ${({theme:e})=>40*e.sizeUnit}px;
  }
  .tag-input {
    margin-bottom: ${({theme:e})=>3*e.sizeUnit}px;
  }
`;var v;!function(e){e.Chart="chart",e.Dashboard="dashboard",e.SavedQuery="query"}(v||(v={}));const S=({show:e,onHide:t,editTag:a,refreshData:r,addSuccessToast:g,addDangerToast:S,clearOnHide:$=!1})=>{const[w,C]=(0,i.useState)([]),[z,_]=(0,i.useState)([]),[k,x]=(0,i.useState)([]),[T,Y]=(0,i.useState)(""),[A,D]=(0,i.useState)(""),O=!!a,E=()=>{Y(""),D(""),C([]),_([]),x([])};(0,i.useEffect)((()=>{const e={[v.Dashboard]:[],[v.Chart]:[],[v.SavedQuery]:[]},t=({id:t,name:a,type:n})=>{const i=e[n];i&&i.push({value:t,label:a,key:t})};C([]),_([]),x([]),O&&((0,p.Ik)({tagIds:[a.id],types:null},(a=>{a.forEach(t),C(e[v.Dashboard]),_(e[v.Chart]),x(e[v.SavedQuery])}),(e=>{S("Error Fetching Tagged Objects")})),Y(a.name),D(a.description))}),[a]);const I=async(e,t,a,n,i,r,d)=>{const l=o().encode({columns:n,filters:[{col:i,opr:"ct",value:e}],page:t,order_column:r}),{json:s}=await m.A.get({endpoint:`/api/v1/${d}/?q=${l}`}),{result:c,count:h}=s;return{data:c.map((e=>({value:e.id,label:e[i]}))),totalCount:h}},N=(e,t)=>{e===v.Dashboard?C(t):e===v.Chart?_(t):e===v.SavedQuery&&x(t)};return(0,n.Y)(d.aF,{name:O?(0,b.t)("Edit Tag"):(0,b.t)("Create Tag"),title:(0,n.Y)(y.r,{isEditMode:O,title:O?(0,b.t)("Edit Tag"):(0,b.t)("Create Tag")}),onHide:()=>{$&&E(),t()},show:e,footer:(0,n.FD)("div",{children:[(0,n.Y)(l.$,{"data-test":"modal-save-dashboard-button",buttonStyle:"secondary",onClick:t,children:(0,b.t)("Cancel")}),(0,n.Y)(l.$,{"data-test":"modal-save-dashboard-button",buttonStyle:"primary",onClick:()=>{const e=w.map((e=>["dashboard",e.value])),n=z.map((e=>["chart",e.value])),i=k.map((e=>["query",e.value]));O?m.A.put({endpoint:`/api/v1/tag/${a.id}`,jsonPayload:{description:A,name:T,objects_to_tag:[...e,...n,...i]}}).then((()=>{r(),E(),g((0,b.t)("Tag updated")),t()})).catch((e=>{S(e.message||"Error Updating Tag")})):m.A.post({endpoint:"/api/v1/tag/",jsonPayload:{description:A,name:T,objects_to_tag:[...e,...n,...i]}}).then((()=>{r(),E(),g((0,b.t)("Tag created")),t()})).catch((e=>S(e.message||"Error Creating Tag")))},children:(0,b.t)("Save")})]}),children:(0,n.FD)(f,{children:[(0,n.Y)(s.l,{children:(0,b.t)("Tag name")}),(0,n.Y)(c.A,{className:"tag-input",onChange:e=>Y(e.target.value),placeholder:(0,b.t)("Name of your tag"),value:T}),(0,n.Y)(s.l,{children:(0,b.t)("Description")}),(0,n.Y)(c.A,{className:"tag-input",onChange:e=>D(e.target.value),placeholder:(0,b.t)("Add description of your tag"),value:A}),(0,n.Y)(h.c,{}),(0,n.Y)(u.A,{className:"tag-input",ariaLabel:(0,b.t)("Select dashboards"),mode:"multiple",name:"dashboards",value:w,options:async(e,t,a)=>I(e,t,0,["id","dashboard_title"],"dashboard_title","dashboard_title","dashboard"),onChange:e=>N(v.Dashboard,e),header:(0,n.Y)(s.l,{children:(0,b.t)("Dashboards")}),allowClear:!0}),(0,n.Y)(u.A,{className:"tag-input",ariaLabel:(0,b.t)("Select charts"),mode:"multiple",name:"charts",value:z,options:async(e,t,a)=>I(e,t,0,["id","slice_name"],"slice_name","slice_name","chart"),onChange:e=>N(v.Chart,e),header:(0,n.Y)(s.l,{children:(0,b.t)("Charts")}),allowClear:!0}),(0,n.Y)(u.A,{className:"tag-input",ariaLabel:(0,b.t)("Select saved queries"),mode:"multiple",name:"savedQueries",value:k,options:async(e,t,a)=>I(e,t,0,["id","label"],"label","label","saved_query"),onChange:e=>N(v.SavedQuery,e),header:(0,n.Y)(s.l,{children:(0,b.t)("Saved queries")}),allowClear:!0})]})})}},28009:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var n=a(2445),i=a(96540),r=a(95579),o=a(27366),d=a(30703),l=a(50500),s=a(41933),c=a(83197),h=a(97470),u=a(44344),g=a(51713),m=a(62221),b=a(5261),p=a(38380),y=a(71519),f=a(97567),v=a(23193),S=a(20473);const $=(0,b.Ay)((function(e){const{addDangerToast:t,addSuccessToast:a,user:b}=e,{userId:$}=b,w=(0,i.useMemo)((()=>[{id:"type",operator:"custom_tag",value:!0}]),[]),{state:{loading:C,resourceCount:z,resourceCollection:_,bulkSelectEnabled:k},hasPerm:x,fetchData:T,toggleBulkSelect:Y,refreshData:A}=(0,l.RU)("tag",(0,r.t)("tag"),t,void 0,void 0,w),[D,O]=(0,i.useState)(!1),[E,I]=(0,i.useState)(null),N=(0,i.useMemo)((()=>_.map((e=>e.id))),[_]),[B,H]=(0,l.oG)("tag",N,t),M=(0,m.SX)(null==$?void 0:$.toString(),null),F=x("can_write"),P=x("can_write"),j=[{id:"changed_on_delta_humanized",desc:!0}];function W(e){(0,f.dH)(e,(e=>{a(e),A()}),(e=>{t(e),A()}))}const L={title:(0,r.t)("No Tags created"),image:"dashboard.svg",description:"Create a new tag and assign it to existing entities like charts or dashboards",buttonAction:()=>O(!0),buttonIcon:(0,n.Y)(p.F.PlusOutlined,{iconSize:"m","data-test":"add-rule-empty"}),buttonText:(0,r.t)("Create a new Tag")},G=(0,i.useMemo)((()=>[{Cell:({row:{original:{id:e}}})=>$&&(0,n.Y)(s.$,{itemId:e,saveFaveStar:B,isStarred:H[e]}),Header:"",id:"id",disableSortBy:!0,size:"xs",hidden:!$},{Cell:({row:{original:{id:e,name:t}}})=>(0,n.Y)(u.vw,{children:(0,n.Y)(y.N_,{to:`/superset/all_entities/?id=${e}`,children:t})}),Header:(0,r.t)("Name"),accessor:"name",id:"name"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:t}}})=>(0,n.Y)(u.UW,{date:e,user:t}),Header:(0,r.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl",id:"changed_on_delta_humanized"},{Cell:({row:{original:e}})=>(0,n.FD)(d.En,{className:"actions",children:[F&&(0,n.Y)(c.h,{title:(0,r.t)("Please confirm"),description:(0,n.FD)(n.FK,{children:[(0,r.t)("Are you sure you want to delete")," ",(0,n.Y)("b",{children:e.dashboard_title}),"?"]}),onConfirm:()=>W([e]),children:e=>(0,n.Y)(h.m,{id:"delete-action-tooltip",title:(0,r.t)("Delete"),placement:"bottom",children:(0,n.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:e,children:(0,n.Y)(p.F.DeleteOutlined,{"data-test":"dashboard-list-trash-icon",iconSize:"l"})})})}),P&&(0,n.Y)(h.m,{id:"edit-action-tooltip",title:(0,r.t)("Edit"),placement:"bottom",children:(0,n.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>{return t=e,O(!0),void I(t);var t},children:(0,n.Y)(p.F.EditOutlined,{"data-test":"edit-alt",iconSize:"l"})})})]}),Header:(0,r.t)("Actions"),id:"actions",hidden:!F,disableSortBy:!0},{accessor:v.H.ChangedBy,hidden:!0,id:v.H.ChangedBy}]),[$,F,A,a,t]),q=(0,i.useMemo)((()=>[{Header:(0,r.t)("Name"),id:"name",input:"search",operator:u.c0.Contains},{Header:(0,r.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:u.c0.RelationOneMany,unfilteredLabel:(0,r.t)("All"),fetchSelects:(0,d.u1)("tag","changed_by",(0,d.JF)((e=>(0,r.t)("An error occurred while fetching dataset datasource values: %s",e))),b),paginate:!0}]),[t,e.user]),Q=[{desc:!1,id:"name",label:(0,r.t)("Alphabetical"),value:"alphabetical"},{desc:!0,id:"changed_on_delta_humanized",label:(0,r.t)("Recently modified"),value:"recently_modified"},{desc:!1,id:"changed_on_delta_humanized",label:(0,r.t)("Least recently modified"),value:"least_recently_modified"}],U=[];return F&&U.push({name:(0,r.t)("Bulk select"),buttonStyle:"secondary","data-test":"bulk-select",onClick:Y}),U.push({icon:(0,n.Y)(p.F.PlusOutlined,{iconSize:"m"}),name:(0,r.t)("Tag"),buttonStyle:"primary","data-test":"bulk-select",onClick:()=>O(!0)}),(0,n.FD)(n.FK,{children:[(0,n.Y)(S.A,{show:D,onHide:()=>{O(!1),I(null)},editTag:E,refreshData:A,addSuccessToast:a,addDangerToast:t,clearOnHide:!0}),(0,n.Y)(g.A,{name:(0,r.t)("Tags"),buttons:U}),(0,n.Y)(c.h,{title:(0,r.t)("Please confirm"),description:(0,r.t)("Are you sure you want to delete the selected tags?"),onConfirm:e=>W(e),children:e=>{const i=[];return F&&i.push({key:"delete",name:(0,r.t)("Delete"),type:"danger",onSelect:e}),(0,n.Y)(n.FK,{children:(0,n.Y)(u.uO,{bulkActions:i,bulkSelectEnabled:k,cardSortSelectOptions:Q,className:"tags-list-view",columns:G,count:z,data:_,disableBulkSelect:Y,refreshData:A,emptyState:L,fetchData:T,filters:q,initialSort:j,loading:C,addDangerToast:t,addSuccessToast:a,pageSize:25,showThumbnails:M?M.thumbnails:(0,o.G7)(o.TO.Thumbnails),defaultViewMode:(0,o.G7)(o.TO.ListviewsDefaultCardView)?"card":"table"})})}})]})}))},36552:(e,t,a)=>{a.d(t,{A:()=>p});var n=a(96540),i=a(46942),r=a.n(i),o=a(62279),d=a(829),l=a(77132),s=a(25905),c=a(37358),h=a(14277);const u=e=>{const{componentCls:t}=e;return{[t]:{"&-horizontal":{[`&${t}`]:{"&-sm":{marginBlock:e.marginXS},"&-md":{marginBlock:e.margin}}}}}},g=e=>{const{componentCls:t,sizePaddingEdgeHorizontal:a,colorSplit:n,lineWidth:i,textPaddingInline:r,orientationMargin:o,verticalMarginInline:d}=e;return{[t]:Object.assign(Object.assign({},(0,s.dF)(e)),{borderBlockStart:`${(0,l.zA)(i)} solid ${n}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:d,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${(0,l.zA)(i)} solid ${n}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${(0,l.zA)(e.marginLG)} 0`},[`&-horizontal${t}-with-text`]:{display:"flex",alignItems:"center",margin:`${(0,l.zA)(e.dividerHorizontalWithTextGutterMargin)} 0`,color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${n}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${(0,l.zA)(i)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${t}-with-text-start`]:{"&::before":{width:`calc(${o} * 100%)`},"&::after":{width:`calc(100% - ${o} * 100%)`}},[`&-horizontal${t}-with-text-end`]:{"&::before":{width:`calc(100% - ${o} * 100%)`},"&::after":{width:`calc(${o} * 100%)`}},[`${t}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:r},"&-dashed":{background:"none",borderColor:n,borderStyle:"dashed",borderWidth:`${(0,l.zA)(i)} 0 0`},[`&-horizontal${t}-with-text${t}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${t}-dashed`]:{borderInlineStartWidth:i,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},"&-dotted":{background:"none",borderColor:n,borderStyle:"dotted",borderWidth:`${(0,l.zA)(i)} 0 0`},[`&-horizontal${t}-with-text${t}-dotted`]:{"&::before, &::after":{borderStyle:"dotted none none"}},[`&-vertical${t}-dotted`]:{borderInlineStartWidth:i,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${t}-with-text`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},[`&-horizontal${t}-with-text-start${t}-no-default-orientation-margin-start`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${t}-inner-text`]:{paddingInlineStart:a}},[`&-horizontal${t}-with-text-end${t}-no-default-orientation-margin-end`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${t}-inner-text`]:{paddingInlineEnd:a}}})}},m=(0,c.OF)("Divider",(e=>{const t=(0,h.oX)(e,{dividerHorizontalWithTextGutterMargin:e.margin,sizePaddingEdgeHorizontal:0});return[g(t),u(t)]}),(e=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS})),{unitless:{orientationMargin:!0}});const b={small:"sm",middle:"md"},p=e=>{const{getPrefixCls:t,direction:a,className:i,style:l}=(0,o.TP)("divider"),{prefixCls:s,type:c="horizontal",orientation:h="center",orientationMargin:u,className:g,rootClassName:p,children:y,dashed:f,variant:v="solid",plain:S,style:$,size:w}=e,C=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a}(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","variant","plain","style","size"]),z=t("divider",s),[_,k,x]=m(z),T=(0,d.A)(w),Y=b[T],A=!!y,D=n.useMemo((()=>"left"===h?"rtl"===a?"end":"start":"right"===h?"rtl"===a?"start":"end":h),[a,h]),O="start"===D&&null!=u,E="end"===D&&null!=u,I=r()(z,i,k,x,`${z}-${c}`,{[`${z}-with-text`]:A,[`${z}-with-text-${D}`]:A,[`${z}-dashed`]:!!f,[`${z}-${v}`]:"solid"!==v,[`${z}-plain`]:!!S,[`${z}-rtl`]:"rtl"===a,[`${z}-no-default-orientation-margin-start`]:O,[`${z}-no-default-orientation-margin-end`]:E,[`${z}-${Y}`]:!!Y},g,p),N=n.useMemo((()=>"number"==typeof u?u:/^\d+$/.test(u)?Number(u):u),[u]),B={marginInlineStart:O?N:void 0,marginInlineEnd:E?N:void 0};return _(n.createElement("div",Object.assign({className:I,style:Object.assign(Object.assign({},l),$)},C,{role:"separator"}),y&&"vertical"!==c&&n.createElement("span",{className:`${z}-inner-text`,style:B},y)))}},39304:(e,t,a)=>{a.d(t,{c:()=>o});var n=a(2445),i=a(17437),r=a(36552);function o(e){return(0,n.Y)(r.A,{css:e=>i.AH`
        margin: ${e.margin}px 0;
      `,...e})}}}]);
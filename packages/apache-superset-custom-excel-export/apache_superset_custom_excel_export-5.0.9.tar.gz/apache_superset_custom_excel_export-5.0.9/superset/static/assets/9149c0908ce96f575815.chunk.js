(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[1285],{9063:(e,t,a)=>{var n=a(55765);e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?n(e,void 0,t):[]}},20473:(e,t,a)=>{"use strict";a.d(t,{A:()=>$});var n=a(2445),i=a(96540),r=a(58561),o=a.n(r),l=a(84335),d=a(15509),s=a(62799),c=a(17355),h=a(39304),g=a(25729),u=a(72234),p=a(35742),m=a(95579),b=a(97567),f=a(70856);const v=u.I4.div`
  .ant-select-dropdown {
    max-height: ${({theme:e})=>40*e.sizeUnit}px;
  }
  .tag-input {
    margin-bottom: ${({theme:e})=>3*e.sizeUnit}px;
  }
`;var y;!function(e){e.Chart="chart",e.Dashboard="dashboard",e.SavedQuery="query"}(y||(y={}));const $=({show:e,onHide:t,editTag:a,refreshData:r,addSuccessToast:u,addDangerToast:$,clearOnHide:S=!1})=>{const[x,w]=(0,i.useState)([]),[z,T]=(0,i.useState)([]),[C,Y]=(0,i.useState)([]),[A,k]=(0,i.useState)(""),[E,I]=(0,i.useState)(""),D=!!a,F=()=>{k(""),I(""),w([]),T([]),Y([])};(0,i.useEffect)((()=>{const e={[y.Dashboard]:[],[y.Chart]:[],[y.SavedQuery]:[]},t=({id:t,name:a,type:n})=>{const i=e[n];i&&i.push({value:t,label:a,key:t})};w([]),T([]),Y([]),D&&((0,b.Ik)({tagIds:[a.id],types:null},(a=>{a.forEach(t),w(e[y.Dashboard]),T(e[y.Chart]),Y(e[y.SavedQuery])}),(e=>{$("Error Fetching Tagged Objects")})),k(a.name),I(a.description))}),[a]);const O=async(e,t,a,n,i,r,l)=>{const d=o().encode({columns:n,filters:[{col:i,opr:"ct",value:e}],page:t,order_column:r}),{json:s}=await p.A.get({endpoint:`/api/v1/${l}/?q=${d}`}),{result:c,count:h}=s;return{data:c.map((e=>({value:e.id,label:e[i]}))),totalCount:h}},_=(e,t)=>{e===y.Dashboard?w(t):e===y.Chart?T(t):e===y.SavedQuery&&Y(t)};return(0,n.Y)(l.aF,{name:D?(0,m.t)("Edit Tag"):(0,m.t)("Create Tag"),title:(0,n.Y)(f.r,{isEditMode:D,title:D?(0,m.t)("Edit Tag"):(0,m.t)("Create Tag")}),onHide:()=>{S&&F(),t()},show:e,footer:(0,n.FD)("div",{children:[(0,n.Y)(d.$,{"data-test":"modal-save-dashboard-button",buttonStyle:"secondary",onClick:t,children:(0,m.t)("Cancel")}),(0,n.Y)(d.$,{"data-test":"modal-save-dashboard-button",buttonStyle:"primary",onClick:()=>{const e=x.map((e=>["dashboard",e.value])),n=z.map((e=>["chart",e.value])),i=C.map((e=>["query",e.value]));D?p.A.put({endpoint:`/api/v1/tag/${a.id}`,jsonPayload:{description:E,name:A,objects_to_tag:[...e,...n,...i]}}).then((()=>{r(),F(),u((0,m.t)("Tag updated")),t()})).catch((e=>{$(e.message||"Error Updating Tag")})):p.A.post({endpoint:"/api/v1/tag/",jsonPayload:{description:E,name:A,objects_to_tag:[...e,...n,...i]}}).then((()=>{r(),F(),u((0,m.t)("Tag created")),t()})).catch((e=>$(e.message||"Error Creating Tag")))},children:(0,m.t)("Save")})]}),children:(0,n.FD)(v,{children:[(0,n.Y)(s.l,{children:(0,m.t)("Tag name")}),(0,n.Y)(c.A,{className:"tag-input",onChange:e=>k(e.target.value),placeholder:(0,m.t)("Name of your tag"),value:A}),(0,n.Y)(s.l,{children:(0,m.t)("Description")}),(0,n.Y)(c.A,{className:"tag-input",onChange:e=>I(e.target.value),placeholder:(0,m.t)("Add description of your tag"),value:E}),(0,n.Y)(h.c,{}),(0,n.Y)(g.A,{className:"tag-input",ariaLabel:(0,m.t)("Select dashboards"),mode:"multiple",name:"dashboards",value:x,options:async(e,t,a)=>O(e,t,0,["id","dashboard_title"],"dashboard_title","dashboard_title","dashboard"),onChange:e=>_(y.Dashboard,e),header:(0,n.Y)(s.l,{children:(0,m.t)("Dashboards")}),allowClear:!0}),(0,n.Y)(g.A,{className:"tag-input",ariaLabel:(0,m.t)("Select charts"),mode:"multiple",name:"charts",value:z,options:async(e,t,a)=>O(e,t,0,["id","slice_name"],"slice_name","slice_name","chart"),onChange:e=>_(y.Chart,e),header:(0,n.Y)(s.l,{children:(0,m.t)("Charts")}),allowClear:!0}),(0,n.Y)(g.A,{className:"tag-input",ariaLabel:(0,m.t)("Select saved queries"),mode:"multiple",name:"savedQueries",value:C,options:async(e,t,a)=>O(e,t,0,["id","label"],"label","label","saved_query"),onChange:e=>_(y.SavedQuery,e),header:(0,n.Y)(s.l,{children:(0,m.t)("Saved queries")}),allowClear:!0})]})})}},36552:(e,t,a)=>{"use strict";a.d(t,{A:()=>b});var n=a(96540),i=a(46942),r=a.n(i),o=a(62279),l=a(829),d=a(77132),s=a(25905),c=a(37358),h=a(14277);const g=e=>{const{componentCls:t}=e;return{[t]:{"&-horizontal":{[`&${t}`]:{"&-sm":{marginBlock:e.marginXS},"&-md":{marginBlock:e.margin}}}}}},u=e=>{const{componentCls:t,sizePaddingEdgeHorizontal:a,colorSplit:n,lineWidth:i,textPaddingInline:r,orientationMargin:o,verticalMarginInline:l}=e;return{[t]:Object.assign(Object.assign({},(0,s.dF)(e)),{borderBlockStart:`${(0,d.zA)(i)} solid ${n}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:l,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${(0,d.zA)(i)} solid ${n}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${(0,d.zA)(e.marginLG)} 0`},[`&-horizontal${t}-with-text`]:{display:"flex",alignItems:"center",margin:`${(0,d.zA)(e.dividerHorizontalWithTextGutterMargin)} 0`,color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${n}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${(0,d.zA)(i)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${t}-with-text-start`]:{"&::before":{width:`calc(${o} * 100%)`},"&::after":{width:`calc(100% - ${o} * 100%)`}},[`&-horizontal${t}-with-text-end`]:{"&::before":{width:`calc(100% - ${o} * 100%)`},"&::after":{width:`calc(${o} * 100%)`}},[`${t}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:r},"&-dashed":{background:"none",borderColor:n,borderStyle:"dashed",borderWidth:`${(0,d.zA)(i)} 0 0`},[`&-horizontal${t}-with-text${t}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${t}-dashed`]:{borderInlineStartWidth:i,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},"&-dotted":{background:"none",borderColor:n,borderStyle:"dotted",borderWidth:`${(0,d.zA)(i)} 0 0`},[`&-horizontal${t}-with-text${t}-dotted`]:{"&::before, &::after":{borderStyle:"dotted none none"}},[`&-vertical${t}-dotted`]:{borderInlineStartWidth:i,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${t}-with-text`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},[`&-horizontal${t}-with-text-start${t}-no-default-orientation-margin-start`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${t}-inner-text`]:{paddingInlineStart:a}},[`&-horizontal${t}-with-text-end${t}-no-default-orientation-margin-end`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${t}-inner-text`]:{paddingInlineEnd:a}}})}},p=(0,c.OF)("Divider",(e=>{const t=(0,h.oX)(e,{dividerHorizontalWithTextGutterMargin:e.margin,sizePaddingEdgeHorizontal:0});return[u(t),g(t)]}),(e=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS})),{unitless:{orientationMargin:!0}});const m={small:"sm",middle:"md"},b=e=>{const{getPrefixCls:t,direction:a,className:i,style:d}=(0,o.TP)("divider"),{prefixCls:s,type:c="horizontal",orientation:h="center",orientationMargin:g,className:u,rootClassName:b,children:f,dashed:v,variant:y="solid",plain:$,style:S,size:x}=e,w=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a}(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","variant","plain","style","size"]),z=t("divider",s),[T,C,Y]=p(z),A=(0,l.A)(x),k=m[A],E=!!f,I=n.useMemo((()=>"left"===h?"rtl"===a?"end":"start":"right"===h?"rtl"===a?"start":"end":h),[a,h]),D="start"===I&&null!=g,F="end"===I&&null!=g,O=r()(z,i,C,Y,`${z}-${c}`,{[`${z}-with-text`]:E,[`${z}-with-text-${I}`]:E,[`${z}-dashed`]:!!v,[`${z}-${y}`]:"solid"!==y,[`${z}-plain`]:!!$,[`${z}-rtl`]:"rtl"===a,[`${z}-no-default-orientation-margin-start`]:D,[`${z}-no-default-orientation-margin-end`]:F,[`${z}-${k}`]:!!k},u,b),_=n.useMemo((()=>"number"==typeof g?g:/^\d+$/.test(g)?Number(g):g),[g]),N={marginInlineStart:D?_:void 0,marginInlineEnd:F?_:void 0};return T(n.createElement("div",Object.assign({className:O,style:Object.assign(Object.assign({},d),S)},w,{role:"separator"}),f&&"vertical"!==c&&n.createElement("span",{className:`${z}-inner-text`,style:N},f)))}},39304:(e,t,a)=>{"use strict";a.d(t,{c:()=>o});var n=a(2445),i=a(17437),r=a(36552);function o(e){return(0,n.Y)(r.A,{css:e=>i.AH`
        margin: ${e.margin}px 0;
      `,...e})}},86014:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var n=a(2445),i=a(96540),r=a(17437),o=a(72234),l=a(95579),d=a(33231),s=a(95070),c=a(69031),h=a(33535),g=a(44344),u=a(64658);const p=o.I4.div`
  text-align: left;
  border-radius: ${({theme:e})=>e.borderRadius}px 0;
  .table {
    table-layout: fixed;
  }
  .td {
    width: 33%;
  }
  .entity-title {
    font-family: Inter;
    font-size: ${({theme:e})=>e.fontSize}px;
    font-weight: ${({theme:e})=>e.fontWeightStrong};
    line-height: 17px;
    letter-spacing: 0px;
    text-align: left;
    margin: ${({theme:e})=>4*e.sizeUnit}px 0;
  }
`;function m({search:e="",setShowTagModal:t,objects:a,canEditTag:i}){const r=a.dashboard.length>0,o=a.chart.length>0,d=a.query.length>0,m=r||o||d,b=e=>{const t=a[e].map((t=>({[e]:(0,n.Y)(u.o.Link,{href:t.url,children:t.name}),modified:s.XV.utc(t.changed_on).fromNow(),tags:t.tags,owners:t.owners})));return(0,n.Y)(c.Q,{className:"table-condensed",emptyWrapperType:c.V.Small,data:t,pageSize:10,columns:[{accessor:e,Header:"Title",id:e},{Cell:({row:{original:{tags:e=[]}}})=>(0,n.Y)(g.Sk,{tags:e.filter((e=>void 0!==e.type&&["TagType.custom",1].includes(e.type))),maxTags:3}),Header:(0,l.t)("Tags"),accessor:"tags",disableSortBy:!0,id:"tags"},{Cell:({row:{original:{owners:e=[]}}})=>(0,n.Y)(g.WM,{users:e}),Header:(0,l.t)("Owners"),accessor:"owners",disableSortBy:!0,size:"xl",id:"owners"}]})};return(0,n.Y)(p,{children:m?(0,n.FD)(n.FK,{children:[r&&(0,n.FD)(n.FK,{children:[(0,n.Y)("div",{className:"entity-title",children:(0,l.t)("Dashboards")}),b("dashboard")]}),o&&(0,n.FD)(n.FK,{children:[(0,n.Y)("div",{className:"entity-title",children:(0,l.t)("Charts")}),b("chart")]}),d&&(0,n.FD)(n.FK,{children:[(0,n.Y)("div",{className:"entity-title",children:(0,l.t)("Queries")}),b("query")]})]}):(0,n.Y)(h.p,{image:"dashboard.svg",size:"large",title:(0,l.t)("No entities have this tag currently assigned"),...i&&{buttonAction:()=>t(!0),buttonText:(0,l.t)("Add tag to entities")}})})}var b=a(52879),f=a(15509),v=a(33110),y=a(38711),$=a(5202),S=a(20473),x=a(5261),w=a(97567),z=a(25106),T=a(84666),C=a(61225);const Y=e=>r.AH`
  display: flex;
  align-items: center;
  margin-left: ${e.sizeUnit}px;
  & > span {
    margin-right: ${3*e.sizeUnit}px;
  }
`,A=o.I4.div`
  ${({theme:e})=>`\n  background-color: ${e.colors.grayscale.light4};\n  .select-control {\n    margin-left: ${4*e.sizeUnit}px;\n    margin-right: ${4*e.sizeUnit}px;\n    margin-bottom: ${2*e.sizeUnit}px;\n  }\n  .select-control-label {\n    font-size: ${3*e.sizeUnit}px;\n    color: ${e.colors.grayscale.base};\n    margin-bottom: ${1*e.sizeUnit}px;\n  }\n  .entities {\n    margin: ${6*e.sizeUnit}px; 0px;\n  }\n  .pagination-container {\n    background-color: transparent;\n  }\n  `}
`,k=o.I4.div`
  ${({theme:e})=>`\n  height: ${12.5*e.sizeUnit}px;\n  background-color: ${e.colors.grayscale.light5};\n  margin-bottom: ${4*e.sizeUnit}px;\n  .navbar-brand {\n    margin-left: ${2*e.sizeUnit}px;\n    font-weight: ${e.fontWeightStrong};\n  }\n  .header {\n    font-weight: ${e.fontWeightStrong};\n    margin-right:  ${3*e.sizeUnit}px;\n    text-align: left;\n    font-size: ${4.5*e.sizeUnit}px;\n    padding: ${3*e.sizeUnit}px;\n    display: inline-block;\n    line-height: ${9*e.sizeUnit}px;\n  }\n  `};
`,E=(0,x.Ay)((function(){const[e]=(0,d.pE)("id",d.hc),[t,a]=(0,i.useState)(null),[r,o]=(0,i.useState)(!1),{addSuccessToast:s,addDangerToast:c}=(0,x.Yf)(),[h,g]=(0,i.useState)(!1),[u,p]=(0,i.useState)({dashboard:[],chart:[],query:[]}),E=(0,C.d4)((e=>{var t;return(0,T.L)("can_write","Tag",null==(t=e.user)?void 0:t.roles)})),I={title:(null==t?void 0:t.name)||"",placeholder:"testing",onSave:()=>{},canEdit:!1,label:(0,l.t)("dataset name")},D=[];if(null!=t&&t.description){const e={type:v.Q.Description,value:(null==t?void 0:t.description)||""};D.push(e)}const F={type:v.Q.Owner,createdBy:(0,z.A)(null==t?void 0:t.created_by),createdOn:(null==t?void 0:t.created_on_delta_humanized)||""};D.push(F);const O={type:v.Q.LastModified,value:(null==t?void 0:t.changed_on_delta_humanized)||"",modifiedBy:(0,z.A)(null==t?void 0:t.changed_by)};D.push(O);const _=()=>{g(!0),t?(0,w.Ik)({tagIds:void 0!==(null==t?void 0:t.id)?[t.id]:"",types:null},(e=>{const t={dashboard:[],chart:[],query:[]};e.forEach((function(e){const a=e.type;t[a].push(e)})),p(t),g(!1)}),(e=>{c("Error Fetching Tagged Objects"),g(!1)})):c("Error tag object is not referenced!")},N=e=>{(0,w.FA)(e,(e=>{a(e),g(!1)}),(e=>{c((0,l.t)("Error Fetching Tagged Objects")),g(!1)}))};return(0,i.useEffect)((()=>{e&&(g(!0),N(e))}),[e]),(0,i.useEffect)((()=>{t&&_()}),[t]),h?(0,n.Y)(b.R,{}):(0,n.FD)(A,{children:[(0,n.Y)(S.A,{show:r,onHide:()=>{o(!1)},editTag:t,addSuccessToast:s,addDangerToast:c,refreshData:()=>{_(),e&&N(e)}}),(0,n.Y)(k,{children:(0,n.Y)($.U,{additionalActionsMenu:(0,n.Y)(n.FK,{}),editableTitleProps:I,faveStarProps:{itemId:1,saveFaveStar:()=>{}},showFaveStar:!1,showTitlePanelItems:!0,titlePanelAdditionalItems:(0,n.Y)("div",{css:Y,children:(0,n.Y)(y.Ay,{items:D,tooltipPlacement:"bottom"})}),rightPanelAdditionalItems:(0,n.Y)(n.FK,{children:E&&(0,n.FD)(f.$,{"data-test":"bulk-select-action",buttonStyle:"secondary",onClick:()=>o(!0),showMarginRight:!1,children:[(0,l.t)("Edit tag")," "]})}),menuDropdownProps:{disabled:!0},showMenuDropdown:!1})}),(0,n.Y)("div",{className:"entities",children:(0,n.Y)(m,{search:(null==t?void 0:t.name)||"",setShowTagModal:o,objects:u,canEditTag:E})})]})}))}}]);
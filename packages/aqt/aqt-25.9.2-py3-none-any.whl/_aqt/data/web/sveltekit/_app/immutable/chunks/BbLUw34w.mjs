import"./BbkoyQuY.mjs";import{i as ve}from"./-ESH3Vzs.mjs";import{p as ce,h as P,i as h,r as c,b as U,j as oe,c as $,d as de,l as J,s as z,m as X,k as y,a as ye,Y as R,u,g as s,e as Te,f as he,aN as Ie}from"./D0Kcqh4a.mjs";import{p as ee,i as se,b as ne,s as Pe,a as Ke}from"./8hkm7YIM.mjs";import{Y as Ye,Z as Be,_ as Ge,$ as Ue,a0 as We,a1 as Oe,a2 as Ce,a3 as Ee,a4 as ze,a5 as $e,a6 as Ae,a7 as je,a8 as He,a9 as Ve,aa as Je,ab as Xe,ac as Ze,ad as Qe,ae as et,af as tt,ag as at,ah as rt,ai as st,aj as it,q as Le,ak as ke,I as V,al as lt,am as nt,an as ot,ao as vt,ap as ct,aq as dt,ar as ut,as as ft,at as mt,au as pt,av as gt,t as bt,aw as pe,ax as ht,ay as yt,az as _t,aA as St,U as wt}from"./Ch7ZtZmv.mjs";import{C as xt}from"./BLIdLdeN.mjs";import{e as ae,i as re,R as we}from"./B9FzK2Aa.mjs";import{s as T,d as Dt}from"./CAm1qXYJ.mjs";import{t as W,D as Rt,T as Lt,b as Ne}from"./C4xCUJvN.mjs";import{b as kt}from"./B0hvKUPm.mjs";import{R as G}from"./BfDh-mSI.mjs";import{y as Ft,z as xe,A as Tt,B as Ct,C as Et,D as $t,E as At,F as Fe,G as Nt,H as qt,I as Mt,J as It,K as Pt,L as Kt,N as Yt,M as Bt}from"./6_pb3DgZ.mjs";import{m as Gt}from"./D1slsF82.mjs";import{t as Ut}from"./CE2Et6Mj.mjs";import{b as ge}from"./dPqBMmTD.mjs";import{b as Wt}from"./Dm-VOW7A.mjs";var Ot=P('<div class="card-info-placeholder svelte-16vamgt"> </div>');function zt(n,p){ce(p,!1),ve();var o=Ot(),e=h(o,!0);c(o),U(S=>T(e,S),[()=>Ye()],oe),$(n,o),de()}var jt=P('<tr><th class="align-start svelte-1ws7hzc"> </th><td> </td></tr>'),Ht=P('<table class="stats-table align-start svelte-1ws7hzc"><tbody></tbody></table>');function Vt(n,p){ce(p,!1);let o=ee(p,"stats",8);function e(t){return new Ne(Number(t)).dateString()}function S(t){const r=[];if(r.push({label:Be(),value:e(t.added)}),t.firstReview!=null&&r.push({label:Ge(),value:e(t.firstReview)}),t.latestReview!=null&&r.push({label:Ue(),value:e(t.latestReview)}),t.dueDate!=null&&r.push({label:We(),value:e(t.dueDate)}),t.duePosition!=null&&r.push({label:Oe(),value:t.duePosition}),t.interval&&r.push({label:Ce(),value:W(t.interval*Rt)}),t.memoryState){let x=W(t.memoryState.stability*86400,!1,!1);if(t.memoryState.stability>31){const a=W(t.memoryState.stability*86400,!1,!1,Lt.Days);x+=` (${a})`}r.push({label:Ee(),value:x});const D=((t.memoryState.difficulty-1)/9*100).toFixed(0);if(r.push({label:ze(),value:`${D}%`}),t.fsrsRetrievability){const a=(t.fsrsRetrievability*100).toFixed(0);r.push({label:$e(),value:`${a}%`})}}else t.ease&&r.push({label:Ae(),value:`${t.ease/10}%`});r.push({label:je(),value:t.reviews}),r.push({label:He(),value:t.lapses}),t.totalSecs&&(r.push({label:Ve(),value:W(t.averageSecs)}),r.push({label:Je(),value:W(t.totalSecs)})),r.push({label:Xe(),value:t.cardType}),r.push({label:Ze(),value:t.notetype});let g;if(t.originalDeck?g=`${t.deck} (${t.originalDeck})`:g=t.deck,r.push({label:Qe(),value:g}),r.push({label:et(),value:t.preset}),r.push({label:tt(),value:t.cardId}),r.push({label:at(),value:t.noteId}),t.customData){let x;try{const D=JSON.parse(t.customData);x=Object.entries(D).map(([a,f])=>`${a}=${f}`).join(" ")}catch{x=t.customData}r.push({label:rt(),value:x})}return r}let v=X();J(()=>y(o()),()=>{z(v,S(o()))}),ye(),ve();var i=Ht(),C=h(i);ae(C,5,()=>s(v),re,(t,r)=>{var g=jt(),x=h(g),D=h(x,!0);c(x);var a=R(x),f=h(a,!0);c(a),c(g),U(()=>{T(D,(s(r),u(()=>s(r).label))),T(f,(s(r),u(()=>s(r).value)))}),$(t,g)}),c(C),c(i),$(n,i),de()}const Jt=1e3;function be(n,p,o){const e=Math.pow(.9,1/-o)-1;return Math.pow(p/n*e+1,-o)}var _=(n=>(n[n.Week=0]="Week",n[n.Month=1]="Month",n[n.Year=2]="Year",n[n.AllTime=3]="AllTime",n))(_||{});const Xt={0:7,1:30,2:365,3:1/0};function Zt(n,p){return n.filter(o=>o.daysSinceFirstLearn<=p)}function De(n){return n.reviewKind!==G.MANUAL&&n.reviewKind!==G.RESCHEDULED&&(n.reviewKind!==G.FILTERED||n.ease!==0)}function Qt(n){const p=[];for(const o of n){if(o.reviewKind===G.MANUAL&&o.ease===0||o.memoryState===void 0)break;p.push(o)}return p.filter(o=>De(o))}function ea(n,p,o){const e=[];let S=0,v=0;const i=Math.min(p/Jt,1);let C=0;if(n.slice().reverse().forEach((m,b)=>{var N,O;const A=Number(m.time);if(b===0){S=A,v=((N=m.memoryState)==null?void 0:N.stability)||0,e.push({date:new Date(A*1e3),daysSinceFirstLearn:0,elapsedDaysSinceLastReview:0,retrievability:100,stability:v});return}const K=(A-S)/86400;let I=0;for(;I<K-i;){I+=i;const l=be(v,I,o);e.push({date:new Date((S+I*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+i,elapsedDaysSinceLastReview:I,retrievability:l*100,stability:v})}C+=K,e.push({date:new Date((S+K*86400)*1e3),daysSinceFirstLearn:C,retrievability:100,elapsedDaysSinceLastReview:0,stability:v}),S=A,v=((O=m.memoryState)==null?void 0:O.stability)||0}),e.length===0)return[];const t=Date.now()/1e3,r=(t-S)/86400;let g=0;for(;g<r-i;){g+=i;const m=be(v,g,o);e.push({date:new Date((S+g*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+i,elapsedDaysSinceLastReview:g,retrievability:m*100,stability:v})}C+=r;const x=be(v,r,o);e.push({date:new Date(t*1e3),daysSinceFirstLearn:C,elapsedDaysSinceLastReview:r,retrievability:x*100,stability:v});const D=p-r;let a=0;for(;a<D;){a+=i;const m=be(v,g+a,o);e.push({date:new Date((t+a*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+i,elapsedDaysSinceLastReview:r+a,retrievability:m*100,stability:v})}return Zt(e,p)}function qe(n,p){if(n.length===0)return 0;const o=new Date,e=(o.getTime()/1e3-Number(n[n.length-1].time))/86400,S=(o.getTime()/1e3-Number(n[0].time))/86400,v=n[0].interval/86400,i=Math.max(v*1.5-S,v*.5);return Math.min(e+i,Xt[p])}function ta(n,p,o,e,S,v){const i=Ft(o),C=i.transition().duration(600);if(n.length===0){xe(i,!1);return}const t=qe(n,p),r=ea(n,t,v);if(r.length===0){xe(i,!1);return}else xe(i,!0);i.selectAll(".forgetting-curve-line").remove(),i.select(".hover-columns").remove();const g=Gt(r,l=>l.date),x=Tt(r,l=>l.date),D=Ut().domain([g,x]).range([e.marginLeft,e.width-e.marginRight]),a=Math.max(0,100-1.2*(100-Math.min(...r.map(l=>l.retrievability)))),f=Ct().domain([a,100]).range([e.height-e.marginBottom,e.marginTop]);i.select(".x-ticks").call(l=>l.transition(C).call(Et(D).ticks(5).tickSizeOuter(0))).attr("direction","ltr"),i.select(".y-ticks").attr("transform",`translate(${e.marginLeft},0)`).call(l=>l.transition(C).call($t(f).tickSizeOuter(0))).attr("direction","ltr"),i.select(".y-ticks .y-axis-title").remove(),i.select(".y-ticks").append("text").attr("class","y-axis-title").attr("transform","rotate(-90)").attr("y",0-e.marginLeft).attr("x",0-e.height/2).attr("font-size","1rem").attr("dy","1.1em").attr("fill","currentColor");const m=At().x(l=>D(l.date)).y(l=>f(l.retrievability)),b=S*100;i.append("linearGradient").attr("id","line-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",f(0)).attr("x2",0).attr("y2",f(100)).selectAll("stop").data([{offset:"0%",color:"tomato"},{offset:`${b}%`,color:"steelblue"},{offset:"100%",color:"green"}]).enter().append("stop").attr("offset",l=>l.offset).attr("stop-color",l=>l.color);const A=new Date,K=r.filter(l=>l.date<=A),I=r.filter(l=>l.date>=A);i.append("path").datum(K).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("d",m),i.append("path").datum(I).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("stroke-dasharray","4 4").attr("d",m),i.select(".desired-retention-line").remove(),b>a&&i.append("line").attr("class","desired-retention-line").attr("x1",e.marginLeft).attr("x2",e.width-e.marginRight).attr("y1",f(b)).attr("y2",f(b)).attr("stroke","steelblue").attr("stroke-dasharray","4 4").attr("stroke-width",1.2);const N=i.append("line").attr("class","focus-line").attr("y1",e.marginTop).attr("y2",e.height-e.marginBottom).attr("stroke","black").attr("stroke-width",1).style("opacity",0);function O(l){return`${t>=365?"Date":"Date Time"}: ${t>=365?l.date.toLocaleDateString():l.date.toLocaleString()}<br>
        ${it()}: ${W(l.elapsedDaysSinceLastReview*86400)}<br>${$e()}: ${l.retrievability.toFixed(2)}%<br>${Ee()}: ${W(l.stability*86400)}`}i.append("g").attr("class","hover-columns").selectAll("rect").data(r).join("rect").attr("x",l=>D(l.date)-1).attr("y",e.marginTop).attr("width",2).attr("height",e.height-e.marginTop-e.marginBottom).attr("fill","transparent").on("mousemove",(l,L)=>{const[q,Y]=Fe(l,document.body),[Z,Q]=Fe(l,i.node()),j=f(b);N.attr("x1",D(L.date)-1).attr("x2",D(L.date)+1).style("opacity",1);let H=O(L);const te=S*100;Q>=j-10&&Q<=j+10&&(H+=`<br>${st()}: ${te.toFixed(0)}%`),Nt(H,q,Y)}).on("mouseout",()=>{N.style("opacity",0),qt()})}var aa=P('<div class="svelte-1bf093q"><b> </b> <span class="hidden-xs svelte-1bf093q"> </span></div>'),ra=P("<div> </div>"),sa=P("<div> </div>"),ia=P('<div class="svelte-1bf093q"> </div>'),la=P('<div class="svelte-1bf093q"> </div>'),na=P('<div class="svelte-1bf093q"> </div>'),oa=P('<div class="revlog-table svelte-1bf093q"><div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div></div>');function va(n,p){ce(p,!1);const o=X();let e=ee(p,"revlog",8);const S=!1;function v(a){switch(a.reviewKind){case G.LEARNING:return"revlog-learn";case G.REVIEW:return"revlog-review";case G.RELEARNING:return"revlog-relearn"}return""}function i(a){switch(a.reviewKind){case G.LEARNING:return pt();case G.REVIEW:return mt();case G.RELEARNING:return ft();case G.FILTERED:return ut();case G.MANUAL:return dt();case G.RESCHEDULED:return ct()}}function C(a){return a.buttonChosen===1?"revlog-ease1":""}function t(a,f){var b;const m=new Ne(Number(a.time));return{date:m.dateString(),time:m.timeString(),reviewKind:i(a),reviewKindClass:v(a),rating:a.buttonChosen,ratingClass:C(a),interval:W(a.interval),ease:r(a.ease),takenSecs:W(a.takenSecs,!0),elapsedTime:f,stability:(b=a.memoryState)!=null&&b.stability?W(a.memoryState.stability*86400):""}}function r(a){if(a===0)return"";const f=a/10;return f<=110?`D:${(f-10).toFixed(0)}%`:`${f.toFixed(0)}%`}J(()=>(y(e()),W),()=>{z(o,e().map((a,f)=>{let m,b=f+1;for(;b<e().length;){if(De(e()[b])){m=e()[b];break}b++}let A="N/A";return De(a)&&(A=m?W(Number(a.time)-Number(m.time)):"0"),t(a,A)}))}),ye(),ve();var g=Te(),x=he(g);{var D=a=>{var f=oa(),m=h(f),b=h(m),A=h(b,!0);c(b);var K=R(b,2);ae(K,5,()=>s(o),re,(k,w)=>{var d=aa(),F=h(d),Se=h(F,!0);c(F);var me=R(F,2),Me=h(me);c(me),c(d),U(()=>{var Re;T(Se,(s(w),u(()=>s(w).date))),T(Me,`@ ${(Re=(s(w),u(()=>s(w).time)))!=null?Re:""}`)}),$(k,d)}),c(K),c(m);var I=R(m,2),N=h(I),O=h(N,!0);c(N);var l=R(N,2);ae(l,5,()=>s(o),re,(k,w)=>{var d=ra(),F=h(d,!0);c(d),U(()=>{Le(d,1,ke((s(w),u(()=>s(w).reviewKindClass))),"svelte-1bf093q"),T(F,(s(w),u(()=>s(w).reviewKind)))}),$(k,d)}),c(l),c(I);var L=R(I,2),q=h(L),Y=h(q,!0);c(q);var Z=R(q,2);ae(Z,5,()=>s(o),re,(k,w)=>{var d=sa(),F=h(d,!0);c(d),U(()=>{Le(d,1,ke((s(w),u(()=>s(w).ratingClass))),"svelte-1bf093q"),T(F,(s(w),u(()=>s(w).rating)))}),$(k,d)}),c(Z),c(L);var Q=R(L,2),j=h(Q),H=h(j,!0);c(j);var te=R(j,2);ae(te,5,()=>s(o),re,(k,w)=>{var d=ia(),F=h(d,!0);c(d),U(()=>T(F,(s(w),u(()=>s(w).interval)))),$(k,d)}),c(te),c(Q);var le=R(Q,2),ie=h(le),_e=h(ie,!0);c(ie);var ue=R(ie,2);ae(ue,5,()=>s(o),re,(k,w)=>{var d=la(),F=h(d,!0);c(d),U(()=>T(F,(s(w),u(()=>s(w).ease)))),$(k,d)}),c(ue),c(le);var fe=R(le,2),E=h(fe),B=h(E,!0);c(E);var M=R(E,2);ae(M,5,()=>s(o),re,(k,w)=>{var d=na(),F=h(d,!0);c(d),U(()=>T(F,(s(w),u(()=>s(w).takenSecs)))),$(k,d)}),c(M),c(fe),c(f),U((k,w,d,F,Se,me)=>{T(A,k),T(O,w),T(Y,d),T(H,F),T(_e,Se),T(B,me)},[()=>(y(V),u(()=>lt())),()=>(y(V),u(()=>nt())),()=>(y(V),u(()=>ot())),()=>(y(V),u(()=>Ce())),()=>(y(V),u(()=>Ae())),()=>(y(V),u(()=>vt()))],oe),$(a,f)};se(x,a=>{y(e()),u(()=>e().length>0)&&a(D)})}return $(n,g),kt(p,"fsrsEnabled",S),de({fsrsEnabled:S})}var ca=P('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"/> </label>'),da=P('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"/> </label>'),ua=P('<div class="time-range-selector svelte-1niucon"><label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"/> </label> <label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"/> </label> <!> <!></div>'),fa=Ie("<svg><!><!><!></svg>"),ma=P('<div class="forgetting-curve svelte-1niucon"><!> <!></div>');function pa(n,p){ce(p,!1);const[o,e]=Ke(),S=()=>Pe(m,"$timeRange",o),v=X(),i=X(),C=[];let t=ee(p,"revlog",8),r=ee(p,"desiredRetention",8),g=ee(p,"decay",8),x=X(null);const D=Pt(),a=gt();let f=X(_.Week);const m=Dt(s(f));J(()=>y(t()),()=>{z(v,Qt(t()))}),J(()=>(s(v),_),()=>{z(i,qe(s(v),_.AllTime))}),J(()=>(s(i),_),()=>{s(i)>365?z(f,_.AllTime):s(i)>30?z(f,_.Year):s(i)>7&&z(f,_.Month)}),J(()=>s(f),()=>{ne(m,s(f))}),J(()=>(s(v),S(),s(x),y(r()),y(g())),()=>{ta(s(v),S(),s(x),D,r(),g())}),ye(),ve();var b=ma(),A=h(b);{var K=N=>{Bt(N,{children:(O,l)=>{var L=ua(),q=h(L),Y=h(q);pe(Y);var Z,Q=R(Y);c(q);var j=R(q,2),H=h(j);pe(H);var te,le=R(H);c(j);var ie=R(j,2);{var _e=E=>{var B=ca(),M=h(B);pe(M);var k,w=R(M);c(B),U(d=>{var F;k!==(k=(y(_),u(()=>_.Year)))&&(M.value=(F=M.__value=(y(_),u(()=>_.Year)))!=null?F:""),T(w,` ${d!=null?d:""}`)},[()=>(y(V),u(()=>_t()))],oe),ge(C,[],M,()=>(y(_),u(()=>_.Year),S()),d=>ne(m,d)),$(E,B)};se(ie,E=>{s(i)>30&&E(_e)})}var ue=R(ie,2);{var fe=E=>{var B=da(),M=h(B);pe(M);var k,w=R(M);c(B),U(d=>{var F;k!==(k=(y(_),u(()=>_.AllTime)))&&(M.value=(F=M.__value=(y(_),u(()=>_.AllTime)))!=null?F:""),T(w,` ${d!=null?d:""}`)},[()=>(y(V),u(()=>St()))],oe),ge(C,[],M,()=>(y(_),u(()=>_.AllTime),S()),d=>ne(m,d)),$(E,B)};se(ue,E=>{s(i)>365&&E(fe)})}c(L),U((E,B)=>{var M,k;Z!==(Z=(y(_),u(()=>_.Week)))&&(Y.value=(M=Y.__value=(y(_),u(()=>_.Week)))!=null?M:""),T(Q,` ${E!=null?E:""}`),te!==(te=(y(_),u(()=>_.Month)))&&(H.value=(k=H.__value=(y(_),u(()=>_.Month)))!=null?k:""),T(le,` ${B!=null?B:""}`)},[()=>(y(V),u(()=>ht())),()=>(y(V),u(()=>yt()))],oe),ge(C,[],Y,()=>(y(_),u(()=>_.Week),S()),E=>ne(m,E)),ge(C,[],H,()=>(y(_),u(()=>_.Month),S()),E=>ne(m,E)),$(O,L)},$$slots:{default:!0}})};se(A,N=>{s(i)>7&&N(K)})}var I=R(A,2);Mt(I,{get title(){return a},children:(N,O)=>{var l=fa(),L=h(l);It(L,{get bounds(){return D}});var q=R(L);Kt(q);var Y=R(q);Yt(Y,{get bounds(){return D}}),c(l),Wt(l,Z=>z(x,Z),()=>s(x)),U(()=>bt(l,"viewBox",u(()=>`0 0 ${D.width} ${D.height}`))),$(N,l)},$$slots:{default:!0}}),c(b),$(n,b),de(),e()}var ga=P("<!> <!> <!>",1),ba=P('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Na(n,p){ce(p,!1);const o=X(),e=X(),S=X();let v=ee(p,"stats",8,null),i=ee(p,"showRevlog",8,!0),C=ee(p,"showCurve",8,!0);J(()=>y(v()),()=>{var g;z(o,((g=v())==null?void 0:g.memoryState)!=null)}),J(()=>y(v()),()=>{var g,x;z(e,(x=(g=v())==null?void 0:g.desiredRetention)!=null?x:.9)}),J(()=>y(v()),()=>{z(S,(()=>{var x,D,a,f,m,b;const g=(a=(D=(x=v())==null?void 0:x.fsrsParams)==null?void 0:D.length)!=null?a:0;return g===0?.1542:g<21?.5:(b=(m=(f=v())==null?void 0:f.fsrsParams)==null?void 0:m[20])!=null?b:.1542})())}),ye(),ve();var t=ba(),r=he(t);wt(r,()=>({"--gutter-inline":"1rem","--gutter-block":"0.5rem"})),xt(r.lastChild,{breakpoint:"md",children:(g,x)=>{var D=Te(),a=he(D);{var f=b=>{var A=ga(),K=he(A);we(K,{children:(L,q)=>{Vt(L,{get stats(){return v()}})},$$slots:{default:!0}});var I=R(K,2);{var N=L=>{we(L,{children:(q,Y)=>{va(q,{get revlog(){return y(v()),u(()=>v().revlog)},get fsrsEnabled(){return s(o)}})},$$slots:{default:!0}})};se(I,L=>{i()&&L(N)})}var O=R(I,2);{var l=L=>{we(L,{children:(q,Y)=>{pa(q,{get revlog(){return y(v()),u(()=>v().revlog)},get desiredRetention(){return s(e)},get decay(){return s(S)}})},$$slots:{default:!0}})};se(O,L=>{s(o)&&C()&&L(l)})}$(b,A)},m=b=>{zt(b,{})};se(a,b=>{v()?b(f):b(m,!1)})}$(g,D)},$$slots:{default:!0}}),c(r),$(n,t),de()}export{Na as C};

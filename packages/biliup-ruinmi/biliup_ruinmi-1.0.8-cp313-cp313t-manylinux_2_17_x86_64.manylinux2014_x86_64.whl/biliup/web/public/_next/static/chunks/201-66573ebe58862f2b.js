"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[201],{97500:function(e,t,r){async function i(e,t){let{arg:r}=t,i=localStorage.getItem("auth"),l={"Content-Type":"application/json"};i&&(l.Authorization="Basic ".concat(i));let a=await fetch(""+e,{method:"POST",headers:l,body:JSON.stringify(r)});if(!(a.status>=200&&a.status<300))throw Error(await a.text());let n=await a.json();if(!a.ok)throw Error(n.message);return n}r.d(t,{_i:function(){return l},gz:function(){return o},hw:function(){return n},sj:function(){return a},wG:function(){return i}});let l=async function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=localStorage.getItem("auth"),l=t[1]||{},a=l.headers||{};if(i){let e={};a instanceof Headers?a.forEach((t,r)=>{e[r]=t}):e=Array.isArray(a)?Object.fromEntries(a):{...a},e.Authorization="Basic ".concat(i);let r=await fetch(""+t[0],{...l,headers:e});if(!r.ok)throw Error(await r.text());return r.json()}let n=await fetch(""+t[0],{...l,headers:a});if(!n.ok)throw Error(await n.text());return n.json()},a=async(e,t)=>{let r=localStorage.getItem("auth"),i=t||{},l=i.headers||{};if(r){let t={};l instanceof Headers?l.forEach((e,r)=>{t[r]=e}):t=Array.isArray(l)?Object.fromEntries(l):{...l},t.Authorization="Basic ".concat(r);let a=await fetch(""+e,{...i,headers:t});if(!a.ok)throw Error(await a.text());return a}let a=await fetch(""+e,{...i,headers:l});if(!a.ok)throw Error(await a.text());return a};async function n(e,t){let{arg:r}=t,i=localStorage.getItem("auth"),l={};i&&(l.Authorization="Basic ".concat(i));let a=await fetch("".concat("").concat(e,"/").concat(r),{method:"DELETE",headers:l});if(!a.ok)throw Error(await a.text());return a}async function o(e,t){let{arg:r}=t,i=localStorage.getItem("auth"),l={"Content-Type":"application/json"};i&&(l.Authorization="Basic ".concat(i));let a=await fetch("".concat("").concat(e),{method:"PUT",headers:l,body:JSON.stringify(r)});if(!a.ok)throw Error(await a.text());return a}},21659:function(e,t,r){r.d(t,{Bf:function(){return o},JB:function(){return s},ZP:function(){return n}});var i=r(85323),l=r(97500),a=r(2265);function n(){let{data:e,error:t,isLoading:r}=(0,i.ZP)("/v1/streamers",l._i);return{isLoading:r,streamers:e}}function o(){let{data:e,error:t,isLoading:r}=(0,i.ZP)("/v1/users",l._i),[n,o]=(0,a.useState)([]);return(0,a.useEffect)(()=>{if(!e||0===e.length)return;let t=async e=>{try{var t;let r=await (0,l._i)("/bili/space/myinfo?user=".concat(e.value),void 0),i=await (0,l.sj)("/bili/proxy?url=".concat(null===(t=r.data)||void 0===t?void 0:t.face)),a=await i.blob();return{...e,name:r.data.name,face:URL.createObjectURL(a)}}catch(i){console.error(i);let t=await (0,l.sj)("/bili/proxy?url=https://i0.hdslb.com/bfs/face/member/noface.jpg"),r=await t.blob();return{...e,name:"Cookie已失效",face:URL.createObjectURL(r)}}};Promise.all(e.map(t)).then(o)},[e]),{isLoading:r,isError:t,biliUsers:n}}function s(){var e;let{data:t,error:r,isLoading:a}=(0,i.ZP)("/bili/archive/pre",l._i);return{isLoading:a,isError:r,typeTree:null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.typelist.map(e=>({label:e.name,value:e.id,children:e.children}))}}},36699:function(e,t,r){r.d(t,{Fg:function(){return s},K4:function(){return o},cE:function(){return n},f:function(){return l},ql:function(){return a}});var i=r(2265);let l={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"},a=(e,t)=>{let{match:r,unmatch:i,callInInit:l=!0}=t;{let t=window.matchMedia(e),a=function(e){e.matches?r&&r(e):i&&i(e)};return(l&&a(t),Object.prototype.hasOwnProperty.call(t,"addEventListener"))?(t.addEventListener("change",a),()=>t.removeEventListener("change",a)):(t.addListener(a),()=>t.removeListener(a))}},n=e=>new Date(1e3*e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replaceAll("/","-"),o=()=>{let[e,t]=(0,i.useState)("light");return(0,i.useEffect)(()=>{let e=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t(e);let r=window.matchMedia("(prefers-color-scheme: dark)"),i=()=>t(e);return r.addEventListener("change",i),()=>r.removeEventListener("change",i)},[]),e},s=(e,t)=>{(0,i.useEffect)(()=>{switch(localStorage.setItem("mode",e),e){case"light":document.body.setAttribute("theme-mode","light");break;case"dark":document.body.setAttribute("theme-mode","dark");break;default:document.body.setAttribute("theme-mode",t)}},[e,t])}},9707:function(e,t,r){var i=r(57437),l=r(2265),a=r(62146),n=r(97349),o=r(48045),s=r(78499),c=r(76301),d=r(21659);t.Z=e=>{var t,r;let{formState:u,formApi:h,values:f}=e,{Section:m,Input:x,DatePicker:p,TimePicker:g,Select:w,Switch:y,InputNumber:b,Checkbox:j,CheckboxGroup:v,RadioGroup:E,Radio:S,Cascader:k,TagInput:_,TextArea:C}=c.Form,{Text:O}=c.Typography,{typeTree:z,isError:L,isLoading:A}=(0,d.JB)(),M=null==z?void 0:z.map(e=>({...e,children:e.children.map(e=>({label:(0,i.jsxs)(i.Fragment,{children:[e.name," ",(0,i.jsx)(O,{type:"quaternary",size:"small",children:e.desc})]}),value:e.id}))})),Z=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v,{field:"sound",options:[{label:"杜比音效",value:"dolby"},{label:"Hi-Res无损音质",value:"hires"}],direction:"horizontal",label:"音效设置"}),(0,i.jsx)(v,{field:"interaction",options:[{label:"关闭弹幕",value:"up_close_danmu"},{label:"关闭评论",value:"up_close_reply"},{label:"开启精选评论",value:"up_selection_reply"}],direction:"horizontal",label:"互动设置"}),(0,i.jsx)(x,{field:"dynamic",label:"粉丝动态",style:{width:464}}),(0,i.jsxs)(c.Form.Select,{field:"uploader",label:"上传插件",initValue:null!==(t=f.uploader)&&void 0!==t?t:"biliup-rs",style:{width:250},showClear:!0,children:[(0,i.jsx)(c.Form.Select.Option,{value:"bili_web",children:"bili_web"}),(0,i.jsx)(c.Form.Select.Option,{value:"biliup-rs",children:"biliup-rs"}),(0,i.jsx)(c.Form.Select.Option,{value:"Noop",children:"Noop"})]}),(0,i.jsx)(y,{field:"no_reprint",label:"自制声明"}),(0,i.jsx)(y,{field:"is_only_self",label:"仅自己可见"}),(0,i.jsx)(c.Form.Switch,{field:"charging_pay",label:"开启充电面板"}),(0,i.jsx)(c.OF,{field:"credits",children:e=>{let{add:t,arrayFields:r}=e;return(0,i.jsxs)(c.Form.Section,{text:"简介@替换",children:[(0,i.jsxs)("div",{className:"semi-form-field-extra",style:{fontSize:"14px"},children:["如需在简介中@别人，请使用此项。示例：",(0,i.jsx)("br",{}),"简介：","{","streamer","}","主播直播间地址：","{","url","}"," 【@credit】",(0,i.jsx)("br",{}),'其中的"@credits"会依次替换为下面输入的@']}),(0,i.jsx)(c.zx,{icon:(0,i.jsx)(a.Z,{}),onClick:t,theme:"light",children:"添加行"}),r.map((e,t)=>{let{field:r,key:l,remove:a}=e;return(0,i.jsxs)("div",{style:{width:1e3,display:"flex"},children:[(0,i.jsxs)(c.BZ,{children:[(0,i.jsx)(x,{field:"".concat(r,".username"),label:"需要@的用户名",placeholder:"username"}),(0,i.jsx)(x,{field:"".concat(r,".uid"),label:"需要@的uid",placeholder:"uid"})]}),(0,i.jsx)(c.zx,{type:"danger",theme:"borderless",icon:(0,i.jsx)(n.Z,{}),onClick:a,style:{margin:12}})]},l)})]})}})]}),[R,F]=(0,l.useState)(!1),{biliUsers:B}=(0,d.Bf)(),I=null==B?void 0:B.map(e=>({value:e.value,label:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.qE,{size:"extra-small",src:e.face}),(0,i.jsx)("span",{style:{marginLeft:8},children:e.name})]})})),T=Array(360).fill(0).map((e,t)=>({value:t,text:"".concat(t,"小时"),disabled:t<4||t>=360})),P=Array(12).fill(0).map((e,t)=>({value:5*t,text:"".concat(5*t,"分钟")})),[q,U]=(0,l.useState)(4),[D,N]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let e=h.getValue("dtime");if(e){let t=Math.floor(e/3600);t>=4&&t<360&&(U(t),N(5*Math.floor(Math.floor(e%3600/60)/5)))}},[h]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m,{text:"基本信息",children:[(0,i.jsx)(x,{rules:[{required:!0}],field:"template_name",label:"模板名称",style:{width:464}}),(0,i.jsx)(c.Form.Select,{rules:[{required:!0}],field:"user_cookie",label:{text:"投稿账号"},style:{width:176},optionList:I})]}),(0,i.jsxs)(m,{text:"基本设置",children:[(0,i.jsx)(x,{field:"title",label:"视频标题",style:{width:464},placeholder:"稿件标题",extraText:(0,i.jsxs)("div",{style:{fontSize:14},children:["{","streamer","}",": 录播备注",(0,i.jsx)("br",{}),"{","title","}",": 直播标题",(0,i.jsx)("br",{}),"%Y-%m-%d %H_%M_%S: 开始录制时的 年-月-日 时_分_秒"]})}),(0,i.jsxs)(E,{field:"copyright",label:"类型",direction:"vertical",initValue:null!==(r=h.getValue("copyright"))&&void 0!==r?r:2,extraText:(0,i.jsx)("div",{style:{fontSize:14},children:"如不填写转载来源默认为直播间地址"}),children:[(0,i.jsxs)(S,{value:2,style:{alignItems:"center",flexShrink:0},children:[(0,i.jsx)("span",{style:{flexShrink:0},children:"转载"}),(0,i.jsx)(x,{field:"copyright_source",onClick:()=>h.setValue("copyright",2),placeholder:"转载视频请注明来源（例：转自http://www.xx.com/yy）注明来源会更快地通过审核哦",noLabel:!0,fieldStyle:{padding:0,marginLeft:24,width:560}})]}),(0,i.jsx)("div",{onClick:()=>h.setValue("copyright_source",""),children:(0,i.jsx)(S,{value:1,children:"自制"})})]}),(0,i.jsx)(k,{field:"tid",label:"分区",style:{width:272},treeData:M,placeholder:"投稿分区",dropdownStyle:{maxWidth:670},rules:[{required:!0}]}),(0,i.jsx)(_,{max:12,maxLength:20,field:"tags",label:"标签",allowDuplicates:!1,addOnBlur:!0,separator:",",placeholder:"可用英文逗号分隔以批量输入标签，失焦/Enter 以保存",onChange:e=>console.log(e),style:{width:560},rules:[{required:!0,message:"Tag不能为空"}],onExceed:e=>{c.P_.warning({title:"标签输入错误",position:"top",content:"标签数量不能超过12个",duration:3})},onInputExceed:e=>{c.P_.warning({title:"标签输入错误",position:"top",content:"单个标签字数不能超过20",duration:3})}}),(0,i.jsx)(x,{field:"cover_path",label:"视频封面",style:{width:464},placeholder:"/cover/up.jpg"}),(0,i.jsx)(C,{style:{maxWidth:560},field:"description",label:"简介",placeholder:"填写更全面的相关信息，让更多的人能找到你的视频吧",autosize:!0,maxCount:2e3,showClear:!0}),(0,i.jsx)(C,{style:{maxWidth:560},field:"extra_fields",label:"额外字段",placeholder:"Json格式，示例：{key: 'value'}",autosize:!0,maxCount:2e3,showClear:!0,rules:[{validator:(e,t)=>{if(!t)return!0;try{return JSON.parse(t),!0}catch(e){return!1}},message:"请输入正确的Json格式文本"}]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",color:"var(--semi-color-tertiary)"},children:[(0,i.jsx)(y,{field:"isDtime",label:{text:"定时发布"},checkedText:"｜",uncheckedText:"〇"}),(0,i.jsx)("span",{style:{paddingLeft:12,fontSize:12},children:"(当前+2小时 ≤ 可选时间 ≤ 当前+15天，转载稿件撞车判定以过审发布时间为准。上传速度不佳的机器请谨慎开启，或设置更大的延迟时间。)"})]}),f.isDtime?(0,i.jsxs)(c.Rq,{style:{border:"unset",boxShadow:"unset",width:300,height:300},header:"延迟时间",footer:(0,i.jsx)(c.zx,{size:"small",type:"primary",onClick:()=>{let e=3600*q+60*D;h.setValue("dtime",e),c.P_.success({title:"保存成功",content:"延迟时间：".concat(q,"小时").concat(D,"分钟"),duration:3,position:"top"}),console.log(e)},children:"确认"}),children:[(0,i.jsx)(c.YC,{mode:"wheel",cycled:!0,list:T,type:1,selectedIndex:T.findIndex(e=>e.value===q),onSelect:e=>U(e.value)}),(0,i.jsx)(c.YC,{mode:"wheel",cycled:!0,list:P,type:2,selectedIndex:P.findIndex(e=>e.value===D),onSelect:e=>N(e.value)})]}):null]}),(0,i.jsx)(m,{style:{paddingBottom:40},text:(0,i.jsxs)("div",{style:{cursor:"pointer"},onClick:()=>{F(!R),h.scrollToField("isDtime")},children:["更多设置"," ",R?(0,i.jsx)(o.Z,{style:{marginLeft:12}}):(0,i.jsx)(s.Z,{style:{marginLeft:12}})]}),children:(0,i.jsx)(c.qq,{isOpen:R,keepDOM:!0,children:Z})})]})}},97349:function(e,t,r){var i=r(2265);let l=(0,r(87565).A)(function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 23a11 11 0 1 0 0-22 11 11 0 0 0 0 22ZM6.5 10.5h11a1.5 1.5 0 0 1 0 3h-11a1.5 1.5 0 0 1 0-3Z",fill:"currentColor"}))},"minus_circle");t.Z=l},62146:function(e,t,r){var i=r(2265);let l=(0,r(87565).A)(function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 23a11 11 0 1 0 0-22 11 11 0 0 0 0 22Zm7-11.12a1.5 1.5 0 0 1-1.47 1.52l-4 .07.07 4a1.5 1.5 0 0 1-3 .06l-.07-4-4 .07a1.5 1.5 0 0 1-.06-3l4-.07-.07-4a1.5 1.5 0 1 1 3-.06l.07 4 4-.07A1.5 1.5 0 0 1 19 11.88Z",fill:"currentColor"}))},"plus_circle");t.Z=l},65582:function(e,t,r){r.d(t,{Z:function(){return c}});var i=r(2265),l=r(62827),a=r(85323),n=r(60951);let o=n.I?e=>{e()}:i.startTransition,s=e=>{let[,t]=(0,i.useState)({}),r=(0,i.useRef)(!1),l=(0,i.useRef)(e),a=(0,i.useRef)({data:!1,error:!1,isValidating:!1}),o=(0,i.useCallback)(e=>{let i=!1,n=l.current;for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&n[t]!==e[t]&&(n[t]=e[t],a.current[t]&&(i=!0));i&&!r.current&&t({})},[]);return(0,n.v)(()=>(r.current=!1,()=>{r.current=!0})),[l,a.current,o]},c=(0,l.xD)(a.ZP,()=>(e,t,r={})=>{let{mutate:a}=(0,l.kY)(),c=(0,i.useRef)(e),d=(0,i.useRef)(t),u=(0,i.useRef)(r),h=(0,i.useRef)(0),[f,m,x]=s({data:n.U,error:n.U,isMutating:!1}),p=f.current,g=(0,i.useCallback)(async(e,t)=>{let[r,i]=(0,n.s)(c.current);if(!d.current)throw Error("Can’t trigger the mutation: missing fetcher.");if(!r)throw Error("Can’t trigger the mutation: missing key.");let l=(0,n.m)((0,n.m)({populateCache:!1,throwOnError:!0},u.current),t),s=(0,n.p)();h.current=s,x({isMutating:!0});try{let t=await a(r,d.current(i,{arg:e}),(0,n.m)(l,{throwOnError:!0}));return h.current<=s&&(o(()=>x({data:t,isMutating:!1,error:void 0})),null==l.onSuccess||l.onSuccess.call(l,t,r,l)),t}catch(e){if(h.current<=s&&(o(()=>x({error:e,isMutating:!1})),null==l.onError||l.onError.call(l,e,r,l),l.throwOnError))throw e}},[]),w=(0,i.useCallback)(()=>{h.current=(0,n.p)(),x({data:n.U,error:n.U,isMutating:!1})},[]);return(0,n.v)(()=>{c.current=e,d.current=t,u.current=r}),{trigger:g,reset:w,get data(){return m.data=!0,p.data},get error(){return m.error=!0,p.error},get isMutating(){return m.isMutating=!0,p.isMutating}}})}}]);
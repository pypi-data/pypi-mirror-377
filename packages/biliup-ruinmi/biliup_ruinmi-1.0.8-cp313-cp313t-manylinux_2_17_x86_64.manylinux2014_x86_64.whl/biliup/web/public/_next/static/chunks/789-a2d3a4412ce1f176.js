(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[789],{35901:function(e,t,r){"use strict";r.d(t,{H:function(){return l},a:function(){return n}});var a=r(57437),i=r(2265),s=r(99376);let o=(0,i.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,i.useState)(!1),n=(0,s.useRouter)();(0,i.useEffect)(()=>{let e=localStorage.getItem("auth");e?c(e).then(e=>{l(e),e||localStorage.removeItem("auth")}):d().then(e=>{e||l(!0)})},[]);let d=async()=>{try{let e=localStorage.getItem("auth"),t=await fetch("/api/basic",{headers:{Authorization:"Basic ".concat(e)}});return 401===t.status}catch(e){return!0}},c=async e=>{try{return(await fetch("/api/basic",{headers:{Authorization:"Basic ".concat(e)}})).ok}catch(e){return!1}},u=async(e,t)=>{try{let r=btoa("".concat(e,":").concat(t));if(await c(r))return localStorage.setItem("auth",r),l(!0),!0;return!1}catch(e){return!1}};return(0,a.jsx)(o.Provider,{value:{isAuthenticated:r,login:u,logout:()=>{localStorage.removeItem("auth"),l(!1),d().then(e=>{e?n.push("/login"):n.push("/")})}},children:t})}function n(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},34595:function(e,t,r){"use strict";r.d(t,{a:function(){return n}});var a=r(57437),i=r(35901),s=r(99376),o=r(2265),l=r(76301);function n(e){let{children:t}=e,{isAuthenticated:r}=(0,i.a)(),n=(0,s.useRouter)(),[d,c]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{if(r)c(!0);else{let e=localStorage.getItem("auth");fetch("/api/basic",{headers:{Authorization:"Basic ".concat(e)}}).then(e=>{401!==e.status?c(!0):n.push("/login")}).catch(()=>{n.push("/login")})}},[r,n]),(r||d)&&d)?(0,a.jsx)(a.Fragment,{children:t}):r||d?null:(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,a.jsx)(l.yC,{size:"large"})})}},61255:function(e,t,r){"use strict";r.d(t,{Z:function(){return K}});var a=r(57437),i=r(2265),s=r(99376),o=r(27648),l=r(76301),n=r(64711),d=r(9247),c=r(67050),u=r(20604),m=r(94731),h=r(67489),g=r(70787),x=r(42337),f=r(9083),y=r(24994),b=r(33145),p=r(66613),v=r(54197),j=r(62642),w=e=>{let[t,r]=(0,i.useState)(!1),[s,o]=(0,i.useState)((0,a.jsx)(p.Z,{size:"large"}));return(0,i.useEffect)(()=>{if(!0===t){let t=document.body,a=e.mode,i=a;switch(a){case"auto":i="light";break;case"light":i="dark";break;default:i="auto"}t.removeAttribute("theme-mode"),"auto"===i?t.setAttribute("theme-mode",e.systemTheme):t.setAttribute("theme-mode",i),e.setMode(i),r(!1)}switch(e.mode){case"light":o((0,a.jsx)(v.Z,{size:"large"}));break;case"dark":o((0,a.jsx)(j.Z,{size:"large"}));break;default:o((0,a.jsx)(p.Z,{size:"large"}))}},[e,t]),(0,a.jsx)(l.zx,{onClick:()=>{r(!0)},theme:"borderless",icon:s,style:{color:"var(--semi-color-text-2)"}})},k=r(36699),C=r(50196),S=r(76777),z=r.n(S);function K(e){let{children:t}=e,{Sider:r}=n.Layout,p=(0,s.usePathname)(),v=[];("streamers"===p.slice(1)||"history"===p.slice(1))&&(v=["manager"]);let[j,S]=(0,i.useState)(v),[K,L]=(0,i.useState)([p.slice(1)]),{width:Z}=(0,C.Z)(),[E,I]=(0,i.useState)(Z<=640),[A,R]=(0,i.useState)(localStorage.getItem("mode")||"auto"),_=(0,k.K4)();(0,k.Fg)(A,_);let B=E?{height:"100%",overflow:"visible"}:{height:"100%"};(0,i.useEffect)(()=>{Z<=640&&I(!0)},[Z]);let M=(0,i.useMemo)(()=>[{itemKey:"home",text:"主页",icon:(0,a.jsx)("div",{style:{backgroundColor:"#ffaa00ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,a.jsx)(d.Z,{size:"small"})})},{itemKey:"manager",text:"录播管理",items:[{itemKey:"streamers",text:"直播管理"},{itemKey:"history",text:"历史记录"}],icon:(0,a.jsx)("div",{style:{backgroundColor:"#5ac262ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,a.jsx)(c.Z,{size:"small"})})},{itemKey:"upload-manager",text:"投稿管理",icon:(0,a.jsx)("div",{style:{backgroundColor:"#885bd2ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,a.jsx)(u.Z,{size:"small"})})},{itemKey:"dashboard",text:"空间配置",icon:(0,a.jsx)("div",{style:{backgroundColor:"#6b6c75ff",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,a.jsx)(m.Z,{size:"small"})})},{itemKey:"job",text:"直播历史",icon:(0,a.jsx)("div",{style:{backgroundColor:"rgb(250 102 76)",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,a.jsx)(h.Z,{size:"small"})})},{text:"实时日志",icon:(0,a.jsx)("div",{style:{backgroundColor:"rgba(var(--semi-blue-4), 1)",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,a.jsx)(g.Z,{size:"small"})}),itemKey:"logViewer"},{text:"任务平台",icon:(0,a.jsx)("div",{style:{backgroundColor:"rgba(var(--semi-lime-2), 1)",borderRadius:"var(--semi-border-radius-medium)",color:"var(--semi-color-bg-0)",display:"flex",padding:"4px"},children:(0,a.jsx)(x.Z,{size:"small"})}),itemKey:"status"}].map(e=>(e.text=(0,a.jsx)("div",{style:{color:K.some(t=>e.itemKey===t)||K.some(e=>j.some(t=>{var r;return null===(r=({manager:["streamers","history"]})[t])||void 0===r?void 0:r.includes(e)}))&&j.some(t=>e.itemKey===t)?"var(--semi-color-text-0)":"var(--semi-color-text-2)",fontWeight:600},children:e.text}),e)),[j,K]),N=(0,i.useCallback)(e=>{let{itemElement:t,isSubNav:r,isInSubNav:i,props:s}=e,l={home:"/",history:"/history",dashboard:"/dashboard",streamers:"/streamers","upload-manager":"/upload-manager",job:"/job",status:"/status",logViewer:"/logviewer"};return l[s.itemKey]?(0,a.jsx)(o.default,{style:{textDecoration:"none",fontWeight:"600 !important"},href:l[s.itemKey],children:t}):t},[]),P=(0,i.useCallback)(()=>{I(!E)},[E]);return(0,a.jsxs)(n.Layout,{className:"components-layout-demo semi-light-scrollbar",children:[(0,a.jsx)(r,{children:(0,a.jsxs)(l.JL,{style:B,openKeys:j,selectedKeys:K,isCollapsed:E,renderWrapper:N,items:M,onOpenChange:e=>{S([...e.openKeys])},onSelect:e=>{L([...e.selectedKeys])},children:[(0,a.jsx)(l.JL.Header,{logo:(0,a.jsx)(b.default,{src:"/logo.png",alt:"{}",height:10,width:20}),style:E?{flexDirection:"column",paddingLeft:0,paddingRight:0,paddingBottom:0,gap:"8px"}:{justifyContent:"flex-start"},text:"BILIUP",children:(0,a.jsx)("div",{style:{flexGrow:1,display:Z<=640?"none":"flex",flexDirection:"row-reverse",zIndex:2},children:(0,a.jsx)(l.zx,{onClick:P,type:"tertiary",className:z().shadow,theme:"borderless",icon:E?(0,a.jsx)(f.Z,{}):(0,a.jsx)(y.Z,{})})})}),(0,a.jsxs)(l.JL.Footer,{collapseButton:!1,children:[(0,a.jsx)(w,{mode:A,setMode:R,systemTheme:_}),localStorage.getItem("auth")&&(0,a.jsx)(l.zx,{onClick:()=>{localStorage.removeItem("auth"),window.location.href="/login"},type:"danger",style:{marginTop:"10px",width:"100%"},children:"退出登录"})]})]})}),(0,a.jsx)(n.Layout,{style:{height:"100vh"},children:t})]})}},36699:function(e,t,r){"use strict";r.d(t,{Fg:function(){return n},K4:function(){return l},cE:function(){return o},f:function(){return i},ql:function(){return s}});var a=r(2265);let i={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"},s=(e,t)=>{let{match:r,unmatch:a,callInInit:i=!0}=t;{let t=window.matchMedia(e),s=function(e){e.matches?r&&r(e):a&&a(e)};return(i&&s(t),Object.prototype.hasOwnProperty.call(t,"addEventListener"))?(t.addEventListener("change",s),()=>t.removeEventListener("change",s)):(t.addListener(s),()=>t.removeListener(s))}},o=e=>new Date(1e3*e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replaceAll("/","-"),l=()=>{let[e,t]=(0,a.useState)("light");return(0,a.useEffect)(()=>{let e=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t(e);let r=window.matchMedia("(prefers-color-scheme: dark)"),a=()=>t(e);return r.addEventListener("change",a),()=>r.removeEventListener("change",a)},[]),e},n=(e,t)=>{(0,a.useEffect)(()=>{switch(localStorage.setItem("mode",e),e){case"light":document.body.setAttribute("theme-mode","light");break;case"dark":document.body.setAttribute("theme-mode","dark");break;default:document.body.setAttribute("theme-mode",t)}},[e,t])}},76777:function(e){e.exports={shadow:"page_shadow__LmobZ"}}}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{70171:function(e,l,s){Promise.resolve().then(s.bind(s,35243))},35243:function(e,l,s){"use strict";s.r(l),s.d(l,{default:function(){return w}});var r=s(57437),i=s(2265),a=s(76301),t=s(94731),n=s(62146),d=s(87565);let o=(0,d.A)(function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 12a11 11 0 1 1 22 0 11 11 0 0 1-22 0Zm11-8a8 8 0 0 0-8 8h4.71A4.29 4.29 0 0 1 13 16.29c0 .39-.32.71-.71.71H10c-.5 0-.91.5-.91 1.5S10 20 10.5 20H12a8 8 0 0 0 7.9-6.77c-.69.49-1.51.77-2.4.77a4.51 4.51 0 0 1-4.13-3H10c-.55 0-1.01-.45-.91-1 .51-2.81 2.41-4 4.78-3.95.19-.29.4-.55.64-.8.29-.27.24-.78-.14-.9A8 8 0 0 0 12 4Z",fill:"currentColor"}))},"globe");var c=s(85323),h=s(97500),x=s(65582),m=s(21659),p=s(48019),f=s.n(p),u=s(34595),g=s(61255),j=s(1371);let b=(0,d.A)(function(e){return i.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.84 8.06A6.5 6.5 0 1 0 5.18 11 4.5 4.5 0 0 0 5.5 20H17a6 6 0 0 0 .84-11.94Zm-6.16 9.67a.5.5 0 0 0 .64 0l5.15-4.29a.25.25 0 0 0-.16-.44H14V9.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V13H6.7c-.24 0-.35.3-.17.44l5.15 4.3Z",fill:"currentColor"}))},"download");var v=s(94467),y=()=>{let e=(0,a.XQ)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:f().frameDownload,children:[(0,r.jsxs)("div",{className:f().frameInside,children:[(0,r.jsxs)("div",{className:f().group,children:[(0,r.jsx)("div",{className:f().buttonOnlyIconSecond}),(0,r.jsx)("div",{className:f().lineStory,style:{color:"var(--semi-color-bg-0)",display:"flex"},children:(0,r.jsx)(b,{size:"small"})})]}),(0,r.jsx)("p",{className:f().meegoSharedWebWorkIt,children:"全局下载设置"})]}),(0,r.jsxs)(a.Form.Select,{label:"下载插件（downloader）",field:"downloader",placeholder:"stream-gears（默认）",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["选择全局默认的下载插件, 可选:",(0,r.jsx)("br",{}),"1. streamlink（仅限 hls 流，不支持的流将回退到 ffmpeg。非 Docker 用户需自行安装 FFmpeg）",(0,r.jsx)("br",{}),"2. ffmpeg（非 Docker 用户需自行安装 FFmpeg）",(0,r.jsx)("br",{}),"3. stream-gears（默认。防 FLV 流花屏）",(0,r.jsx)("br",{}),"4. sync-downloader（流式边录边传，需先为主播设定上传模板。不受 pool2/threads/segment_time 控制，默认 3 线程上传，请确保上传带宽充足。非 Docker 用户需自行安装 FFmpeg）详见 Wiki ",(0,r.jsx)("a",{href:"https://github.com/biliup/biliup/wiki/%E8%BE%B9%E5%BD%95%E8%BE%B9%E4%BC%A0%E5%8A%9F%E8%83%BD",target:"_blank",rel:"noopener noreferrer",children:"点击查看"}),(0,r.jsx)("br",{}),"5. ytarchive（仅适用于 Youtube Live）",(0,r.jsx)("br",{})]}),style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0,children:[(0,r.jsx)(a.Ph.Option,{value:"streamlink",children:"streamlink（hls多线程下载）"}),(0,r.jsx)(a.Ph.Option,{value:"ffmpeg",children:"ffmpeg"}),(0,r.jsx)(a.Ph.Option,{value:"stream-gears",children:"stream-gears（默认）"}),(0,r.jsx)(a.Ph.Option,{value:"sync-downloader",children:"sync-downloader（边录边传）"}),(0,r.jsx)(a.Ph.Option,{value:"ytarchive",children:"ytarchive（仅适用于 Youtube Live）"})]}),"sync-downloader"===e.getValue("downloader")?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(a.Form.Input,{field:"sync_save_dir",label:"边录边传额外保存本地目录（sync_save_dir）",placeholder:"",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0,disabled:"sync-downloader"!==e.getValue("downloader"),rules:[{pattern:/^[^*|?"<>]*$/,message:'路径中不能包含Windows不允许的字符 * | ? " < >'},{pattern:/^(?![a-zA-Z]：).*$/,message:"以字母开头时，第二个字符不能是中文冒号"},{pattern:/^[^:]*$|^[a-zA-Z]:[\/\\][^:]*$/,message:"冒号只能出现在第二个字符位置，且后面必须连接斜杠"},{pattern:/^(?!.*?\.{3,})(?!.*?\.{2}(?![\/\\])).*$/,message:"点号最多只能连续出现两次，且后面必须连接斜杠"},{pattern:/^(?!.*\/\\)(?!.*\\\/).*$/,message:"不允许连接正反斜杠"},{pattern:/^(?!.*([\\]{3,}|[\/]{2,})).*$/,message:"反斜杠最多只能连续出现两次，正斜杠最多只能连续出现一次"}],stopValidateWithError:!0})}):null,(0,r.jsx)(a.Form.InputNumber,{label:"视频分段大小（file_size）",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["录像单文件大小限制，超过此大小触发文件分割。下载回放时无法使用。",(0,r.jsx)("br",{}),"单位：Byte，示例：4294967296（4GB）"]}),field:"file_size",placeholder:"",suffix:"Byte",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0}}),(0,r.jsx)(a.Form.Input,{field:"segment_time",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["录像单文件时间限制，超过此时长触发文件分割。",(0,r.jsx)("br",{}),"格式：'00:00:00'（时:分:秒）"]}),label:"视频分段时长（segment_time）",placeholder:"01:00:00",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0,rules:[{pattern:/^[^：]*$/,message:"请使用英文冒号"},{pattern:/^[0-9:]*$/,message:"只接受数字和英文冒号"},{pattern:/^[0-9]{2,4}:[0-5][0-9]:[0-5][0-9]$/,message:"分或秒不符合规范"}],stopValidateWithError:!0}),(0,r.jsx)(a.Form.Input,{field:"filename_prefix",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["全局文件名模板。可被单个主播文件名模板覆盖。可用变量如下",(0,r.jsx)("br",{}),"{","streamer","}",": 录播备注（必须保留）",(0,r.jsx)("span",{style:{margin:"0 20px"}}),"{","title","}",": 直播标题",(0,r.jsx)("br",{}),"%Y-%m-%d %H_%M_%S: 开始录制时的 年-月-日 时_分_秒"]}),label:"文件名模板（filename_prefix）",placeholder:"{streamer}%Y-%m-%dT%H_%M_%S",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0}),(0,r.jsx)(a.Form.Switch,{field:"segment_processor_parallel",extraText:(0,r.jsx)("div",{style:{fontSize:"14px"},children:"开启后无法保证分段后处理先后执行顺序"}),label:"视频分段后处理并行（segment_processor_parallel)",fieldStyle:{alignSelf:"stretch",padding:0}}),(0,r.jsx)(a.Form.InputNumber,{field:"filtering_threshold",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["小于此大小的视频文件将会被过滤删除。",(0,r.jsx)("br",{}),"单位：MB"]}),label:"碎片过滤（filtering_threshold）",suffix:"MB",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0}),(0,r.jsx)(a.Form.InputNumber,{field:"delay",label:"下播延迟检测（delay)",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["当检测到主播下播后，延迟一定时间再次检测确认，避免特殊情况提早启动上传导致分稿件。",(0,r.jsx)("br",{}),"单位：秒",(0,r.jsx)("br",{}),"默认延迟时间为 0 秒"]}),placeholder:"0",suffix:"s",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0}),(0,r.jsx)(a.Form.InputNumber,{field:"event_loop_interval",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["单个主播检测间隔时间，单位：秒。比如虎牙有10个主播，每个主播会间隔10秒检测",(0,r.jsx)("br",{}),"单位：秒"]}),label:"直播事件检测间隔（event_loop_interval）",suffix:"s",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0}),(0,r.jsx)(a.Form.InputNumber,{field:"pool1_size",extraText:"负责下载事件的线程池大小，用于限制最大同时录制数。",label:"下载线程池大小（pool1_size）",placeholder:5,style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0})]}),(0,r.jsx)(a.T,{}),(0,r.jsxs)("div",{className:f().frameUpload,children:[(0,r.jsxs)("div",{className:f().frameInside,children:[(0,r.jsxs)("div",{className:f().group,children:[(0,r.jsx)("div",{className:f().buttonOnlyIconSecond}),(0,r.jsx)("div",{className:f().lineStory,style:{color:"var(--semi-color-bg-0)",display:"flex"},children:(0,r.jsx)(v.Z,{size:"small"})})]}),(0,r.jsx)("p",{className:f().meegoSharedWebWorkIt,children:"全局上传设置"})]}),(0,r.jsxs)(a.Form.Select,{field:"submit_api",label:"提交接口（submit_api）",extraText:"B站投稿提交接口，默认为自动选择。",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0,children:[(0,r.jsx)(a.Form.Select.Option,{value:"app",children:"安卓APP（app）"}),(0,r.jsx)(a.Form.Select.Option,{value:"b-cut-android",children:"BCut安卓APP（b-cut-android）"}),(0,r.jsx)(a.Form.Select.Option,{value:"web",children:"网页（web）"})]}),(0,r.jsxs)(a.Form.Select,{field:"uploader",label:"上传插件（uploader）",extraText:"全局默认上传插件选择。",placeholder:"biliup-rs",noLabel:!0,style:{width:"100%",display:"none"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0,initValue:"Noop",children:[(0,r.jsx)(a.Form.Select.Option,{value:"bili_web",children:"bili_web"}),(0,r.jsx)(a.Form.Select.Option,{value:"biliup-rs",children:"biliup-rs"}),(0,r.jsx)(a.Form.Select.Option,{value:"Noop",children:"Noop（即不上传，但会执行后处理）"})]}),(0,r.jsxs)(a.Form.Select,{field:"lines",label:"上传线路（lines）",extraText:"b站上传线路选择，默认为自动模式，可手动切换为bda, bda2, ws, qn, bldsa, tx, txa",placeholder:"AUTO（自动，默认）",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0,children:[(0,r.jsx)(a.Form.Select.Option,{value:"AUTO",children:"AUTO（自动，默认）"}),(0,r.jsx)(a.Form.Select.Option,{value:"alia",children:"alia（海外-阿里云）"}),(0,r.jsx)(a.Form.Select.Option,{value:"bda2",children:"bda2（大陆-百度云）"}),(0,r.jsx)(a.Form.Select.Option,{value:"bldsa",children:"bldsa（大陆-B站自建）"}),(0,r.jsx)(a.Form.Select.Option,{value:"qn",children:"qn（全球-七牛）"}),(0,r.jsx)(a.Form.Select.Option,{value:"tx",children:"tx（大陆-腾讯云）"}),(0,r.jsx)(a.Form.Select.Option,{value:"txa",children:"txa（海外-腾讯云）"})]}),(0,r.jsx)(a.Form.InputNumber,{field:"threads",placeholder:3,extraText:"单文件并发上传数,未达到带宽上限时,增大此值可提高上传速度(不要设置过大,部分线路限制为8,如速度不佳优先调整上传线路)",label:"上传并发（threads）",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0}),(0,r.jsx)(a.Form.InputNumber,{field:"max_upload_limit",placeholder:8,extraText:"录播上传次数上限，防止因意外情况如B站接口抽风、录播本身损坏导致录播反复上传浪费宽带或被B站风控（注：限制是记录在程序上下文中的，重启程序会重置上传次数限制；且为了保证尽量不改动老用户使用逻辑，默认将此值设置为一个较大的值，一般推荐设置为2-3）",label:"上传重试次数限制（max_upload_limit）",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},showClear:!0}),(0,r.jsx)(a.Form.InputNumber,{field:"pool2_size",extraText:(0,r.jsx)("div",{style:{fontSize:"14px"},children:"负责上传事件的线程池大小。根据实际带宽设置。"}),placeholder:3,label:"上传线程池大小（pool2_size）",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0}}),(0,r.jsx)(a.Form.Switch,{field:"use_live_cover",extraText:(0,r.jsxs)("div",{style:{fontSize:"14px"},children:["使用直播间封面作为投稿封面。此封面优先级低于单个主播指定的自定义封面，保存于cover文件夹下，上传后自动删除。",(0,r.jsx)("br",{}),"目前支持平台：哔哩哔哩，克拉克拉，Twitch，YouTube。"]}),label:"使用直播间封面作为投稿封面（use_live_cover)",fieldStyle:{alignSelf:"stretch",padding:0}})]})]})},_=s(42337),S=()=>{let e=(0,a.XQ)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:f().frameDeveloper,children:[(0,r.jsxs)("div",{className:f().frameInside,children:[(0,r.jsxs)("div",{className:f().group,children:[(0,r.jsx)("div",{className:f().buttonOnlyIconSecond}),(0,r.jsx)("div",{className:f().lineStory,style:{color:"var(--semi-color-bg-0)",display:"flex"},children:(0,r.jsx)(_.Z,{size:"small"})})]}),(0,r.jsx)("p",{className:f().meegoSharedWebWorkIt,children:"开发者选项"})]}),(0,r.jsxs)(a.Form.Select,{label:" 控制台日志输出等级（LOGGING.root.level）",field:"LOGGING.root.level",placeholder:"INFO",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},onChange:()=>{e.setValue("LOGGING.root.handlers",["console"])},showClear:!0,children:[(0,r.jsx)(a.Ph.Option,{value:"DEBUG",children:"DEBUG"}),(0,r.jsx)(a.Ph.Option,{value:"INFO",children:"INFO"}),(0,r.jsx)(a.Ph.Option,{value:"WARNING",children:"WARNING"}),(0,r.jsx)(a.Ph.Option,{value:"ERROR",children:"ERROR"}),(0,r.jsx)(a.Ph.Option,{value:"CRITICAL",children:"CRITICAL"})]}),(0,r.jsxs)(a.Form.Select,{label:" 文件日志输出等级（LOGGING.loggers.biliup.level）",field:"LOGGING.loggers.biliup.level",placeholder:"INFO",style:{width:"100%"},fieldStyle:{alignSelf:"stretch",padding:0},onChange:()=>{e.setValue("LOGGING.loggers.biliup.handlers",["file"])},showClear:!0,children:[(0,r.jsx)(a.Ph.Option,{value:"DEBUG",children:"DEBUG"}),(0,r.jsx)(a.Ph.Option,{value:"INFO",children:"INFO"}),(0,r.jsx)(a.Ph.Option,{value:"WARNING",children:"WARNING"}),(0,r.jsx)(a.Ph.Option,{value:"ERROR",children:"ERROR"}),(0,r.jsx)(a.Ph.Option,{value:"CRITICAL",children:"CRITICAL"})]})]})})},w=()=>{let{Header:e,Content:l}=a.Layout,{data:s,error:d,isLoading:p}=(0,c.ZP)("/v1/configuration",h._i),{trigger:b}=(0,x.Z)("/v1/configuration",h.gz),v=(0,i.useRef)(),{biliUsers:_}=(0,m.Bf)();if(p)return(0,r.jsx)(r.Fragment,{children:"Loading"});if(d)return(0,r.jsxs)(r.Fragment,{children:[" error ",JSON.stringify(d)]});let w=null==_?void 0:_.map(e=>({value:e.value,label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.qE,{size:"extra-small",src:e.face}),(0,r.jsx)("span",{style:{marginLeft:8},children:e.name})]})}));return(0,r.jsx)(u.a,{children:(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(e,{style:{backgroundColor:"var(--semi-color-bg-1)",position:"sticky",top:0,zIndex:1},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"0 20px",height:"60px",backgroundColor:"var(--semi-color-bg-1)",boxShadow:"0 1px 2px 0 rgb(0 0 0 / 0.05)"},children:[(0,r.jsx)("div",{style:{backgroundColor:"#6b6c75ff",borderRadius:"var(--semi-border-radius-large)",color:"var(--semi-color-bg-0)",display:"flex",padding:"6px"},children:(0,r.jsx)(t.Z,{size:"large"})}),(0,r.jsx)("h4",{style:{marginLeft:"12px",margin:0},children:"空间配置"}),(0,r.jsx)("div",{style:{marginLeft:"auto"},children:(0,r.jsx)(a.zx,{onClick:()=>{var e;null===(e=v.current)||void 0===e||e.submitForm()},icon:(0,r.jsx)(n.Z,{}),theme:"solid",style:{marginRight:10},children:"保存"})})]})}),(0,r.jsx)(l,{children:(0,r.jsx)("main",{className:f().rootConfigPanel,children:(0,r.jsx)("div",{className:f().main,children:(0,r.jsx)("div",{className:f().content,children:(0,r.jsxs)(a.Form,{className:f().form,initValues:s,onSubmit:async e=>{try{await b(e),a.FN.success("保存成功")}catch(e){throw a.P_.error({title:"保存失败",content:(0,r.jsx)(a.Typography,{style:{maxWidth:450},children:e.message}),style:{width:"min-content"}}),e}},getFormApi:e=>v.current=e,children:[(0,r.jsxs)(a.mQ,{type:"line",contentStyle:{maxWidth:965,margin:"10px auto 0 auto"},children:[(0,r.jsx)(a.Jm,{tab:"全局设置",itemKey:"1",children:(0,r.jsx)(y,{})}),(0,r.jsx)(a.Jm,{tab:"各平台下载",itemKey:"2",children:(0,r.jsxs)("div",{className:f().framePlatformConfig,children:[(0,r.jsxs)("div",{className:f().frameInside,children:[(0,r.jsx)("div",{className:f().group,children:(0,r.jsx)("div",{className:f().buttonOnlyIconSecond,children:(0,r.jsx)("div",{className:f().lineStory,style:{color:"var(--semi-color-bg-0)",display:"flex"},children:(0,r.jsx)(o,{size:"small"})})})}),(0,r.jsx)("p",{className:f().meegoSharedWebSettin,children:"各平台下载设置"})]}),(0,r.jsxs)(a.UO,{keepDOM:!0,style:{width:"100%"},children:[Object.entries(j.ZP).filter(e=>{let[l]=e;return"Cookie"!==l}).map(e=>{let[l,i]=e;return(0,r.jsx)(i,{entity:s,list:w})}),(0,r.jsx)(j.ZP.Cookie,{entity:s,list:w})]})]})}),(0,r.jsx)(a.Jm,{tab:"开发者选项",itemKey:"3",children:(0,r.jsx)(S,{})})]}),(0,r.jsx)(a.T,{}),(0,r.jsx)(a.T,{style:{height:"160px"}})]})})})})})]})})}},48019:function(e){e.exports={rootConfigPanel:"dashboard_rootConfigPanel__H00R1",main:"dashboard_main__Rc_0B",content:"dashboard_content__hwJmk",item:"dashboard_item__vd6Dr",form:"dashboard_form__ts2vk",frameDownload:"dashboard_frameDownload__vBT0s",frameInside:"dashboard_frameInside__nNRYf",group:"dashboard_group__kyWYT",buttonOnlyIconSecond:"dashboard_buttonOnlyIconSecond__U2c3u",lineStory:"dashboard_lineStory__ARf86",meegoSharedWebWorkIt:"dashboard_meegoSharedWebWorkIt__ZfysV",frameUpload:"dashboard_frameUpload__FCZ0P",framePlatformConfig:"dashboard_framePlatformConfig__4y_44",outlinedVersion:"dashboard_outlinedVersion__aPpHQ",meegoSharedWebSettin:"dashboard_meegoSharedWebSettin__Kvwzx",frameDeveloper:"dashboard_frameDeveloper__bO23h",line:"dashboard_line__dTs9X"}}},function(e){e.O(0,[916,737,877,623,290,852,191,147,429,597,326,301,25,469,323,789,497,971,117,744],function(){return e(e.s=70171)}),_N_E=e.O()}]);
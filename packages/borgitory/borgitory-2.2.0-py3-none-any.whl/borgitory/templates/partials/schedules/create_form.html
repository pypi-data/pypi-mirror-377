<!-- Create Schedule -->
<div class="border dark:border-gray-600 rounded-lg p-4">
    <h3 class="font-medium text-gray-900 dark:text-gray-100 mb-3">Create Schedule</h3>
    <form 
        hx-post="/api/schedules/" 
        hx-ext="json-enc"
        hx-target="#schedule-status"
    >
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Name</label>
                <input type="text" name="name" required placeholder="Daily backup" class="mt-1 input-modern block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-gray-900 dark:text-gray-100">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Repository</label>
                <select name="repository_id" required class="select-modern w-full">
                    <option value="">Select Repository...</option>
                    {% for repo in repositories %}
                    <option value="{{ repo.id }}">{{ repo.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Source Path</label>
                {% set input_id = "schedule-source-path" %}
                {% set input_name = "source_path" %}
                {% set input_value = "/mnt/" %}
                {% set placeholder = "Enter path for scheduled backups" %}
                {% set required = false %}
                {% include "partials/shared/path_autocomplete.html" %}
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Schedule</label>
                <select 
                    id="schedule-preset" 
                    class="select-modern w-full"
                    hx-get="/api/schedules/cron-expression-form"
                    hx-target="#cron-expression-container"
                    hx-include="this"
                    name="preset">
                    <option value="">Select a preset...</option>
                    <option value="0 2 * * *">Daily at 2:00 AM</option>
                    <option value="0 2 * * 0">Weekly on Sunday at 2:00 AM</option>
                    <option value="0 2 1 * *">Monthly on 1st at 2:00 AM</option>
                    <option value="0 2 1,15 * *">Twice monthly (1st and 15th) at 2:00 AM</option>
                    <option value="0 2 */2 * *">Every 2 days at 2:00 AM</option>
                    <option value="custom">Custom (cron expression)</option>
                </select>
            </div>
            <div id="cron-expression-container">
                <!-- Dynamic cron expression form elements will be loaded here -->
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Archive Cleanup (Optional)</label>
                <select name="cleanup_config_id" id="schedule-cleanup-select" class="select-modern w-full">
                    <option value="">No cleanup</option>
                    {% for config in cleanup_configs %}
                    <option value="{{ config.id }}">{{ config.name }}</option>
                    {% endfor %}
                </select>
                <p class="mt-1 text-xs text-gray-600 dark:text-gray-400">Automatically prune old archives after each scheduled backup</p>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Cloud Backup (Optional)</label>
                <select name="cloud_sync_config_id" id="schedule-cloud-select" class="select-modern w-full">
                    <option value="">No cloud backup</option>
                    {% for config in cloud_sync_configs %}
                    <option value="{{ config.id }}">{{ config.name }}</option>
                    {% endfor %}
                </select>
                <p class="mt-1 text-xs text-gray-600 dark:text-gray-400">Automatically backup to cloud after each scheduled Borg backup</p>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Repository Check (Optional)</label>
                <select name="check_config_id" id="schedule-check-select" class="select-modern w-full">
                    <option value="">No check</option>
                    {% for config in check_configs %}
                    <option value="{{ config.id }}">{{ config.name }}</option>
                    {% endfor %}
                </select>
                <p class="mt-1 text-xs text-gray-600 dark:text-gray-400">Verify repository integrity after each scheduled backup</p>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-900 dark:text-gray-100">Notifications (Optional)</label>
                <select name="notification_config_id" id="schedule-notification-select" class="select-modern w-full">
                    <option value="">No notifications</option>
                    {% for config in notification_configs %}
                    <option value="{{ config.id }}">{{ config.name }}</option>
                    {% endfor %}
                </select>
                <p class="mt-1 text-xs text-gray-600 dark:text-gray-400">Get notified when scheduled backup completes or fails</p>
            </div>
            <button type="submit" class="w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                Create Schedule
            </button>
        </div>
    </form>
    <div id="schedule-status" class="mt-4"></div>
</div>

<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Command Line Tools &#8212; cedar-backup3 3.10.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=6625fa76" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=ec641305" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <script src="../_static/documentation_options.js?v=f8d09eac"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="command-line-tools">
<span id="cedar-commandline"></span><h1>Command Line Tools<a class="headerlink" href="#command-line-tools" title="Link to this heading">¶</a></h1>
<section id="overview">
<span id="cedar-commandline-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>Cedar Backup comes with three command-line programs: <code class="docutils literal notranslate"><span class="pre">cback3</span></code>,
<code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code>, and <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command is the primary command line interface and the
only Cedar Backup program that most users will ever need.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> tool is used for synchronizing entire
directories of files up to an Amazon S3 cloud storage bucket, outside of
the normal Cedar Backup process.</p>
<p>Users who have a <em>lot</em> of data to back up — more than will fit on a
single CD or DVD — can use the interactive <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> tool to
split their data between multiple discs.</p>
</section>
<section id="the-cback3-command">
<span id="cedar-commandline-cback3"></span><h2>The <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command<a class="headerlink" href="#the-cback3-command" title="Link to this heading">¶</a></h2>
<section id="introduction">
<span id="cedar-commandline-cback3-intro"></span><h3>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h3>
<p>Cedar Backup’s primary command-line interface is the <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command.
It controls the entire backup process.</p>
</section>
<section id="syntax">
<span id="cedar-commandline-cback3-syntax"></span><h3>Syntax<a class="headerlink" href="#syntax" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command has the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="n">cback3</span> <span class="p">[</span><span class="n">switches</span><span class="p">]</span> <span class="n">action</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">switches</span> <span class="n">are</span> <span class="n">accepted</span><span class="p">:</span>

  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>         <span class="n">Display</span> <span class="n">this</span> <span class="n">usage</span><span class="o">/</span><span class="n">help</span> <span class="n">listing</span>
  <span class="o">-</span><span class="n">V</span><span class="p">,</span> <span class="o">--</span><span class="n">version</span>      <span class="n">Display</span> <span class="n">version</span> <span class="n">information</span>
  <span class="o">-</span><span class="n">b</span><span class="p">,</span> <span class="o">--</span><span class="n">verbose</span>      <span class="n">Print</span> <span class="n">verbose</span> <span class="n">output</span> <span class="k">as</span> <span class="n">well</span> <span class="k">as</span> <span class="n">logging</span> <span class="n">to</span> <span class="n">disk</span>
  <span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">--</span><span class="n">quiet</span>        <span class="n">Run</span> <span class="n">quietly</span> <span class="p">(</span><span class="n">display</span> <span class="n">no</span> <span class="n">output</span> <span class="n">to</span> <span class="n">the</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="o">--</span><span class="n">config</span>       <span class="n">Path</span> <span class="n">to</span> <span class="n">config</span> <span class="n">file</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cback3</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span>
  <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="o">--</span><span class="n">full</span>         <span class="n">Perform</span> <span class="n">a</span> <span class="n">full</span> <span class="n">backup</span><span class="p">,</span> <span class="n">regardless</span> <span class="n">of</span> <span class="n">configuration</span>
  <span class="o">-</span><span class="n">M</span><span class="p">,</span> <span class="o">--</span><span class="n">managed</span>      <span class="n">Include</span> <span class="n">managed</span> <span class="n">clients</span> <span class="n">when</span> <span class="n">executing</span> <span class="n">actions</span>
  <span class="o">-</span><span class="n">N</span><span class="p">,</span> <span class="o">--</span><span class="n">managed</span><span class="o">-</span><span class="n">only</span> <span class="n">Include</span> <span class="n">ONLY</span> <span class="n">managed</span> <span class="n">clients</span> <span class="n">when</span> <span class="n">executing</span> <span class="n">actions</span>
  <span class="o">-</span><span class="n">l</span><span class="p">,</span> <span class="o">--</span><span class="n">logfile</span>      <span class="n">Path</span> <span class="n">to</span> <span class="n">logfile</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">cback3</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
  <span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="o">--</span><span class="n">owner</span>        <span class="n">Logfile</span> <span class="n">ownership</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span><span class="n">group</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">root</span><span class="p">:</span><span class="n">adm</span><span class="p">)</span>
  <span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="o">--</span><span class="n">mode</span>         <span class="n">Octal</span> <span class="n">logfile</span> <span class="n">permissions</span> <span class="n">mode</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">640</span><span class="p">)</span>
  <span class="o">-</span><span class="n">O</span><span class="p">,</span> <span class="o">--</span><span class="n">output</span>       <span class="n">Record</span> <span class="n">some</span> <span class="n">sub</span><span class="o">-</span><span class="n">command</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">cdrecord</span><span class="p">)</span> <span class="n">output</span> <span class="n">to</span> <span class="n">the</span> <span class="n">log</span>
  <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">--</span><span class="n">debug</span>        <span class="n">Write</span> <span class="n">debugging</span> <span class="n">information</span> <span class="n">to</span> <span class="n">the</span> <span class="n">log</span> <span class="p">(</span><span class="n">implies</span> <span class="o">--</span><span class="n">output</span><span class="p">)</span>
  <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="o">--</span><span class="n">stack</span>        <span class="n">Dump</span> <span class="n">a</span> <span class="n">Python</span> <span class="n">stack</span> <span class="n">trace</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">swallowing</span> <span class="n">exceptions</span>
  <span class="o">-</span><span class="n">D</span><span class="p">,</span> <span class="o">--</span><span class="n">diagnostics</span>  <span class="n">Print</span> <span class="n">runtime</span> <span class="n">diagnostics</span> <span class="n">to</span> <span class="n">the</span> <span class="n">screen</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">actions</span> <span class="n">may</span> <span class="n">be</span> <span class="n">specified</span><span class="p">:</span>

  <span class="nb">all</span>                <span class="n">Take</span> <span class="nb">all</span> <span class="n">normal</span> <span class="n">actions</span> <span class="p">(</span><span class="n">collect</span><span class="p">,</span> <span class="n">stage</span><span class="p">,</span> <span class="n">store</span><span class="p">,</span> <span class="n">purge</span><span class="p">)</span>
  <span class="n">collect</span>            <span class="n">Take</span> <span class="n">the</span> <span class="n">collect</span> <span class="n">action</span>
  <span class="n">stage</span>              <span class="n">Take</span> <span class="n">the</span> <span class="n">stage</span> <span class="n">action</span>
  <span class="n">store</span>              <span class="n">Take</span> <span class="n">the</span> <span class="n">store</span> <span class="n">action</span>
  <span class="n">purge</span>              <span class="n">Take</span> <span class="n">the</span> <span class="n">purge</span> <span class="n">action</span>
  <span class="n">rebuild</span>            <span class="n">Rebuild</span> <span class="s2">&quot;this week&#39;s&quot;</span> <span class="n">disc</span> <span class="k">if</span> <span class="n">possible</span>
  <span class="n">validate</span>           <span class="n">Validate</span> <span class="n">configuration</span> <span class="n">only</span>
  <span class="n">initialize</span>         <span class="n">Initialize</span> <span class="n">media</span> <span class="k">for</span> <span class="n">use</span> <span class="k">with</span> <span class="n">Cedar</span> <span class="n">Backup</span>

<span class="n">You</span> <span class="n">may</span> <span class="n">also</span> <span class="n">specify</span> <span class="n">extended</span> <span class="n">actions</span> <span class="n">that</span> <span class="n">have</span> <span class="n">been</span> <span class="n">defined</span> <span class="ow">in</span>
<span class="n">configuration</span><span class="o">.</span>

<span class="n">You</span> <span class="n">must</span> <span class="n">specify</span> <span class="n">at</span> <span class="n">least</span> <span class="n">one</span> <span class="n">action</span> <span class="n">to</span> <span class="n">take</span><span class="o">.</span>  <span class="n">More</span> <span class="n">than</span> <span class="n">one</span> <span class="n">of</span>
<span class="n">the</span> <span class="s2">&quot;collect&quot;</span><span class="p">,</span> <span class="s2">&quot;stage&quot;</span><span class="p">,</span> <span class="s2">&quot;store&quot;</span> <span class="ow">or</span> <span class="s2">&quot;purge&quot;</span> <span class="n">actions</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span>
<span class="n">extended</span> <span class="n">actions</span> <span class="n">may</span> <span class="n">be</span> <span class="n">specified</span> <span class="ow">in</span> <span class="nb">any</span> <span class="n">arbitrary</span> <span class="n">order</span><span class="p">;</span> <span class="n">they</span>
<span class="n">will</span> <span class="n">be</span> <span class="n">executed</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">sensible</span> <span class="n">order</span><span class="o">.</span>  <span class="n">The</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;rebuild&quot;</span><span class="p">,</span>
<span class="s2">&quot;validate&quot;</span><span class="p">,</span> <span class="ow">and</span> <span class="s2">&quot;initialize&quot;</span> <span class="n">actions</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">combined</span> <span class="k">with</span>
<span class="n">other</span> <span class="n">actions</span><span class="o">.</span>
</pre></div>
</div>
<p>Note that the all action <em>only</em> executes the standard four actions. It
never executes any of the configured extensions.  <a class="footnote-reference brackets" href="#id8" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
</section>
<section id="switches">
<span id="cedar-commandline-cback3-options"></span><h3>Switches<a class="headerlink" href="#switches" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></dt><dd><p>Display usage/help listing.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-V</span></code>, <code class="docutils literal notranslate"><span class="pre">--version</span></code></dt><dd><p>Display version information.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-b</span></code>, <code class="docutils literal notranslate"><span class="pre">--verbose</span></code></dt><dd><p>Print verbose output to the screen as well writing to the logfile.
When this option is enabled, most information that would normally be
written to the logfile will also be written to the screen.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-q</span></code>, <code class="docutils literal notranslate"><span class="pre">--quiet</span></code></dt><dd><p>Run quietly (display no output to the screen).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-c</span></code>, <code class="docutils literal notranslate"><span class="pre">--config</span></code></dt><dd><p>Specify the path to an alternate configuration file. The default
configuration file is <code class="docutils literal notranslate"><span class="pre">/etc/cback3.conf</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-f</span></code>, <code class="docutils literal notranslate"><span class="pre">--full</span></code></dt><dd><p>Perform a full backup, regardless of configuration. For the collect
action, this means that any existing information related to
incremental backups will be ignored and rewritten; for the store
action, this means that a new disc will be started.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-M</span></code>, <code class="docutils literal notranslate"><span class="pre">--managed</span></code></dt><dd><p>Include managed clients when executing actions. If the action being
executed is listed as a managed action for a managed client, execute
the action on that client after executing the action locally.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-N</span></code>, <code class="docutils literal notranslate"><span class="pre">--managed-only</span></code></dt><dd><p>Include <em>only</em> managed clients when executing actions. If the action
being executed is listed as a managed action for a managed client,
execute the action on that client — but <em>do not</em> execute the
action locally.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-l</span></code>, <code class="docutils literal notranslate"><span class="pre">--logfile</span></code></dt><dd><p>Specify the path to an alternate logfile. The default logfile file is
<code class="docutils literal notranslate"><span class="pre">/var/log/cback3.log</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-o</span></code>, <code class="docutils literal notranslate"><span class="pre">--owner</span></code></dt><dd><p>Specify the ownership of the logfile, in the form <code class="docutils literal notranslate"><span class="pre">user:group</span></code>. The
default ownership is <code class="docutils literal notranslate"><span class="pre">root:adm</span></code>, to match the Debian standard for
most logfiles. This value will only be used when creating a new
logfile. If the logfile already exists when the <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command is
executed, it will retain its existing ownership and mode. Only user
and group names may be used, not numeric uid and gid values.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-m</span></code>, <code class="docutils literal notranslate"><span class="pre">--mode</span></code></dt><dd><p>Specify the permissions for the logfile, using the numeric mode as in
<code class="docutils literal notranslate"><span class="pre">chmod(1)</span></code>. The default mode is <code class="docutils literal notranslate"><span class="pre">0640</span></code> (<code class="docutils literal notranslate"><span class="pre">-rw-r-----</span></code>). This value
will only be used when creating a new logfile. If the logfile already
exists when the <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command is executed, it will retain its
existing ownership and mode.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-O</span></code>, <code class="docutils literal notranslate"><span class="pre">--output</span></code></dt><dd><p>Record some sub-command output to the logfile. When this option is
enabled, all output from system commands will be logged. This might
be useful for debugging or just for reference.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-d</span></code>, <code class="docutils literal notranslate"><span class="pre">--debug</span></code></dt><dd><p>Write debugging information to the logfile. This option produces a
high volume of output, and would generally only be needed when
debugging a problem. This option implies the <code class="docutils literal notranslate"><span class="pre">--output</span></code> option, as
well.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-s</span></code>, <code class="docutils literal notranslate"><span class="pre">--stack</span></code></dt><dd><p>Dump a Python stack trace instead of swallowing exceptions. This
forces Cedar Backup to dump the entire Python stack trace associated
with an error, rather than just propagating last message it received
back up to the user interface. Under some circumstances, this is
useful information to include along with a bug report.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-D</span></code>, <code class="docutils literal notranslate"><span class="pre">--diagnostics</span></code></dt><dd><p>Display runtime diagnostic information and then exit. This diagnostic
information is often useful when filing a bug report.</p>
</dd>
</dl>
</section>
<section id="actions">
<span id="cedar-commandline-cback3-actions"></span><h3>Actions<a class="headerlink" href="#actions" title="Link to this heading">¶</a></h3>
<p>You can find more information about the various actions in <a class="reference internal" href="basic.html"><span class="doc">Basic Concepts</span></a>. In
general, you may specify any combination of the <em>collect</em>, <em>stage</em>,
<em>store</em> or <em>purge</em> actions, and the specified actions will be executed in a
sensible order. Or, you can specify one of the <em>all</em>, <em>rebuild</em>,
<em>validate</em>, or <em>initialize</em> actions (but these actions may not be combined
with other actions).</p>
<p>If you have configured any Cedar Backup extensions, then the actions
associated with those extensions may also be specified on the command
line. If you specify any other actions along with an extended action,
the actions will be executed in a sensible order per configuration. The
<em>all</em> action never executes extended actions, however.</p>
</section>
</section>
<section id="the-cback3-amazons3-sync-command">
<span id="cedar-commandline-sync"></span><h2>The <code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> command<a class="headerlink" href="#the-cback3-amazons3-sync-command" title="Link to this heading">¶</a></h2>
<section id="cedar-commandline-sync-intro">
<span id="id2"></span><h3>Introduction<a class="headerlink" href="#cedar-commandline-sync-intro" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> tool is used for synchronizing entire
directories of files up to an Amazon S3 cloud storage bucket, outside of
the normal Cedar Backup process.</p>
<p>This might be a good option for some types of data, as long as you
understand the limitations around retrieving previous versions of
objects that get modified or deleted as part of a sync. S3 does support
versioning, but it won’t be quite as easy to get at those previous
versions as with an explicit incremental backup like <code class="docutils literal notranslate"><span class="pre">cback3</span></code>
provides. Cedar Backup does not provide any tooling that would help you
retrieve previous versions.</p>
<p>The underlying functionality relies on the <a class="reference external" href="http://aws.amazon.com/documentation/cli/">AWS CLI</a>
toolset. Before you use this extension, you need to set up your Amazon S3
account and configure AWS CLI as detailed in Amazon’s
<a class="reference external" href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-set-up.html">setup guide</a>.
The <code class="docutils literal notranslate"><span class="pre">aws</span></code> command will be executed as the same user that is executing
the <code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> command, so make sure you configure it as
the proper user. (This is different than the amazons3 extension, which
is designed to execute as root and switches over to the configured
backup user to execute AWS CLI commands.)</p>
</section>
<section id="permissons">
<span id="cedar-commandline-sync-permissions"></span><h3>Permissons<a class="headerlink" href="#permissons" title="Link to this heading">¶</a></h3>
<p>You can use whichever Amazon-supported authentication mechanism you
would like when setting up connectivity for the AWS CLI. It’s best to
set up a separate user in the <a class="reference external" href="https://console.aws.amazon.com/iam/home">IAM Console</a>
rather than using your main administrative user.</p>
<p>You probably want to lock down this user so that it can only take backup
related actions in the AWS infrastructure. One option is to apply the
<code class="docutils literal notranslate"><span class="pre">AmazonS3FullAccess</span></code> policy, which grants full access to the S3
infrastructure. If you would like to lock down the user even further,
this appears to be the minimum set of permissions required for the
<code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span> <span class="pre">sync</span></code> action, written as a JSON policy statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;s3:ListBucket&quot;</span><span class="p">,</span>
                <span class="s2">&quot;s3:PutObject&quot;</span><span class="p">,</span>
                <span class="s2">&quot;s3:PutObjectAcl&quot;</span><span class="p">,</span>
                <span class="s2">&quot;s3:DeleteObject&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:s3:::your-bucket&quot;</span><span class="p">,</span>
                <span class="s2">&quot;arn:aws:s3:::your-bucket/*&quot;</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">Resource</span></code> section, be sure to list the name of your S3 bucket
instead of <code class="docutils literal notranslate"><span class="pre">my-bucket</span></code>.</p>
</section>
<section id="cedar-commandline-sync-syntax">
<span id="id3"></span><h3>Syntax<a class="headerlink" href="#cedar-commandline-sync-syntax" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> command has the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="n">cback3</span><span class="o">-</span><span class="n">amazons3</span><span class="o">-</span><span class="n">sync</span> <span class="p">[</span><span class="n">switches</span><span class="p">]</span> <span class="n">sourceDir</span> <span class="n">s3bucketUrl</span>

<span class="n">Cedar</span> <span class="n">Backup</span> <span class="n">Amazon</span> <span class="n">S3</span> <span class="n">sync</span> <span class="n">tool</span><span class="o">.</span>

<span class="n">This</span> <span class="n">Cedar</span> <span class="n">Backup</span> <span class="n">utility</span> <span class="n">synchronizes</span> <span class="n">a</span> <span class="n">local</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">an</span> <span class="n">Amazon</span> <span class="n">S3</span>
<span class="n">bucket</span><span class="o">.</span>  <span class="n">After</span> <span class="n">the</span> <span class="n">sync</span> <span class="ow">is</span> <span class="n">complete</span><span class="p">,</span> <span class="n">a</span> <span class="n">validation</span> <span class="n">step</span> <span class="ow">is</span> <span class="n">taken</span><span class="o">.</span>  <span class="n">An</span>
<span class="n">error</span> <span class="ow">is</span> <span class="n">reported</span> <span class="k">if</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">bucket</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">match</span> <span class="n">the</span>
<span class="n">source</span> <span class="n">directory</span><span class="p">,</span> <span class="ow">or</span> <span class="k">if</span> <span class="n">the</span> <span class="n">indicated</span> <span class="n">size</span> <span class="k">for</span> <span class="nb">any</span> <span class="n">file</span> <span class="n">differs</span><span class="o">.</span>
<span class="n">This</span> <span class="n">tool</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">wrapper</span> <span class="n">over</span> <span class="n">the</span> <span class="n">AWS</span> <span class="n">CLI</span> <span class="n">command</span><span class="o">-</span><span class="n">line</span> <span class="n">tool</span><span class="o">.</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">arguments</span> <span class="n">are</span> <span class="n">required</span><span class="p">:</span>

  <span class="n">sourceDir</span>            <span class="n">The</span> <span class="n">local</span> <span class="n">source</span> <span class="n">directory</span> <span class="n">on</span> <span class="n">disk</span> <span class="p">(</span><span class="n">must</span> <span class="n">exist</span><span class="p">)</span>
  <span class="n">s3BucketUrl</span>          <span class="n">The</span> <span class="n">URL</span> <span class="n">to</span> <span class="n">the</span> <span class="n">target</span> <span class="n">Amazon</span> <span class="n">S3</span> <span class="n">bucket</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">switches</span> <span class="n">are</span> <span class="n">accepted</span><span class="p">:</span>

  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>           <span class="n">Display</span> <span class="n">this</span> <span class="n">usage</span><span class="o">/</span><span class="n">help</span> <span class="n">listing</span>
  <span class="o">-</span><span class="n">V</span><span class="p">,</span> <span class="o">--</span><span class="n">version</span>        <span class="n">Display</span> <span class="n">version</span> <span class="n">information</span>
  <span class="o">-</span><span class="n">b</span><span class="p">,</span> <span class="o">--</span><span class="n">verbose</span>        <span class="n">Print</span> <span class="n">verbose</span> <span class="n">output</span> <span class="k">as</span> <span class="n">well</span> <span class="k">as</span> <span class="n">logging</span> <span class="n">to</span> <span class="n">disk</span>
  <span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">--</span><span class="n">quiet</span>          <span class="n">Run</span> <span class="n">quietly</span> <span class="p">(</span><span class="n">display</span> <span class="n">no</span> <span class="n">output</span> <span class="n">to</span> <span class="n">the</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">-</span><span class="n">l</span><span class="p">,</span> <span class="o">--</span><span class="n">logfile</span>        <span class="n">Path</span> <span class="n">to</span> <span class="n">logfile</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">cback3</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
  <span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="o">--</span><span class="n">owner</span>          <span class="n">Logfile</span> <span class="n">ownership</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span><span class="n">group</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">root</span><span class="p">:</span><span class="n">adm</span><span class="p">)</span>
  <span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="o">--</span><span class="n">mode</span>           <span class="n">Octal</span> <span class="n">logfile</span> <span class="n">permissions</span> <span class="n">mode</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">640</span><span class="p">)</span>
  <span class="o">-</span><span class="n">O</span><span class="p">,</span> <span class="o">--</span><span class="n">output</span>         <span class="n">Record</span> <span class="n">some</span> <span class="n">sub</span><span class="o">-</span><span class="n">command</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">aws</span><span class="p">)</span> <span class="n">output</span> <span class="n">to</span> <span class="n">the</span> <span class="n">log</span>
  <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">--</span><span class="n">debug</span>          <span class="n">Write</span> <span class="n">debugging</span> <span class="n">information</span> <span class="n">to</span> <span class="n">the</span> <span class="n">log</span> <span class="p">(</span><span class="n">implies</span> <span class="o">--</span><span class="n">output</span><span class="p">)</span>
  <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="o">--</span><span class="n">stack</span>          <span class="n">Dump</span> <span class="n">Python</span> <span class="n">stack</span> <span class="n">trace</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">swallowing</span> <span class="n">exceptions</span>
  <span class="o">-</span><span class="n">D</span><span class="p">,</span> <span class="o">--</span><span class="n">diagnostics</span>    <span class="n">Print</span> <span class="n">runtime</span> <span class="n">diagnostics</span> <span class="n">to</span> <span class="n">the</span> <span class="n">screen</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="o">--</span><span class="n">verifyOnly</span>     <span class="n">Only</span> <span class="n">verify</span> <span class="n">the</span> <span class="n">S3</span> <span class="n">bucket</span> <span class="n">contents</span><span class="p">,</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">make</span> <span class="n">changes</span>
  <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="o">--</span><span class="n">uploadOnly</span>     <span class="n">Only</span> <span class="n">upload</span> <span class="n">new</span> <span class="n">data</span><span class="p">,</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">remove</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">S3</span> <span class="n">bucket</span>
  <span class="o">-</span><span class="n">w</span><span class="p">,</span> <span class="o">--</span><span class="n">ignoreWarnings</span> <span class="n">Ignore</span> <span class="n">warnings</span> <span class="n">about</span> <span class="n">problematic</span> <span class="n">filename</span> <span class="n">encodings</span>

<span class="n">Typical</span> <span class="n">usage</span> <span class="n">would</span> <span class="n">be</span> <span class="n">something</span> <span class="n">like</span><span class="p">:</span>

  <span class="n">cback3</span><span class="o">-</span><span class="n">amazons3</span><span class="o">-</span><span class="n">sync</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myuser</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">-</span><span class="n">backup</span><span class="o">/</span><span class="n">myuser</span>

<span class="n">This</span> <span class="n">will</span> <span class="n">sync</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myuser</span> <span class="n">into</span> <span class="n">the</span> <span class="n">indicated</span> <span class="n">bucket</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="cedar-commandline-sync-options">
<span id="id4"></span><h3>Switches<a class="headerlink" href="#cedar-commandline-sync-options" title="Link to this heading">¶</a></h3>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></dt><dd><p>Display usage/help listing.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-V</span></code>, <code class="docutils literal notranslate"><span class="pre">--version</span></code></dt><dd><p>Display version information.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-b</span></code>, <code class="docutils literal notranslate"><span class="pre">--verbose</span></code></dt><dd><p>Print verbose output to the screen as well writing to the logfile.
When this option is enabled, most information that would normally be
written to the logfile will also be written to the screen.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-q</span></code>, <code class="docutils literal notranslate"><span class="pre">--quiet</span></code></dt><dd><p>Run quietly (display no output to the screen).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-l</span></code>, <code class="docutils literal notranslate"><span class="pre">--logfile</span></code></dt><dd><p>Specify the path to an alternate logfile. The default logfile file is
<code class="docutils literal notranslate"><span class="pre">/var/log/cback3.log</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-o</span></code>, <code class="docutils literal notranslate"><span class="pre">--owner</span></code></dt><dd><p>Specify the ownership of the logfile, in the form <code class="docutils literal notranslate"><span class="pre">user:group</span></code>. The
default ownership is <code class="docutils literal notranslate"><span class="pre">root:adm</span></code>, to match the Debian standard for
most logfiles. This value will only be used when creating a new
logfile. If the logfile already exists when the
<code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> command is executed, it will retain its
existing ownership and mode. Only user and group names may be used,
not numeric uid and gid values.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-m</span></code>, <code class="docutils literal notranslate"><span class="pre">--mode</span></code></dt><dd><p>Specify the permissions for the logfile, using the numeric mode as in
<code class="docutils literal notranslate"><span class="pre">chmod(1)</span></code>. The default mode is <code class="docutils literal notranslate"><span class="pre">0640</span></code> (<code class="docutils literal notranslate"><span class="pre">-rw-r-----</span></code>). This value
will only be used when creating a new logfile. If the logfile already
exists when the <code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> command is executed, it will
retain its existing ownership and mode.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-O</span></code>, <code class="docutils literal notranslate"><span class="pre">--output</span></code></dt><dd><p>Record some sub-command output to the logfile. When this option is
enabled, all output from system commands will be logged. This might
be useful for debugging or just for reference.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-d</span></code>, <code class="docutils literal notranslate"><span class="pre">--debug</span></code></dt><dd><p>Write debugging information to the logfile. This option produces a
high volume of output, and would generally only be needed when
debugging a problem. This option implies the <code class="docutils literal notranslate"><span class="pre">--output</span></code> option, as
well.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-s</span></code>, <code class="docutils literal notranslate"><span class="pre">--stack</span></code></dt><dd><p>Dump a Python stack trace instead of swallowing exceptions. This
forces Cedar Backup to dump the entire Python stack trace associated
with an error, rather than just propagating last message it received
back up to the user interface. Under some circumstances, this is
useful information to include along with a bug report.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-D</span></code>, <code class="docutils literal notranslate"><span class="pre">--diagnostics</span></code></dt><dd><p>Display runtime diagnostic information and then exit. This diagnostic
information is often useful when filing a bug report.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-v</span></code>, <code class="docutils literal notranslate"><span class="pre">--verifyOnly</span></code></dt><dd><p>Only verify the S3 bucket contents against the directory on disk. Do
not make any changes to the S3 bucket or transfer any files. This is
intended as a quick check to see whether the sync is up-to-date.</p>
<p>Although no files are transferred, the tool will still execute the
source filename encoding check, discussed below along with
<code class="docutils literal notranslate"><span class="pre">--ignoreWarnings</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-u</span></code>, <code class="docutils literal notranslate"><span class="pre">--uploadOnly</span></code></dt><dd><p>Implement a partial or “upload only” sync, instead of a full synchronization.
Normally, synchronization would remove files that exist in S3 but do not exist
in the directory on disk.  With this flag, new files are uploaded, but no
files are removed in S3.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-w</span></code>, <code class="docutils literal notranslate"><span class="pre">--ignoreWarnings</span></code></dt><dd><p>The AWS CLI S3 sync process is very picky about filename encoding.
Files that the Linux filesystem handles with no problems can cause
problems in S3 if the filename cannot be encoded properly in your
configured locale. As of this writing, filenames like this will cause
the sync process to abort without transferring all files as expected.</p>
<p>To avoid confusion, the <code class="docutils literal notranslate"><span class="pre">cback3-amazons3-sync</span></code> tries to guess which
files in the source directory will cause problems, and refuses to
execute the AWS CLI S3 sync if any problematic files exist. If you’d
rather proceed anyway, use <code class="docutils literal notranslate"><span class="pre">--ignoreWarnings</span></code>.</p>
<p>If problematic files are found, then you have basically two options:
either correct your locale (i.e. if you have set <code class="docutils literal notranslate"><span class="pre">LANG=C</span></code>) or
rename the file so it can be encoded properly in your locale. The
error messages will tell you the expected encoding (from your locale)
and the actual detected encoding for the filename.</p>
</dd>
</dl>
</section>
</section>
<section id="the-cback3-span-command">
<span id="cedar-commandline-cbackspan"></span><h2>The <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> command<a class="headerlink" href="#the-cback3-span-command" title="Link to this heading">¶</a></h2>
<section id="cedar-commandline-cbackspan-intro">
<span id="id5"></span><h3>Introduction<a class="headerlink" href="#cedar-commandline-cbackspan-intro" title="Link to this heading">¶</a></h3>
<p>Cedar Backup was designed — and is still primarily focused — around weekly
backups. Most users who back up more data than fits on a single disc seem to
either use Amazon S3 or stop their backup process at the stage step, using
Cedar Backup as an easy way to collect data.</p>
<p>However, some users have expressed a need to write these large kinds of
backups to disc — if not every day, then at least occassionally. The
<code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> tool was written to meet those needs. If you have staged
more data than fits on a single CD or DVD, you can use <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code>
to split that data between multiple discs.</p>
<p><code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> is not a general-purpose disc-splitting tool. It is a
specialized program that requires Cedar Backup configuration to run. All
it can do is read Cedar Backup configuration, find any staging
directories that have not yet been written to disc, and split the files
in those directories between discs.</p>
<p><code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> accepts many of the same command-line options as
<code class="docutils literal notranslate"><span class="pre">cback3</span></code>, but <em>must</em> be run interactively. It cannot be run from cron.
This is intentional. It is intended to be a useful tool, not a new part
of the backup process (that is the purpose of an extension).</p>
<p>In order to use <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code>, you must configure your backup such
that the largest individual backup file can fit on a single disc. <em>The
command will not split a single file onto more than one disc.</em> All it
can do is split large directories onto multiple discs. Files in those
directories will be arbitrarily split up so that space is utilized most
efficiently.</p>
</section>
<section id="cedar-commandline-cbackspan-syntax">
<span id="id6"></span><h3>Syntax<a class="headerlink" href="#cedar-commandline-cbackspan-syntax" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> command has the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span> <span class="n">cback3</span><span class="o">-</span><span class="n">span</span> <span class="p">[</span><span class="n">switches</span><span class="p">]</span>

<span class="n">Cedar</span> <span class="n">Backup</span> <span class="s1">&#39;span&#39;</span> <span class="n">tool</span><span class="o">.</span>

<span class="n">This</span> <span class="n">Cedar</span> <span class="n">Backup</span> <span class="n">utility</span> <span class="n">spans</span> <span class="n">staged</span> <span class="n">data</span> <span class="n">between</span> <span class="n">multiple</span> <span class="n">discs</span><span class="o">.</span>
<span class="n">It</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">utility</span><span class="p">,</span> <span class="ow">not</span> <span class="n">an</span> <span class="n">extension</span><span class="p">,</span> <span class="ow">and</span> <span class="n">requires</span> <span class="n">user</span> <span class="n">interaction</span><span class="o">.</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">switches</span> <span class="n">are</span> <span class="n">accepted</span><span class="p">,</span> <span class="n">mostly</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">up</span> <span class="n">underlying</span>
<span class="n">Cedar</span> <span class="n">Backup</span> <span class="n">functionality</span><span class="p">:</span>

  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>     <span class="n">Display</span> <span class="n">this</span> <span class="n">usage</span><span class="o">/</span><span class="n">help</span> <span class="n">listing</span>
  <span class="o">-</span><span class="n">V</span><span class="p">,</span> <span class="o">--</span><span class="n">version</span>  <span class="n">Display</span> <span class="n">version</span> <span class="n">information</span>
  <span class="o">-</span><span class="n">b</span><span class="p">,</span> <span class="o">--</span><span class="n">verbose</span>  <span class="n">Print</span> <span class="n">verbose</span> <span class="n">output</span> <span class="k">as</span> <span class="n">well</span> <span class="k">as</span> <span class="n">logging</span> <span class="n">to</span> <span class="n">disk</span>
  <span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="o">--</span><span class="n">config</span>   <span class="n">Path</span> <span class="n">to</span> <span class="n">config</span> <span class="n">file</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cback3</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span>
  <span class="o">-</span><span class="n">l</span><span class="p">,</span> <span class="o">--</span><span class="n">logfile</span>  <span class="n">Path</span> <span class="n">to</span> <span class="n">logfile</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">cback3</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
  <span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="o">--</span><span class="n">owner</span>    <span class="n">Logfile</span> <span class="n">ownership</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span><span class="n">group</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">root</span><span class="p">:</span><span class="n">adm</span><span class="p">)</span>
  <span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="o">--</span><span class="n">mode</span>     <span class="n">Octal</span> <span class="n">logfile</span> <span class="n">permissions</span> <span class="n">mode</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">640</span><span class="p">)</span>
  <span class="o">-</span><span class="n">O</span><span class="p">,</span> <span class="o">--</span><span class="n">output</span>   <span class="n">Record</span> <span class="n">some</span> <span class="n">sub</span><span class="o">-</span><span class="n">command</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">cdrecord</span><span class="p">)</span> <span class="n">output</span> <span class="n">to</span> <span class="n">the</span> <span class="n">log</span>
  <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">--</span><span class="n">debug</span>    <span class="n">Write</span> <span class="n">debugging</span> <span class="n">information</span> <span class="n">to</span> <span class="n">the</span> <span class="n">log</span> <span class="p">(</span><span class="n">implies</span> <span class="o">--</span><span class="n">output</span><span class="p">)</span>
  <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="o">--</span><span class="n">stack</span>    <span class="n">Dump</span> <span class="n">a</span> <span class="n">Python</span> <span class="n">stack</span> <span class="n">trace</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">swallowing</span> <span class="n">exceptions</span>
</pre></div>
</div>
</section>
<section id="cedar-commandline-cbackspan-options">
<span id="id7"></span><h3>Switches<a class="headerlink" href="#cedar-commandline-cbackspan-options" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></dt><dd><p>Display usage/help listing.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-V</span></code>, <code class="docutils literal notranslate"><span class="pre">--version</span></code></dt><dd><p>Display version information.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-b</span></code>, <code class="docutils literal notranslate"><span class="pre">--verbose</span></code></dt><dd><p>Print verbose output to the screen as well writing to the logfile.
When this option is enabled, most information that would normally be
written to the logfile will also be written to the screen.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-c</span></code>, <code class="docutils literal notranslate"><span class="pre">--config</span></code></dt><dd><p>Specify the path to an alternate configuration file. The default
configuration file is <code class="docutils literal notranslate"><span class="pre">/etc/cback3.conf</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-l</span></code>, <code class="docutils literal notranslate"><span class="pre">--logfile</span></code></dt><dd><p>Specify the path to an alternate logfile. The default logfile file is
<code class="docutils literal notranslate"><span class="pre">/var/log/cback3.log</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-o</span></code>, <code class="docutils literal notranslate"><span class="pre">--owner</span></code></dt><dd><p>Specify the ownership of the logfile, in the form <code class="docutils literal notranslate"><span class="pre">user:group</span></code>. The
default ownership is <code class="docutils literal notranslate"><span class="pre">root:adm</span></code>, to match the Debian standard for
most logfiles. This value will only be used when creating a new
logfile. If the logfile already exists when the <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command is
executed, it will retain its existing ownership and mode. Only user
and group names may be used, not numeric uid and gid values.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-m</span></code>, <code class="docutils literal notranslate"><span class="pre">--mode</span></code></dt><dd><p>Specify the permissions for the logfile, using the numeric mode as in
<code class="docutils literal notranslate"><span class="pre">chmod(1)</span></code>. The default mode is <code class="docutils literal notranslate"><span class="pre">0640</span></code> (<code class="docutils literal notranslate"><span class="pre">-rw-r-----</span></code>). This value
will only be used when creating a new logfile. If the logfile already
exists when the <code class="docutils literal notranslate"><span class="pre">cback3</span></code> command is executed, it will retain its
existing ownership and mode.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-O</span></code>, <code class="docutils literal notranslate"><span class="pre">--output</span></code></dt><dd><p>Record some sub-command output to the logfile. When this option is
enabled, all output from system commands will be logged. This might
be useful for debugging or just for reference. Cedar Backup uses
system commands mostly for dealing with the CD/DVD recorder and its
media.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-d</span></code>, <code class="docutils literal notranslate"><span class="pre">--debug</span></code></dt><dd><p>Write debugging information to the logfile. This option produces a
high volume of output, and would generally only be needed when
debugging a problem. This option implies the <code class="docutils literal notranslate"><span class="pre">--output</span></code> option, as
well.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-s</span></code>, <code class="docutils literal notranslate"><span class="pre">--stack</span></code></dt><dd><p>Dump a Python stack trace instead of swallowing exceptions. This
forces Cedar Backup to dump the entire Python stack trace associated
with an error, rather than just propagating last message it received
back up to the user interface. Under some circumstances, this is
useful information to include along with a bug report.</p>
</dd>
</dl>
</section>
<section id="using-cback3-span">
<span id="cedar-commandline-cbackspan-using"></span><h3>Using <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code><a class="headerlink" href="#using-cback3-span" title="Link to this heading">¶</a></h3>
<p>As discussed above, the <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> is an interactive command. It
cannot be run from cron.</p>
<p>You can typically use the default answer for most questions. The only
two questions that you may not want the default answer for are the fit
algorithm and the cushion percentage.</p>
<p>The cushion percentage is used by <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> to determine what
capacity to shoot for when splitting up your staging directories. A 650
MB disc does not fit fully 650 MB of data. It’s usually more like 627 MB
of data. The cushion percentage tells <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> how much overhead
to reserve for the filesystem. The default of 4% is usually OK, but if
you have problems you may need to increase it slightly.</p>
<p>The fit algorithm tells <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> how it should determine which
items should be placed on each disc. If you don’t like the result from
one algorithm, you can reject that solution and choose a different
algorithm.</p>
<p>The four available fit algorithms are:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">worst</span></code></dt><dd><p>The worst-fit algorithm.</p>
<p>The worst-fit algorithm proceeds through a sorted list of items
(sorted from smallest to largest) until running out of items or
meeting capacity exactly. If capacity is exceeded, the item that
caused capacity to be exceeded is thrown away and the next one is
tried. The algorithm effectively includes the maximum number of items
possible in its search for optimal capacity utilization. It tends to
be somewhat slower than either the best-fit or alternate-fit
algorithm, probably because on average it has to look at more items
before completing.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">best</span></code></dt><dd><p>The best-fit algorithm.</p>
<p>The best-fit algorithm proceeds through a sorted list of items
(sorted from largest to smallest) until running out of items or
meeting capacity exactly. If capacity is exceeded, the item that
caused capacity to be exceeded is thrown away and the next one is
tried. The algorithm effectively includes the minimum number of items
possible in its search for optimal capacity utilization. For large
lists of mixed-size items, it’s not unusual to see the algorithm
achieve 100% capacity utilization by including fewer than 1% of the
items. Probably because it often has to look at fewer of the items
before completing, it tends to be a little faster than the worst-fit
or alternate-fit algorithms.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">first</span></code></dt><dd><p>The first-fit algorithm.</p>
<p>The first-fit algorithm proceeds through an unsorted list of items
until running out of items or meeting capacity exactly. If capacity
is exceeded, the item that caused capacity to be exceeded is thrown
away and the next one is tried. This algorithm generally performs
more poorly than the other algorithms both in terms of capacity
utilization and item utilization, but can be as much as an order of
magnitude faster on large lists of items because it doesn’t require
any sorting.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">alternate</span></code></dt><dd><p>A hybrid algorithm that I call alternate-fit.</p>
<p>This algorithm tries to balance small and large items to achieve
better end-of-disk performance. Instead of just working one direction
through a list, it alternately works from the start and end of a
sorted list (sorted from smallest to largest), throwing away any item
which causes capacity to be exceeded. The algorithm tends to be
slower than the best-fit and first-fit algorithms, and slightly
faster than the worst-fit algorithm, probably because of the number
of items it considers on average before completing. It often achieves
slightly better capacity utilization than the worst-fit algorithm,
while including slightly fewer items.</p>
</dd>
</dl>
</section>
<section id="sample-run">
<span id="cedar-commandline-cbackspan-sample"></span><h3>Sample run<a class="headerlink" href="#sample-run" title="Link to this heading">¶</a></h3>
<p>Below is a log showing a sample <code class="docutils literal notranslate"><span class="pre">cback3-span</span></code> run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>================================================
           Cedar Backup &#39;span&#39; tool
================================================

This the Cedar Backup span tool.  It is used to split up staging
data when that staging data does not fit onto a single disc.

This utility operates using Cedar Backup configuration.  Configuration
specifies which staging directory to look at and which writer device
and media type to use.

Continue? [Y/n]:
===

Cedar Backup store configuration looks like this:

   Source Directory...: /tmp/staging
   Media Type.........: cdrw-74
   Device Type........: cdwriter
   Device Path........: /dev/cdrom
   Device SCSI ID.....: None
   Drive Speed........: None
   Check Data Flag....: True
   No Eject Flag......: False

Is this OK? [Y/n]:
===

Please wait, indexing the source directory (this may take a while)...
===

The following daily staging directories have not yet been written to disc:

   /tmp/staging/2007/02/07
   /tmp/staging/2007/02/08
   /tmp/staging/2007/02/09
   /tmp/staging/2007/02/10
   /tmp/staging/2007/02/11
   /tmp/staging/2007/02/12
   /tmp/staging/2007/02/13
   /tmp/staging/2007/02/14

The total size of the data in these directories is 1.00 GB.

Continue? [Y/n]:
===

Based on configuration, the capacity of your media is 650.00 MB.

Since estimates are not perfect and there is some uncertainly in
media capacity calculations, it is good to have a &quot;cushion&quot;,
a percentage of capacity to set aside.  The cushion reduces the
capacity of your media, so a 1.5% cushion leaves 98.5% remaining.

What cushion percentage? [4.00]:
===

The real capacity, taking into account the 4.00% cushion, is 627.25 MB.
It will take at least 2 disc(s) to store your 1.00 GB of data.

Continue? [Y/n]:
===

Which algorithm do you want to use to span your data across
multiple discs?

The following algorithms are available:

   first....: The &quot;first-fit&quot; algorithm
   best.....: The &quot;best-fit&quot; algorithm
   worst....: The &quot;worst-fit&quot; algorithm
   alternate: The &quot;alternate-fit&quot; algorithm

If you don&#39;t like the results you will have a chance to try a
different one later.

Which algorithm? [worst]:
===

Please wait, generating file lists (this may take a while)...
===

Using the &quot;worst-fit&quot; algorithm, Cedar Backup can split your data
into 2 discs.

Disc 1: 246 files, 615.97 MB, 98.20% utilization
Disc 2: 8 files, 412.96 MB, 65.84% utilization

Accept this solution? [Y/n]: n
===

Which algorithm do you want to use to span your data across
multiple discs?

The following algorithms are available:

   first....: The &quot;first-fit&quot; algorithm
   best.....: The &quot;best-fit&quot; algorithm
   worst....: The &quot;worst-fit&quot; algorithm
   alternate: The &quot;alternate-fit&quot; algorithm

If you don&#39;t like the results you will have a chance to try a
different one later.

Which algorithm? [worst]: alternate
===

Please wait, generating file lists (this may take a while)...
===

Using the &quot;alternate-fit&quot; algorithm, Cedar Backup can split your data
into 2 discs.

Disc 1: 73 files, 627.25 MB, 100.00% utilization
Disc 2: 181 files, 401.68 MB, 64.04% utilization

Accept this solution? [Y/n]: y
===

Please place the first disc in your backup device.
Press return when ready.
===

Initializing image...
Writing image to disc...
</pre></div>
</div>
<hr class="docutils" />
<p><em>Previous</em>: <a class="reference internal" href="install.html"><span class="doc">Installation</span></a> • <em>Next</em>: <a class="reference internal" href="config.html"><span class="doc">Configuration</span></a></p>
<hr class="docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Some users find this surprising, because extensions are configured
with sequence numbers. I did it this way because I felt that running
extensions as part of the all action would sometimes result in
“surprising” behavior. Better to be definitive than confusing.</p>
</aside>
</aside>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">cedar-backup3</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=pronovic&repo=cedar-backup3&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;(c) Kenneth J. Pronovici.
      
    </div>

    
    <a href="https://github.com/pronovic/cedar-backup3" class="github">
        <img src="../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>
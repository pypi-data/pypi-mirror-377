
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Conductor Developers">
      
      
      
        <link rel="prev" href="../apidoc/">
      
      
        <link rel="next" href="../config/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.32">
    
    
      
        <title>ciocore.api_client - Conductor Core</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Raleway";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/tables.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ciocoreapi_client" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://www.conductortech.com" title="Conductor Core" class="md-header__button md-logo" aria-label="Conductor Core" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Conductor Core
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ciocore.api_client
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cmdline/uploader/" class="md-tabs__link">
          
  
  CLI

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../apidoc/" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../how-to-guides/" class="md-tabs__link">
        
  
    
  
  How to

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://www.conductortech.com" title="Conductor Core" class="md-nav__button md-logo" aria-label="Conductor Core" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    Conductor Core
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CLI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            CLI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cmdline/uploader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uploader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cmdline/downloader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Downloader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cmdline/packages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Packages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cmdline/docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apidoc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Api Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ciocore.api_client
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ciocore.api_client
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client" class="md-nav__link">
    <span class="md-ellipsis">
      ciocore.api_client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient" class="md-nav__link">
    <span class="md-ellipsis">
      ApiClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ApiClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient.make_prepared_request" class="md-nav__link">
    <span class="md-ellipsis">
      make_prepared_request()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient.make_request" class="md-nav__link">
    <span class="md-ellipsis">
      make_request()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient.register_client" class="md-nav__link">
    <span class="md-ellipsis">
      register_client()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.truncate_middle" class="md-nav__link">
    <span class="md-ellipsis">
      truncate_middle()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.read_conductor_credentials" class="md-nav__link">
    <span class="md-ellipsis">
      read_conductor_credentials()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_api_key_bearer_token" class="md-nav__link">
    <span class="md-ellipsis">
      get_api_key_bearer_token()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_creds_path" class="md-nav__link">
    <span class="md-ellipsis">
      get_creds_path()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_bearer_token" class="md-nav__link">
    <span class="md-ellipsis">
      get_bearer_token()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.creds_same_domain" class="md-nav__link">
    <span class="md-ellipsis">
      creds_same_domain()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.account_id_from_jwt" class="md-nav__link">
    <span class="md-ellipsis">
      account_id_from_jwt()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.account_name_from_jwt" class="md-nav__link">
    <span class="md-ellipsis">
      account_name_from_jwt()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_instance_types" class="md-nav__link">
    <span class="md-ellipsis">
      request_instance_types()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_projects" class="md-nav__link">
    <span class="md-ellipsis">
      request_projects()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_software_packages" class="md-nav__link">
    <span class="md-ellipsis">
      request_software_packages()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_extra_environment" class="md-nav__link">
    <span class="md-ellipsis">
      request_extra_environment()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_jobs" class="md-nav__link">
    <span class="md-ellipsis">
      get_jobs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_log" class="md-nav__link">
    <span class="md-ellipsis">
      get_log()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.kill_jobs" class="md-nav__link">
    <span class="md-ellipsis">
      kill_jobs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.kill_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      kill_tasks()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_compute_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_compute_usage()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_storage_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_storage_usage()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ciocore.config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ciocore.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hardware_set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ciocore.hardware_set
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../package_tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ciocore.package_tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../package_environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ciocore.package_environment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client" class="md-nav__link">
    <span class="md-ellipsis">
      ciocore.api_client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient" class="md-nav__link">
    <span class="md-ellipsis">
      ApiClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ApiClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient.make_prepared_request" class="md-nav__link">
    <span class="md-ellipsis">
      make_prepared_request()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient.make_request" class="md-nav__link">
    <span class="md-ellipsis">
      make_request()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ciocore.api_client.ApiClient.register_client" class="md-nav__link">
    <span class="md-ellipsis">
      register_client()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.truncate_middle" class="md-nav__link">
    <span class="md-ellipsis">
      truncate_middle()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.read_conductor_credentials" class="md-nav__link">
    <span class="md-ellipsis">
      read_conductor_credentials()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_api_key_bearer_token" class="md-nav__link">
    <span class="md-ellipsis">
      get_api_key_bearer_token()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_creds_path" class="md-nav__link">
    <span class="md-ellipsis">
      get_creds_path()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_bearer_token" class="md-nav__link">
    <span class="md-ellipsis">
      get_bearer_token()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.creds_same_domain" class="md-nav__link">
    <span class="md-ellipsis">
      creds_same_domain()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.account_id_from_jwt" class="md-nav__link">
    <span class="md-ellipsis">
      account_id_from_jwt()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.account_name_from_jwt" class="md-nav__link">
    <span class="md-ellipsis">
      account_name_from_jwt()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_instance_types" class="md-nav__link">
    <span class="md-ellipsis">
      request_instance_types()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_projects" class="md-nav__link">
    <span class="md-ellipsis">
      request_projects()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_software_packages" class="md-nav__link">
    <span class="md-ellipsis">
      request_software_packages()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.request_extra_environment" class="md-nav__link">
    <span class="md-ellipsis">
      request_extra_environment()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_jobs" class="md-nav__link">
    <span class="md-ellipsis">
      get_jobs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_log" class="md-nav__link">
    <span class="md-ellipsis">
      get_log()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.kill_jobs" class="md-nav__link">
    <span class="md-ellipsis">
      kill_jobs()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.kill_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      kill_tasks()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_compute_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_compute_usage()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ciocore.api_client.get_storage_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_storage_usage()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ciocoreapi_client">ciocore.api_client</h1>


  <div class="doc doc-object doc-module">

<a id="ciocore.api_client"></a>
    <div class="doc doc-contents first">

      <p>The api_client module is used to make requests to the Conductor API.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h2 id="ciocore.api_client.ApiClient" class="doc doc-heading">
        <code>
ApiClient        </code>



</h2>

    <div class="doc doc-contents ">

      <p>The ApiClient class is a wrapper around the requests library that handles authentication and retries.</p>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ApiClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ApiClient class is a wrapper around the requests library that handles authentication and retries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">http_verbs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PUT&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;PATCH&quot;</span><span class="p">]</span>

    <span class="n">USER_AGENT_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;client </span><span class="si">{client_name}</span><span class="s2">/</span><span class="si">{client_version}</span><span class="s2"> (ciocore </span><span class="si">{ciocore_version}</span><span class="s2">; </span><span class="si">{runtime}</span><span class="s2"> </span><span class="si">{runtime_version}</span><span class="s2">; </span><span class="si">{platform}</span><span class="s2"> </span><span class="si">{platform_details}</span><span class="s2">; </span><span class="si">{hostname}</span><span class="s2"> </span><span class="si">{pid}</span><span class="s2">; </span><span class="si">{python_path}</span><span class="s2">)&quot;</span>
    <span class="n">USER_AGENT_MAX_PATH_LENGTH</span> <span class="o">=</span> <span class="mi">1024</span>

    <span class="n">user_agent_header</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verb</span><span class="p">,</span> <span class="n">conductor_url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
            <span class="n">method</span><span class="o">=</span><span class="n">verb</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">conductor_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;verb: </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;conductor_url: </span><span class="si">{</span><span class="n">conductor_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;headers: </span><span class="si">{</span><span class="n">headers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;params: </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># If we get 300s/400s debug out the response. TODO(lws): REMOVE THIS</span>
        <span class="k">if</span> <span class="mi">300</span> <span class="o">&lt;=</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;*****  ERROR!!  *****&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reason: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Text: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># trigger an exception to be raised for 4XX or 5XX http responses</span>
        <span class="k">if</span> <span class="n">raise_on_error</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_prepared_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">verb</span><span class="p">,</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove_headers_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a request to the Conductor API.</span>

<span class="sd">        Deprecated:</span>
<span class="sd">            Primarily used to removed enforced headers by requests.Request. Requests 2.x will add</span>
<span class="sd">            Transfer-Encoding: chunked with file like object that is 0 bytes, causing s3 failures (501)</span>
<span class="sd">            - https://github.com/psf/requests/issues/4215#issuecomment-319521235</span>

<span class="sd">            To get around this bug make_prepared_request has functionality to remove the enforced header</span>
<span class="sd">            that would occur when using requests.request(...). Requests 3.x resolves this issue, when</span>
<span class="sd">            client is built to use Requests 3.x this function can be removed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: The response object.</span>

<span class="sd">        Args:</span>
<span class="sd">            verb (str): The HTTP verb to use.</span>
<span class="sd">            url (str): The URL to make the request to.</span>
<span class="sd">            headers (dict): A dictionary of headers to send with the request.</span>
<span class="sd">            params (dict): A dictionary of query parameters to send with the request.</span>
<span class="sd">            json (dict): A JSON payload to send with the request.</span>
<span class="sd">            stream (bool): Whether or not to stream the response.</span>
<span class="sd">            remove_headers_list (list): A list of headers to remove from the request.</span>
<span class="sd">            raise_on_error (bool): Whether or not to raise an exception if the request fails.</span>
<span class="sd">            tries (int): The number of times to retry the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span>
            <span class="n">method</span><span class="o">=</span><span class="n">verb</span><span class="p">,</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="n">json_payload</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">prepped</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">remove_headers_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">remove_headers_list</span><span class="p">:</span>
                <span class="n">prepped</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Create a retry wrapper function</span>
        <span class="n">retry_wrapper</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">DecRetry</span><span class="p">(</span>
            <span class="n">retry_exceptions</span><span class="o">=</span><span class="n">CONNECTION_EXCEPTIONS</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="n">tries</span>
        <span class="p">)</span>

        <span class="c1"># requests sessions potentially not thread-safe, but need to removed enforced</span>
        <span class="c1"># headers by using a prepared request.create which can only be done through an</span>
        <span class="c1"># request.Session object. Create Session object per call of make_prepared_request, it will</span>
        <span class="c1"># not benefit from connection pooling reuse. https://github.com/psf/requests/issues/1871</span>
        <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

        <span class="c1"># wrap the request function with the retry wrapper</span>
        <span class="n">wrapped_func</span> <span class="o">=</span> <span class="n">retry_wrapper</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">send</span><span class="p">)</span>

        <span class="c1"># call the wrapped request function</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">wrapped_func</span><span class="p">(</span><span class="n">prepped</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;verb: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prepped</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;url: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prepped</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;headers: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prepped</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;params: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

        <span class="c1"># trigger an exception to be raised for 4XX or 5XX http responses</span>
        <span class="k">if</span> <span class="n">raise_on_error</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">verb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">conductor_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">use_api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a request to the Conductor API.</span>

<span class="sd">        Args:</span>
<span class="sd">            uri_path (str): The path to the resource to request.</span>
<span class="sd">            headers (dict): A dictionary of headers to send with the request.</span>
<span class="sd">            params (dict): A dictionary of query parameters to send with the request.</span>
<span class="sd">            data (dict): A dictionary of data to send with the request.</span>
<span class="sd">            verb (str): The HTTP verb to use.</span>
<span class="sd">            conductor_url (str): The Conductor URL.</span>
<span class="sd">            raise_on_error (bool): Whether or not to raise an exception if the request fails.</span>
<span class="sd">            tries (int): The number of times to retry the request.</span>
<span class="sd">            use`_api_key (bool): Whether or not to use the API key for authentication.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple(str, int): The response text and status code.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="c1"># TODO: set Content Content-Type to json if data arg</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">headers</span><span class="p">:</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span> <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">}</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;read_conductor_credentials(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">use_api_key</span><span class="p">))</span>
        <span class="n">bearer_token</span> <span class="o">=</span> <span class="n">read_conductor_credentials</span><span class="p">(</span><span class="n">use_api_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bearer_token</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error: Could not get conductor credentials!&quot;</span><span class="p">)</span>

        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bearer </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">bearer_token</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ApiClient</span><span class="o">.</span><span class="n">user_agent_header</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_client</span><span class="p">(</span><span class="s2">&quot;ciocore&quot;</span><span class="p">)</span>

        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="o">.</span><span class="n">user_agent_header</span>

        <span class="c1"># Construct URL</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">conductor_url</span><span class="p">:</span>
            <span class="n">conductor_url</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">],</span> <span class="n">uri_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">verb</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">verb</span> <span class="o">=</span> <span class="s2">&quot;POST&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">verb</span> <span class="o">=</span> <span class="s2">&quot;GET&quot;</span>

        <span class="k">assert</span> <span class="n">verb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_verbs</span><span class="p">,</span> <span class="s2">&quot;Invalid http verb: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">verb</span>

        <span class="c1"># Create a retry wrapper function</span>
        <span class="n">retry_wrapper</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">DecRetry</span><span class="p">(</span>
            <span class="n">retry_exceptions</span><span class="o">=</span><span class="n">CONNECTION_EXCEPTIONS</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="n">tries</span>
        <span class="p">)</span>

        <span class="c1"># wrap the request function with the retry wrapper</span>
        <span class="n">wrapped_func</span> <span class="o">=</span> <span class="n">retry_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_make_request</span><span class="p">)</span>

        <span class="c1"># call the wrapped request function</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">wrapped_func</span><span class="p">(</span>
            <span class="n">verb</span><span class="p">,</span> <span class="n">conductor_url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="n">raise_on_error</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_client</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">client_version</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the http User Agent header that includes helpful debug info.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Use the provided client_version.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">client_version</span><span class="p">:</span>
            <span class="n">client_version</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>

        <span class="n">python_version</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">()</span>
        <span class="n">system_info</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
        <span class="n">release_info</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>


        <span class="c1"># Get the MD5 hex digest of the path to the python executable</span>
        <span class="n">python_executable_path</span> <span class="o">=</span> <span class="n">truncate_middle</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="bp">cls</span><span class="o">.</span><span class="n">USER_AGENT_MAX_PATH_LENGTH</span><span class="p">)</span>
        <span class="n">md5_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">python_executable_path</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="n">user_agent</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">client_version</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(python </span><span class="si">{</span><span class="n">python_version</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">system_info</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">release_info</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">md5_hash</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">user_agent_header</span> <span class="o">=</span> <span class="n">user_agent</span>

        <span class="k">return</span> <span class="n">user_agent</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h3 id="ciocore.api_client.ApiClient.make_prepared_request" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_prepared_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verb</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">json_payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_headers_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Make a request to the Conductor API.</p>
<div class="admonition deprecated">
<p class="admonition-title">Deprecated</p>
<p>Primarily used to removed enforced headers by requests.Request. Requests 2.x will add
Transfer-Encoding: chunked with file like object that is 0 bytes, causing s3 failures (501)
- https://github.com/psf/requests/issues/4215#issuecomment-319521235</p>
<p>To get around this bug make_prepared_request has functionality to remove the enforced header
that would occur when using requests.request(...). Requests 3.x resolves this issue, when
client is built to use Requests 3.x this function can be removed.</p>
</div>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>requests.Response</code></td>
      <td><p>The response object.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>verb</code></td>
        <td><code>str</code></td>
        <td><p>The HTTP verb to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The URL to make the request to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>headers</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of headers to send with the request.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of query parameters to send with the request.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>json</code></td>
        <td><code>dict</code></td>
        <td><p>A JSON payload to send with the request.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stream</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to stream the response.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remove_headers_list</code></td>
        <td><code>list</code></td>
        <td><p>A list of headers to remove from the request.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>raise_on_error</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to raise an exception if the request fails.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>tries</code></td>
        <td><code>int</code></td>
        <td><p>The number of times to retry the request.</p></td>
        <td><code>5</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_prepared_request</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">verb</span><span class="p">,</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">json_payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_headers_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a request to the Conductor API.</span>

<span class="sd">    Deprecated:</span>
<span class="sd">        Primarily used to removed enforced headers by requests.Request. Requests 2.x will add</span>
<span class="sd">        Transfer-Encoding: chunked with file like object that is 0 bytes, causing s3 failures (501)</span>
<span class="sd">        - https://github.com/psf/requests/issues/4215#issuecomment-319521235</span>

<span class="sd">        To get around this bug make_prepared_request has functionality to remove the enforced header</span>
<span class="sd">        that would occur when using requests.request(...). Requests 3.x resolves this issue, when</span>
<span class="sd">        client is built to use Requests 3.x this function can be removed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        requests.Response: The response object.</span>

<span class="sd">    Args:</span>
<span class="sd">        verb (str): The HTTP verb to use.</span>
<span class="sd">        url (str): The URL to make the request to.</span>
<span class="sd">        headers (dict): A dictionary of headers to send with the request.</span>
<span class="sd">        params (dict): A dictionary of query parameters to send with the request.</span>
<span class="sd">        json (dict): A JSON payload to send with the request.</span>
<span class="sd">        stream (bool): Whether or not to stream the response.</span>
<span class="sd">        remove_headers_list (list): A list of headers to remove from the request.</span>
<span class="sd">        raise_on_error (bool): Whether or not to raise an exception if the request fails.</span>
<span class="sd">        tries (int): The number of times to retry the request.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="n">verb</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="n">json_payload</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">prepped</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">remove_headers_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">remove_headers_list</span><span class="p">:</span>
            <span class="n">prepped</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Create a retry wrapper function</span>
    <span class="n">retry_wrapper</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">DecRetry</span><span class="p">(</span>
        <span class="n">retry_exceptions</span><span class="o">=</span><span class="n">CONNECTION_EXCEPTIONS</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="n">tries</span>
    <span class="p">)</span>

    <span class="c1"># requests sessions potentially not thread-safe, but need to removed enforced</span>
    <span class="c1"># headers by using a prepared request.create which can only be done through an</span>
    <span class="c1"># request.Session object. Create Session object per call of make_prepared_request, it will</span>
    <span class="c1"># not benefit from connection pooling reuse. https://github.com/psf/requests/issues/1871</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

    <span class="c1"># wrap the request function with the retry wrapper</span>
    <span class="n">wrapped_func</span> <span class="o">=</span> <span class="n">retry_wrapper</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">send</span><span class="p">)</span>

    <span class="c1"># call the wrapped request function</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">wrapped_func</span><span class="p">(</span><span class="n">prepped</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;verb: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prepped</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;url: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prepped</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;headers: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prepped</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;params: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="c1"># trigger an exception to be raised for 4XX or 5XX http responses</span>
    <span class="k">if</span> <span class="n">raise_on_error</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="ciocore.api_client.ApiClient.make_request" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri_path</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conductor_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">use_api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Make a request to the Conductor API.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>uri_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the resource to request.</p></td>
        <td><code>&#39;/&#39;</code></td>
      </tr>
      <tr>
        <td><code>headers</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of headers to send with the request.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of query parameters to send with the request.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>dict</code></td>
        <td><p>A dictionary of data to send with the request.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>verb</code></td>
        <td><code>str</code></td>
        <td><p>The HTTP verb to use.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>conductor_url</code></td>
        <td><code>str</code></td>
        <td><p>The Conductor URL.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>raise_on_error</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to raise an exception if the request fails.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>tries</code></td>
        <td><code>int</code></td>
        <td><p>The number of times to retry the request.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>use`_api_key</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to use the API key for authentication.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple(str, int)</code></td>
      <td><p>The response text and status code.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_request</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">uri_path</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">verb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">conductor_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">use_api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a request to the Conductor API.</span>

<span class="sd">    Args:</span>
<span class="sd">        uri_path (str): The path to the resource to request.</span>
<span class="sd">        headers (dict): A dictionary of headers to send with the request.</span>
<span class="sd">        params (dict): A dictionary of query parameters to send with the request.</span>
<span class="sd">        data (dict): A dictionary of data to send with the request.</span>
<span class="sd">        verb (str): The HTTP verb to use.</span>
<span class="sd">        conductor_url (str): The Conductor URL.</span>
<span class="sd">        raise_on_error (bool): Whether or not to raise an exception if the request fails.</span>
<span class="sd">        tries (int): The number of times to retry the request.</span>
<span class="sd">        use`_api_key (bool): Whether or not to use the API key for authentication.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple(str, int): The response text and status code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="c1"># TODO: set Content Content-Type to json if data arg</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">headers</span><span class="p">:</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span> <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">}</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;read_conductor_credentials(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">use_api_key</span><span class="p">))</span>
    <span class="n">bearer_token</span> <span class="o">=</span> <span class="n">read_conductor_credentials</span><span class="p">(</span><span class="n">use_api_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">bearer_token</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error: Could not get conductor credentials!&quot;</span><span class="p">)</span>

    <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bearer </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">bearer_token</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ApiClient</span><span class="o">.</span><span class="n">user_agent_header</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_client</span><span class="p">(</span><span class="s2">&quot;ciocore&quot;</span><span class="p">)</span>

    <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="o">.</span><span class="n">user_agent_header</span>

    <span class="c1"># Construct URL</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">conductor_url</span><span class="p">:</span>
        <span class="n">conductor_url</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">],</span> <span class="n">uri_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">verb</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">verb</span> <span class="o">=</span> <span class="s2">&quot;POST&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">verb</span> <span class="o">=</span> <span class="s2">&quot;GET&quot;</span>

    <span class="k">assert</span> <span class="n">verb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">http_verbs</span><span class="p">,</span> <span class="s2">&quot;Invalid http verb: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">verb</span>

    <span class="c1"># Create a retry wrapper function</span>
    <span class="n">retry_wrapper</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">DecRetry</span><span class="p">(</span>
        <span class="n">retry_exceptions</span><span class="o">=</span><span class="n">CONNECTION_EXCEPTIONS</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="n">tries</span>
    <span class="p">)</span>

    <span class="c1"># wrap the request function with the retry wrapper</span>
    <span class="n">wrapped_func</span> <span class="o">=</span> <span class="n">retry_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_make_request</span><span class="p">)</span>

    <span class="c1"># call the wrapped request function</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">wrapped_func</span><span class="p">(</span>
        <span class="n">verb</span><span class="p">,</span> <span class="n">conductor_url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="n">raise_on_error</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="ciocore.api_client.ApiClient.register_client" class="doc doc-heading">
<code class="highlight language-python"><span class="n">register_client</span><span class="p">(</span><span class="n">client_name</span><span class="p">,</span> <span class="n">client_version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Generates the http User Agent header that includes helpful debug info.</p>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_client</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">client_version</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the http User Agent header that includes helpful debug info.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Use the provided client_version.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">client_version</span><span class="p">:</span>
        <span class="n">client_version</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>

    <span class="n">python_version</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">python_version</span><span class="p">()</span>
    <span class="n">system_info</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
    <span class="n">release_info</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>


    <span class="c1"># Get the MD5 hex digest of the path to the python executable</span>
    <span class="n">python_executable_path</span> <span class="o">=</span> <span class="n">truncate_middle</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="bp">cls</span><span class="o">.</span><span class="n">USER_AGENT_MAX_PATH_LENGTH</span><span class="p">)</span>
    <span class="n">md5_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">python_executable_path</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="n">user_agent</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">client_version</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(python </span><span class="si">{</span><span class="n">python_version</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">system_info</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">release_info</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">md5_hash</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">user_agent_header</span> <span class="o">=</span> <span class="n">user_agent</span>

    <span class="k">return</span> <span class="n">user_agent</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.truncate_middle" class="doc doc-heading">
<code class="highlight language-python"><span class="n">truncate_middle</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">max_length</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Truncate the string <code>s</code> to <code>max_length</code> by removing characters from the middle.</p>
<p>:param s: The original string to be truncated.
:type s: str
:param max_length: The maximum allowed length of the string after truncation.
:type max_length: int
:return: The truncated string.
:rtype: str</p>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">truncate_middle</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">max_length</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Truncate the string `s` to `max_length` by removing characters from the middle.</span>

<span class="sd">    :param s: The original string to be truncated.</span>
<span class="sd">    :type s: str</span>
<span class="sd">    :param max_length: The maximum allowed length of the string after truncation.</span>
<span class="sd">    :type max_length: int</span>
<span class="sd">    :return: The truncated string.</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
        <span class="c1"># String is already at or below the maximum length, return it as is</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="c1"># Calculate the number of characters to keep from the start and end of the string</span>
    <span class="n">num_keep_front</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_length</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">num_keep_end</span> <span class="o">=</span> <span class="n">max_length</span> <span class="o">-</span> <span class="n">num_keep_front</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># -1 for the ellipsis</span>

    <span class="c1"># Construct the truncated string</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="n">num_keep_front</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;~&#39;</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="n">num_keep_end</span><span class="p">:]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.read_conductor_credentials" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_conductor_credentials</span><span class="p">(</span><span class="n">use_api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Read the conductor credentials file.</p>
<p>If the credentials file exists, it will contain a bearer token from either
the user or the API key.</p>
<p>If the credentials file doesn't exist, or is
expired, or is from a different domain, we try to fetch a new one in the API key scenario or
prompt the user to log in. </p>
<p>Args: 
    use_api_key (bool): Whether or not to try to use the API key</p>
<p>Returns: 
    A Bearer token in the event of a success or None</p>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read_conductor_credentials</span><span class="p">(</span><span class="n">use_api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read the conductor credentials file.</span>

<span class="sd">    If the credentials file exists, it will contain a bearer token from either</span>
<span class="sd">    the user or the API key.</span>

<span class="sd">    If the credentials file doesn&#39;t exist, or is</span>
<span class="sd">    expired, or is from a different domain, we try to fetch a new one in the API key scenario or</span>
<span class="sd">    prompt the user to log in. </span>

<span class="sd">    Args: </span>
<span class="sd">        use_api_key (bool): Whether or not to try to use the API key</span>

<span class="sd">    Returns: </span>
<span class="sd">        A Bearer token in the event of a success or None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cfg</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Reading conductor credentials...&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">use_api_key</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;api_key&quot;</span><span class="p">):</span>
            <span class="n">use_api_key</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">use_api_key</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;api_key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">):</span>
            <span class="n">use_api_key</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;use_api_key = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">use_api_key</span><span class="p">)</span>
    <span class="n">creds_file</span> <span class="o">=</span> <span class="n">get_creds_path</span><span class="p">(</span><span class="n">use_api_key</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creds file is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">creds_file</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Auth url is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">creds_file</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">use_api_key</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;api_key&quot;</span><span class="p">]:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Attempted to use API key, but no api key in in config!&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="c1">#  Exchange the API key for a bearer token</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Attempting to get API key bearer token&quot;</span><span class="p">)</span>
            <span class="n">get_api_key_bearer_token</span><span class="p">(</span><span class="n">creds_file</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">auth</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">creds_file</span><span class="p">,</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">creds_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Reading credentials file...&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">creds_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">file_contents</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">expiration</span> <span class="o">=</span> <span class="n">file_contents</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;expiration&quot;</span><span class="p">)</span>
    <span class="n">same_domain</span> <span class="o">=</span> <span class="n">creds_same_domain</span><span class="p">(</span><span class="n">file_contents</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">same_domain</span> <span class="ow">and</span> <span class="n">expiration</span> <span class="ow">and</span> <span class="n">expiration</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()):</span>
        <span class="k">return</span> <span class="n">file_contents</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Credentials have expired or are from a different domain&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">use_api_key</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Refreshing API key bearer token!&quot;</span><span class="p">)</span>
        <span class="n">get_api_key_bearer_token</span><span class="p">(</span><span class="n">creds_file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Sending to auth page...&quot;</span><span class="p">)</span>
        <span class="n">auth</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">creds_file</span><span class="p">,</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span>
    <span class="c1">#  Re-read the creds file, since it has been re-upped</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">creds_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">file_contents</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">file_contents</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.get_api_key_bearer_token" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_api_key_bearer_token</span><span class="p">(</span><span class="n">creds_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Get a bearer token from the API key.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>creds_file</code></td>
        <td><code>str</code></td>
        <td><p>The path to the credentials file. If not provided, the bearer token will not be written to disk.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>A dictionary containing the bearer token and other information.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_api_key_bearer_token</span><span class="p">(</span><span class="n">creds_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a bearer token from the API key.</span>

<span class="sd">    Args:</span>
<span class="sd">        creds_file (str): The path to the credentials file. If not provided, the bearer token will not be written to disk.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary containing the bearer token and other information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/api/oauth_jwt&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;client_credentials&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="s2">&quot;owner admin user&quot;</span><span class="p">,</span>
            <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;api_key&quot;</span><span class="p">][</span><span class="s2">&quot;client_id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;api_key&quot;</span><span class="p">][</span><span class="s2">&quot;private_key&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">response_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">credentials_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="n">response_dict</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">],</span>
            <span class="s2">&quot;token_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;expiration&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">response_dict</span><span class="p">[</span><span class="s2">&quot;expires_in&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="s2">&quot;user admin owner&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">creds_file</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">credentials_dict</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">creds_file</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">creds_file</span><span class="p">))</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">creds_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">credentials_dict</span><span class="p">))</span>
    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.get_creds_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_creds_path</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Get the path to the credentials file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>api_key</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to use the API key.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The path to the credentials file.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_creds_path</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the path to the credentials file.</span>

<span class="sd">    Args:</span>
<span class="sd">        api_key (bool): Whether or not to use the API key.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the credentials file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">creds_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;.config&quot;</span><span class="p">,</span> <span class="s2">&quot;conductor&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_key</span><span class="p">:</span>
        <span class="n">creds_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">creds_dir</span><span class="p">,</span> <span class="s2">&quot;api_key_credentials&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">creds_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">creds_dir</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">creds_file</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.get_bearer_token" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_bearer_token</span><span class="p">(</span><span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Return the bearer token.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>refresh</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to refresh the token.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>      

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_bearer_token</span><span class="p">(</span><span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the bearer token.</span>

<span class="sd">    Args:</span>
<span class="sd">        refresh (bool): Whether or not to refresh the token.</span>

<span class="sd">    TODO: Thread safe multiproc caching, like it used to be pre-python3.7.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">read_conductor_credentials</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.creds_same_domain" class="doc doc-heading">
<code class="highlight language-python"><span class="n">creds_same_domain</span><span class="p">(</span><span class="n">creds</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Check if the creds are for the same domain as the config.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>creds</code></td>
        <td><code>dict</code></td>
        <td><p>The credentials dictionary.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether or not the creds are for the same domain as the config.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">creds_same_domain</span><span class="p">(</span><span class="n">creds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the creds are for the same domain as the config.</span>

<span class="sd">    Args:</span>
<span class="sd">        creds (dict): The credentials dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: Whether or not the creds are for the same domain as the config.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ensure the creds file refers to the domain in config&quot;&quot;&quot;</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">creds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;access_token&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">decoded</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">creds</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">],</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HS256&quot;</span><span class="p">],</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;verify_signature&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
    <span class="n">audience_domain</span> <span class="o">=</span> <span class="n">decoded</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aud&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">audience_domain</span>
        <span class="ow">and</span> <span class="n">audience_domain</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;api_url&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.account_id_from_jwt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">account_id_from_jwt</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Fetch the accounts id from a jwt token value.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>token</code></td>
        <td><code>str</code></td>
        <td><p>The jwt token.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The account id.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">account_id_from_jwt</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch the accounts id from a jwt token value.</span>

<span class="sd">    Args:</span>
<span class="sd">        token (str): The jwt token.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The account id.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HS256&quot;</span><span class="p">],</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;verify_signature&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;account&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.account_name_from_jwt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">account_name_from_jwt</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Fetch the accounts name from a jwt token value.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>token</code></td>
        <td><code>str</code></td>
        <td><p>The jwt token.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The account name.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">account_name_from_jwt</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch the accounts name from a jwt token value.</span>

<span class="sd">    Args:</span>
<span class="sd">        token (str): The jwt token.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The account name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">account_id</span> <span class="o">=</span> <span class="n">account_id_from_jwt</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">account_id</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/api/v1/accounts/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;api_url&quot;</span><span class="p">],</span> <span class="n">account_id</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;authorization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bearer </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">token</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">response_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response_dict</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.request_instance_types" class="doc doc-heading">
<code class="highlight language-python"><span class="n">request_instance_types</span><span class="p">(</span><span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_param</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Get the list of available instances types.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>as_dict</code></td>
        <td><code>bool</code></td>
        <td><p>Whether or not to return the instance types as a dictionary.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>filter_param</code></td>
        <td><code>string</code></td>
        <td><p>complex RHS string query ex:
"cpu=gte:8:int,operating_system=ne:windows,gpu.gpu_count=eq:1:int"</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The list of instance types.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_instance_types</span><span class="p">(</span><span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_param</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the list of available instances types.</span>

<span class="sd">    Args:</span>
<span class="sd">        as_dict (bool): Whether or not to return the instance types as a dictionary.</span>
<span class="sd">        filter_param (string): complex RHS string query ex:</span>
<span class="sd">          &quot;cpu=gte:8:int,operating_system=ne:windows,gpu.gpu_count=eq:1:int&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The list of instance types.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>
    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="s2">&quot;api/v1/instance-types&quot;</span><span class="p">,</span> <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;filter&quot;</span><span class="p">:</span><span class="n">filter_param</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">200</span><span class="p">,):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Failed to get instance types&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">API responded with status code </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">instance_types</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found available instance types: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">instance_types</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">as_dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">[(</span><span class="n">instance</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">],</span> <span class="n">instance</span><span class="p">)</span> <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instance_types</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">instance_types</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.request_projects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">request_projects</span><span class="p">(</span><span class="n">statuses</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,))</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Query Conductor for all client Projects that are in the given status(es).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>statuses</code></td>
        <td><code>tuple</code></td>
        <td><p>The statuses to filter for.</p></td>
        <td><code>(&#39;active&#39;,)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The list of project names.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_projects</span><span class="p">(</span><span class="n">statuses</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;active&quot;</span><span class="p">,)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Query Conductor for all client Projects that are in the given status(es).</span>

<span class="sd">    Args:</span>
<span class="sd">        statuses (tuple): The statuses to filter for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The list of project names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;statuses: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">statuses</span><span class="p">)</span>

    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;api/v1/projects/&quot;</span>

    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response_code</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Failed to get available projects from Conductor&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error </span><span class="si">%s</span><span class="s2"> ...</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">projects</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Filter for only projects of the proper status</span>
    <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">statuses</span> <span class="ow">or</span> <span class="n">project</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">statuses</span><span class="p">:</span>
            <span class="n">projects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">project</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">projects</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.request_software_packages" class="doc doc-heading">
<code class="highlight language-python"><span class="n">request_software_packages</span><span class="p">()</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Query Conductor for all software packages for the currently available sidecar.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The list of software packages.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_software_packages</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Query Conductor for all software packages for the currently available sidecar.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The list of software packages.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>

    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;api/v1/ee/packages?all=true,&quot;</span>
    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Failed to get software packages for latest sidecar&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error </span><span class="si">%s</span><span class="s2"> ...</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">software</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">software</span> <span class="o">=</span> <span class="p">[</span><span class="n">sw</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">software</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;3dsmax&quot;</span> <span class="ow">in</span> <span class="n">sw</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">sw</span><span class="p">[</span><span class="s2">&quot;platform&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;linux&quot;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">software</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.request_extra_environment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">request_extra_environment</span><span class="p">()</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Query Conductor for extra environment.</p>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_extra_environment</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Query Conductor for extra environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>

    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;api/v1/integrations/env-vars-configs&quot;</span>
    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Failed to get extra environment&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error </span><span class="si">%s</span><span class="s2"> ...</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">all_accounts</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="n">token</span> <span class="o">=</span> <span class="n">read_conductor_credentials</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error: Could not get conductor credentials!&quot;</span><span class="p">)</span>
    <span class="n">account_id</span> <span class="o">=</span>  <span class="nb">str</span><span class="p">(</span><span class="n">account_id_from_jwt</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">account_id</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error: Could not get account id from jwt!&quot;</span><span class="p">)</span>
    <span class="n">account_env</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">account</span> <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">all_accounts</span> <span class="k">if</span> <span class="n">account</span><span class="p">[</span><span class="s2">&quot;account_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">account_id</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">account_env</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error: Could not get account environment!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account_env</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;env&quot;</span><span class="p">,</span> <span class="p">[])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.get_jobs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_jobs</span><span class="p">(</span><span class="n">first_jid</span><span class="p">,</span> <span class="n">last_jid</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Query Conductor for all jobs between the given job ids.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>The list of jobs.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>If the request fails.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ciocore</span><span class="w"> </span><span class="kn">import</span> <span class="n">api_client</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jobs</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">get_jobs</span><span class="p">(</span><span class="mi">1959</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">jobs</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;jid&quot;</span><span class="p">]</span>
<span class="s1">&#39;01959&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jobs</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">get_jobs</span><span class="p">(</span><span class="mi">1959</span><span class="p">,</span> <span class="mi">1961</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">jobs</span><span class="p">)</span>
<span class="mi">3</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_jobs</span><span class="p">(</span><span class="n">first_jid</span><span class="p">,</span> <span class="n">last_jid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Query Conductor for all jobs between the given job ids.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The list of jobs.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If the request fails.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from ciocore import api_client</span>
<span class="sd">        &gt;&gt;&gt; jobs = api_client.get_jobs(1959)</span>
<span class="sd">        &gt;&gt;&gt; len(jobs)</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; jobs[0][&quot;jid&quot;]</span>
<span class="sd">        &#39;01959&#39;</span>
<span class="sd">        &gt;&gt;&gt; jobs = api_client.get_jobs(1959, 1961)</span>
<span class="sd">        &gt;&gt;&gt; len(jobs)</span>
<span class="sd">        3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">last_jid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">last_jid</span> <span class="o">=</span> <span class="n">first_jid</span>
    <span class="n">low</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">first_jid</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">high</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">last_jid</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;api/v1/jobs&quot;</span>

    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span>
        <span class="n">verb</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
        <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;jid_gt_</span><span class="si">{</span><span class="n">low</span><span class="si">}</span><span class="s2">,jid_lt_</span><span class="si">{</span><span class="n">high</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to get jobs </span><span class="si">{</span><span class="n">first_jid</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">last_jid</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error </span><span class="si">%s</span><span class="s2"> ...</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">jobs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jobs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.get_log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_log</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="n">task_id</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Get the log for the given job and task.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>job_id</code></td>
        <td><code>str</code></td>
        <td><p>The job id.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>task_id</code></td>
        <td><code>str</code></td>
        <td><p>The task id.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>list</code></td>
      <td><p>A list of logs.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>If the request fails.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ciocore</span><span class="w"> </span><span class="kn">import</span> <span class="n">api_client</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">logs</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">get_log</span><span class="p">(</span><span class="mi">1959</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="s2">&quot;logs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;container_id&quot;</span><span class="p">:</span> <span class="s2">&quot;j-5669544198668288-5619559933149184-5095331660038144-stde&quot;</span><span class="p">,</span>
            <span class="s2">&quot;instance_name&quot;</span><span class="p">:</span> <span class="s2">&quot;renderer-5669544198668288-170062309438-62994&quot;</span><span class="p">,</span>
            <span class="s2">&quot;log&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Blender 2.93.0 (hash 84da05a8b806 built 2021-06-02 11:29:24)&quot;</span><span class="p">,</span>
                <span class="o">...</span>
                <span class="o">...</span>
                <span class="s2">&quot;Saved: &#39;/var/folders/8r/46lmjdmj50x_0swd9klwptzm0000gq/T/blender_bmw/renders/render_0001.png&#39;&quot;</span><span class="p">,</span>
                <span class="s2">&quot; Time: 00:29.22 (Saving: 00:00.32)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Blender quit&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;1.700623521101516E9&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;new_num_lines&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="mi">144</span>
    <span class="p">],</span>
    <span class="s2">&quot;status_description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;task_status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
<span class="p">}</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_log</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the log for the given job and task.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_id (str): The job id.</span>
<span class="sd">        task_id (str): The task id.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of logs.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If the request fails.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from ciocore import api_client</span>
<span class="sd">        &gt;&gt;&gt; logs = api_client.get_log(1959, 0)</span>
<span class="sd">        {</span>
<span class="sd">            &quot;logs&quot;: [</span>
<span class="sd">                {</span>
<span class="sd">                    &quot;container_id&quot;: &quot;j-5669544198668288-5619559933149184-5095331660038144-stde&quot;,</span>
<span class="sd">                    &quot;instance_name&quot;: &quot;renderer-5669544198668288-170062309438-62994&quot;,</span>
<span class="sd">                    &quot;log&quot;: [</span>
<span class="sd">                        &quot;Blender 2.93.0 (hash 84da05a8b806 built 2021-06-02 11:29:24)&quot;,</span>
<span class="sd">                        ...</span>
<span class="sd">                        ...</span>
<span class="sd">                        &quot;Saved: &#39;/var/folders/8r/46lmjdmj50x_0swd9klwptzm0000gq/T/blender_bmw/renders/render_0001.png&#39;&quot;,</span>
<span class="sd">                        &quot; Time: 00:29.22 (Saving: 00:00.32)&quot;,</span>
<span class="sd">                        &quot;&quot;,</span>
<span class="sd">                        &quot;&quot;,</span>
<span class="sd">                        &quot;Blender quit&quot;</span>
<span class="sd">                ],</span>
<span class="sd">                &quot;timestamp&quot;: &quot;1.700623521101516E9&quot;</span>
<span class="sd">                }</span>
<span class="sd">            ],</span>
<span class="sd">            &quot;new_num_lines&quot;: [</span>
<span class="sd">                144</span>
<span class="sd">            ],</span>
<span class="sd">            &quot;status_description&quot;: &quot;&quot;,</span>
<span class="sd">            &quot;task_status&quot;: &quot;success&quot;</span>
<span class="sd">        }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">task_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;get_log_file?job=</span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">&amp;task=</span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2">&amp;num_lines[]=0&quot;</span>

    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to get log for job </span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2"> task </span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error </span><span class="si">%s</span><span class="s2"> ...</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.kill_jobs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kill_jobs</span><span class="p">(</span><span class="o">*</span><span class="n">job_ids</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Kill the given jobs.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>job_ids</code></td>
        <td><code>list</code></td>
        <td><p>The list of job ids.</p></td>
        <td><code>()</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>The response.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ciocore</span><span class="w"> </span><span class="kn">import</span> <span class="n">api_client</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api_client</span><span class="o">.</span><span class="n">kill_jobs</span><span class="p">(</span><span class="s2">&quot;03095&quot;</span><span class="p">,</span><span class="s2">&quot;03094&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s2">&quot;Jobs [u&#39;03095&#39;, u&#39;03094&#39;] have been kill.&quot;</span><span class="p">}</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kill_jobs</span><span class="p">(</span><span class="o">*</span><span class="n">job_ids</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kill the given jobs.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_ids (list): The list of job ids.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The response.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from ciocore import api_client</span>
<span class="sd">        &gt;&gt;&gt; api_client.kill_jobs(&quot;03095&quot;,&quot;03094&quot;)</span>
<span class="sd">        {&#39;body&#39;: &#39;success&#39;, &#39;message&#39;: &quot;Jobs [u&#39;03095&#39;, u&#39;03094&#39;] have been kill.&quot;}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">job_id</span> <span class="ow">in</span> <span class="n">job_ids</span><span class="p">]</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;kill&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobids&quot;</span><span class="p">:</span> <span class="n">job_ids</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="s2">&quot;jobs_multi&quot;</span><span class="p">,</span> 
        <span class="n">verb</span><span class="o">=</span><span class="s2">&quot;PUT&quot;</span><span class="p">,</span> 
        <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
        <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to kill jobs </span><span class="si">{</span><span class="n">job_ids</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error </span><span class="si">%s</span><span class="s2"> ...</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.kill_tasks" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kill_tasks</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="o">*</span><span class="n">task_ids</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Kill the given tasks.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>job_id</code></td>
        <td><code>str</code></td>
        <td><p>The job id.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>task_ids</code></td>
        <td><code>list</code></td>
        <td><p>The list of task ids.</p></td>
        <td><code>()</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>The response.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ciocore</span><span class="w"> </span><span class="kn">import</span> <span class="n">api_client</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api_client</span><span class="o">.</span><span class="n">kill_tasks</span><span class="p">(</span><span class="s2">&quot;03096&quot;</span><span class="p">,</span> <span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">56</span><span class="p">))</span>
<span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39; 6 Tasks set to &quot;kill&quot;</span>
<span class="mi">050</span>
<span class="mi">051</span>
<span class="mi">052</span>
<span class="mi">053</span>
<span class="mi">054</span>
<span class="mi">055</span><span class="s1">&#39;}</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">kill_tasks</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="o">*</span><span class="n">task_ids</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kill the given tasks.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_id (str): The job id.</span>
<span class="sd">        task_ids (list): The list of task ids.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The response.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from ciocore import api_client</span>
<span class="sd">        &gt;&gt;&gt; api_client.kill_tasks(&quot;03096&quot;, *range(50,56))</span>
<span class="sd">        {&#39;body&#39;: &#39;success&#39;, &#39;message&#39;: &#39; 6 Tasks set to &quot;kill&quot;\n\t050\n\t051\n\t052\n\t053\n\t054\n\t055&#39;}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">job_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">task_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">task_id</span> <span class="ow">in</span> <span class="n">task_ids</span><span class="p">]</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;kill&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobid&quot;</span><span class="p">:</span> <span class="n">job_id</span><span class="p">,</span>
        <span class="s2">&quot;taskids&quot;</span><span class="p">:</span> <span class="n">task_ids</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">response</span><span class="p">,</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span>
        <span class="n">uri_path</span><span class="o">=</span><span class="s2">&quot;tasks_multi&quot;</span><span class="p">,</span> 
        <span class="n">verb</span><span class="o">=</span><span class="s2">&quot;PUT&quot;</span><span class="p">,</span> 
        <span class="n">raise_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
        <span class="n">use_api_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">response_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to kill tasks </span><span class="si">{</span><span class="n">task_ids</span><span class="si">}</span><span class="s2"> of job </span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error </span><span class="si">%s</span><span class="s2"> ...</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">response_code</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.get_compute_usage" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_compute_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Query the compute usage for an account.</p>
<p>Compute includes licenses, instances and Conductor cost. Everything involved
with running a job.    </p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>start_time</code></td>
        <td><code>datetime.datetime</code></td>
        <td><p>The first day to include in the report. Only the date is considered and it's assumed to be in UTC.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_time</code></td>
        <td><code>datetime.datetime</code></td>
        <td><p>The last day to include in the report. Only the date is considered and it's assumed to be in UTC.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>Each key is a date (UTC). The value is a dict with values for:
        - cost: The total accumulated compute cost for the day
        - corehours: The total accumulated core hours for the day
        - walltime: The number of minutes that instances (regardless of type) were running</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ciocore</span><span class="w"> </span><span class="kn">import</span> <span class="n">api_client</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api_client</span><span class="o">.</span><span class="n">get_compute_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
<span class="p">{</span>  <span class="s1">&#39;2024-01-09&#39;</span><span class="p">:</span> <span class="p">{</span>  <span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="mf">0.08</span><span class="p">,</span>
                    <span class="s1">&#39;corehours&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span> 
                    <span class="s1">&#39;walltime&#39;</span><span class="p">:</span> <span class="mf">13.93</span><span class="p">},</span>
    <span class="s1">&#39;2024-01-16&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>
                    <span class="s1">&#39;corehours&#39;</span><span class="p">:</span> <span class="mf">0.9613</span><span class="p">,</span> 
                    <span class="s1">&#39;walltime&#39;</span><span class="p">:</span> <span class="mf">7.21</span><span class="p">}}</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_compute_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Query the compute usage for an account.</span>

<span class="sd">    Compute includes licenses, instances and Conductor cost. Everything involved</span>
<span class="sd">    with running a job.    </span>

<span class="sd">    Args:</span>
<span class="sd">        start_time (datetime.datetime): The first day to include in the report. Only the date is considered and it&#39;s assumed to be in UTC.</span>
<span class="sd">        end_time (datetime.datetime): The last day to include in the report. Only the date is considered and it&#39;s assumed to be in UTC.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Each key is a date (UTC). The value is a dict with values for:</span>
<span class="sd">                - cost: The total accumulated compute cost for the day</span>
<span class="sd">                - corehours: The total accumulated core hours for the day</span>
<span class="sd">                - walltime: The number of minutes that instances (regardless of type) were running</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from ciocore import api_client</span>
<span class="sd">        &gt;&gt;&gt; api_client.get_compute_usage(start_time, end_time)</span>
<span class="sd">        {  &#39;2024-01-09&#39;: {  &#39;cost&#39;: 0.08,</span>
<span class="sd">                            &#39;corehours&#39;: 0.9, </span>
<span class="sd">                            &#39;walltime&#39;: 13.93},</span>
<span class="sd">            &#39;2024-01-16&#39;: { &#39;cost&#39;: 0.12,</span>
<span class="sd">                            &#39;corehours&#39;: 0.9613, </span>
<span class="sd">                            &#39;walltime&#39;: 7.21}}</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">date_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%a</span><span class="s2">, </span><span class="si">%d</span><span class="s2"> %b %Y %H:%M:%S %Z&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">_get_compute_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

    <span class="c1"># Create a nested default dictionary with initial float values of 0.0</span>
    <span class="n">results</span> <span class="o">=</span>  <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">entry_start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;start_time&#39;</span><span class="p">],</span> <span class="n">date_format</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

        <span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;walltime&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;minutes&#39;</span><span class="p">]</span>
        <span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;corehours&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;cores&#39;</span><span class="p">]</span>
        <span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;license_cost&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;instance_cost&#39;</span><span class="p">]</span>

    <span class="c1"># Round the data to avoid FP errors</span>
    <span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;walltime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;walltime&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;corehours&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;corehours&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">][</span><span class="s1">&#39;cost&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ciocore.api_client.get_storage_usage" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_storage_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Query the storage usage for an account.</p>
<p>Storage is calculated twice a day (UTC) and the average is used.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>start_time</code></td>
        <td><code>datetime.datetime</code></td>
        <td><p>The first day to include in the report. Only the date is considered and it's assumed to be in UTC.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>end_time</code></td>
        <td><code>datetime.datetime</code></td>
        <td><p>The last day to include in the report. Only the date is considered and it's assumed to be in UTC.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>Each key is a date (UTC). The value is a dict with values for:
        - cost: The cost of accumulated storage for that one day
        - GiB: The total amount of storage used on that day</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">ciocore</span><span class="w"> </span><span class="kn">import</span> <span class="n">api_client</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api_client</span><span class="o">.</span><span class="n">get_storage_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
<span class="p">{</span> <span class="s1">&#39;2024-01-01&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="mf">4.022</span><span class="p">,</span> <span class="s1">&#39;GiB&#39;</span><span class="p">:</span> <span class="mf">679.714</span><span class="p">},</span>
  <span class="s1">&#39;2024-01-02&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="mf">4.502</span><span class="p">,</span> <span class="s1">&#39;GiB&#39;</span><span class="p">:</span> <span class="mf">750.34</span><span class="p">},</span>
  <span class="s1">&#39;2024-01-03&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="mf">4.502</span><span class="p">,</span> <span class="s1">&#39;GiB&#39;</span><span class="p">:</span> <span class="mf">750.34</span><span class="p">}}</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ciocore/api_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_storage_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Query the storage usage for an account.</span>

<span class="sd">    Storage is calculated twice a day (UTC) and the average is used.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_time (datetime.datetime): The first day to include in the report. Only the date is considered and it&#39;s assumed to be in UTC.</span>
<span class="sd">        end_time (datetime.datetime): The last day to include in the report. Only the date is considered and it&#39;s assumed to be in UTC.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Each key is a date (UTC). The value is a dict with values for:</span>
<span class="sd">                - cost: The cost of accumulated storage for that one day</span>
<span class="sd">                - GiB: The total amount of storage used on that day</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from ciocore import api_client</span>
<span class="sd">        &gt;&gt;&gt; api_client.get_storage_usage(start_time, end_time)</span>
<span class="sd">        { &#39;2024-01-01&#39;: {&#39;cost&#39;: 4.022, &#39;GiB&#39;: 679.714},</span>
<span class="sd">          &#39;2024-01-02&#39;: {&#39;cost&#39;: 4.502, &#39;GiB&#39;: 750.34},</span>
<span class="sd">          &#39;2024-01-03&#39;: {&#39;cost&#39;: 4.502, &#39;GiB&#39;: 750.34}}</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">one_day</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">_get_storage_usage</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span>  <span class="p">{}</span>

    <span class="n">entry_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;start_date&#39;</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;cost_per_day&quot;</span><span class="p">]):</span>

        <span class="n">entry_start_date</span> <span class="o">=</span> <span class="n">entry_date</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="n">entry_start_date</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span> <span class="s1">&#39;GiB&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gibs_per_day&#39;</span><span class="p">][</span><span class="n">cnt</span><span class="p">])}</span>
        <span class="n">entry_date</span> <span class="o">+=</span> <span class="n">one_day</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023, CoreWeave.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.top"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.471ce7a9.min.js"></script>
      
    
  </body>
</html>
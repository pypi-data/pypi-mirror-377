# -*- coding: UTF-8 -*-
"""
{{project_name}} é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆç®€åŒ–ç‰ˆï¼‰
=============================
åŸºäº Crawlo æ¡†æ¶çš„ç®€åŒ–çˆ¬è™«é¡¹ç›®é…ç½®ã€‚
é€‚åˆå¿«é€Ÿå¼€å§‹å’Œå°å‹é¡¹ç›®ã€‚
"""

import os
from crawlo.config import CrawloConfig

# ============================== é¡¹ç›®åŸºæœ¬ä¿¡æ¯ ==============================
PROJECT_NAME = '{{project_name}}'
try:
    from crawlo import __version__
    VERSION = __version__
except ImportError:
    VERSION = '1.0.0'

# ============================== ç®€åŒ–ç‰ˆé…ç½®è¯´æ˜ ==============================
# 
# æœ¬æ¨¡æ¿ä¸“ä¸ºå¿«é€Ÿå¼€å§‹å’Œå°å‹é¡¹ç›®è®¾è®¡ï¼Œé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š
# - å­¦ä¹ å’Œå®éªŒç›®çš„
# - å°è§„æ¨¡æ•°æ®é‡‡é›†ä»»åŠ¡
# - ä¸ªäººé¡¹ç›®æˆ–åŸå‹å¼€å‘
# 
# è¿è¡Œæ¨¡å¼ç‰¹ç‚¹ï¼š
# - RUN_MODE = 'standalone'ï¼ˆå•æœºæ¨¡å¼ï¼‰
# - QUEUE_TYPE = 'memory'ï¼ˆä½¿ç”¨å†…å­˜é˜Ÿåˆ—ï¼‰
# - FILTER_CLASS = 'crawlo.filters.memory_filter.MemoryFilter'ï¼ˆå†…å­˜è¿‡æ»¤å™¨ï¼‰
# - DEFAULT_DEDUP_PIPELINE = 'crawlo.pipelines.memory_dedup_pipeline.MemoryDedupPipeline'ï¼ˆå†…å­˜å»é‡ï¼‰
# 
# é…ç½®ä¼˜åŠ¿ï¼š
# - ç®€å•æ˜“ç”¨ï¼Œå¼€ç®±å³ç”¨
# - æ— éœ€é¢å¤–ä¾èµ–ï¼ˆå¦‚Redisï¼‰
# - èµ„æºå ç”¨å°‘ï¼Œé€‚åˆä¸ªäººå¼€å‘ç¯å¢ƒ
# 
# æ‰©å±•å»ºè®®ï¼š
# - å¦‚éœ€è·¨ä¼šè¯å»é‡ï¼Œå¯å°†FILTER_CLASSå’ŒDEFAULT_DEDUP_PIPELINEæ”¹ä¸ºRediså®ç°
# - å¦‚éœ€æ›´é«˜æ€§èƒ½ï¼Œå¯è°ƒæ•´CONCURRENCYå’ŒDOWNLOAD_DELAYå‚æ•°
#
# ğŸ¯ æœ€ä½³ä½¿ç”¨æ–¹å¼ï¼š
# æ¨èä½¿ç”¨é…ç½®å·¥å‚æ–¹å¼åˆ›å»ºåŸºæœ¬é…ç½®ï¼š
# from crawlo.config import CrawloConfig
# config = CrawloConfig.standalone()
# process = CrawlerProcess(settings=config.to_dict())

# ============================== åŸºæœ¬é…ç½® ==============================
# ä½¿ç”¨é…ç½®å·¥å‚åˆ›å»ºåŸºæœ¬é…ç½®
CONFIG = CrawloConfig.standalone(
    concurrency=4,
    download_delay=1.0
)

# è·å–é…ç½®
locals().update(CONFIG.to_dict())

# ============================== ç½‘ç»œè¯·æ±‚é…ç½® ==============================
DOWNLOADER = "crawlo.downloader.httpx_downloader.HttpXDownloader"
DOWNLOAD_TIMEOUT = 30
VERIFY_SSL = True

# ============================== å¹¶å‘é…ç½® ==============================
CONCURRENCY = 4
DOWNLOAD_DELAY = 1.0

# ============================== æ•°æ®å­˜å‚¨é…ç½® ==============================
# MySQL é…ç½®
MYSQL_HOST = os.getenv('MYSQL_HOST', '127.0.0.1')
MYSQL_PORT = int(os.getenv('MYSQL_PORT', 3306))
MYSQL_USER = os.getenv('MYSQL_USER', 'root')
MYSQL_PASSWORD = os.getenv('MYSQL_PASSWORD', '123456')
MYSQL_DB = os.getenv('MYSQL_DB', '{{project_name}}')
MYSQL_TABLE = '{{project_name}}_data'

# MongoDB é…ç½®
MONGO_URI = os.getenv('MONGO_URI', 'mongodb://localhost:27017')
MONGO_DATABASE = '{{project_name}}_db'
MONGO_COLLECTION = '{{project_name}}_items'

# ============================== å»é‡é…ç½® ==============================
# æ˜ç¡®æŒ‡å®šç®€åŒ–æ¨¡å¼ä¸‹ä½¿ç”¨å†…å­˜å»é‡ç®¡é“
DEFAULT_DEDUP_PIPELINE = 'crawlo.pipelines.memory_dedup_pipeline.MemoryDedupPipeline'
FILTER_CLASS = 'crawlo.filters.memory_filter.MemoryFilter'

# ============================== ä¸­é—´ä»¶ä¸ç®¡é“ ==============================
MIDDLEWARES = [
    'crawlo.middleware.request_ignore.RequestIgnoreMiddleware',
    'crawlo.middleware.download_delay.DownloadDelayMiddleware',
    'crawlo.middleware.default_header.DefaultHeaderMiddleware',
    'crawlo.middleware.retry.RetryMiddleware',
    'crawlo.middleware.response_code.ResponseCodeMiddleware',
]

PIPELINES = [
    'crawlo.pipelines.console_pipeline.ConsolePipeline',
    # '{{project_name}}.pipelines.DatabasePipeline',
]

# æ˜ç¡®æ·»åŠ å†…å­˜å»é‡ç®¡é“åˆ°ç®¡é“åˆ—è¡¨å¼€å¤´
PIPELINES.insert(0, DEFAULT_DEDUP_PIPELINE)

# ============================== æ—¥å¿—é…ç½® ==============================
LOG_LEVEL = 'INFO'
LOG_FILE = f'logs/{{project_name}}.log'
STATS_DUMP = True

# ============================== è‡ªå®šä¹‰é…ç½® ==============================
# åœ¨æ­¤å¤„æ·»åŠ é¡¹ç›®ç‰¹å®šçš„é…ç½®é¡¹
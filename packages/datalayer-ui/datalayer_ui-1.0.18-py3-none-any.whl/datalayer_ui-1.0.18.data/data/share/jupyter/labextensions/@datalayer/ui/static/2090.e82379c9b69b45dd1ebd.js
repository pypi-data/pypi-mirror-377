"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[2090,9709],{59709:(e,t,n)=>{n.r(t),n.d(t,{CONNECTED_COMMAND:()=>ee,TOGGLE_CONNECT_COMMAND:()=>te,createBinding:()=>M,createUndoManager:()=>ne,getAnchorAndFocusCollabNodesForUserState:()=>U,initLocalState:()=>oe,setLocalStateFocus:()=>se,syncCursorPositions:()=>J,syncLexicalUpdateToYjs:()=>Z,syncYjsChangesToLexical:()=>Q});var o=n(63137),s=n(92206);function i(e,...t){const n=new URL("https://lexical.dev/docs/error"),o=new URLSearchParams;o.append("code",e);for(const e of t)o.append("v",e);throw n.search=o.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function r(e,t){const n=[];let s=e.__first;for(;null!==s;){const e=null===t?(0,o.$getNodeByKey)(s):t.get(s);null==e&&i(174),n.push(s),s=e.__next}return n}var l=n(90956);function c(e,...t){const n=new URL("https://lexical.dev/docs/error"),o=new URLSearchParams;o.append("code",e);for(const e of t)o.append("v",e);throw n.search=o.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class a{constructor(e,t){this._key="",this._map=e,this._parent=t,this._type="linebreak"}getNode(){const e=(0,o.$getNodeByKey)(this._key);return(0,o.$isLineBreakNode)(e)?e:null}getKey(){return this._key}getSharedType(){return this._map}getType(){return this._type}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}destroy(e){const t=e.collabNodeMap;t.get(this._key)===this&&t.delete(this._key)}}function f(e,t){const n=new a(e,t);return e._collabNode=n,n}class d{constructor(e,t,n,o){this._key="",this._map=e,this._parent=n,this._text=t,this._type=o,this._normalized=!1}getPrevNode(e){if(null===e)return null;const t=e.get(this._key);return(0,o.$isTextNode)(t)?t:null}getNode(){const e=(0,o.$getNodeByKey)(this._key);return(0,o.$isTextNode)(e)?e:null}getSharedType(){return this._map}getType(){return this._type}getKey(){return this._key}getSize(){return this._text.length+(this._normalized?0:1)}getOffset(){return this._parent.getChildOffset(this)}spliceText(e,t,n){const o=this._parent._xmlText,s=this.getOffset()+1+e;0!==t&&o.delete(s,t),""!==n&&o.insert(s,n)}syncPropertiesAndTextFromLexical(e,t,n){const s=this.getPrevNode(n),i=t.__text;if(w(e,this._map,s,t),null!==s){const e=s.__text;e!==i&&(function(e,t,n,s){const i=(0,o.$getSelection)();let r=s.length;if((0,o.$isRangeSelection)(i)&&i.isCollapsed()){const e=i.anchor;e.key===t&&(r=e.offset)}const l=function(e,t,n){const o=e.length,s=t.length;let i=0,r=0;for(;i<o&&i<s&&e[i]===t[i]&&i<n;)i++;for(;r+i<o&&r+i<s&&e[o-r-1]===t[s-r-1];)r++;for(;r+i<o&&r+i<s&&e[i]===t[i];)i++;return{index:i,insert:t.slice(i,s-r),remove:o-i-r}}(n,s,r);e.spliceText(l.index,l.remove,l.insert)}(this,t.__key,e,i),this._text=i)}}syncPropertiesAndTextFromYjs(e,t){const n=this.getNode();null===n&&c(84),$(e,this._map,n,t);const o=this._text;n.__text!==o&&n.setTextContent(o)}destroy(e){const t=e.collabNodeMap;t.get(this._key)===this&&t.delete(this._key)}}function u(e,t,n,o){const s=new d(e,t,n,o);return e._collabNode=s,s}const h=new Set(["__key","__parent","__next","__prev","__state"]),g=new Set(["__first","__last","__size","__dir"]),p=new Set(["__cachedText"]),_=new Set(["__text"]);function y(e,t,n){if(h.has(e)||"function"==typeof t[e])return!0;if((0,o.$isTextNode)(t)){if(_.has(e))return!0}else if((0,o.$isElementNode)(t)&&(g.has(e)||(0,o.$isRootNode)(t)&&p.has(e)))return!0;const s=t.constructor,i=n.excludedProperties.get(s);return null!=i&&i.has(e)}function m(e,t,n){const i=t.__type;let r;if((0,o.$isElementNode)(t))r=R(new s.XmlText,n,i),r.syncPropertiesFromLexical(e,t,null),r.syncChildrenFromLexical(e,t,null,null,null);else if((0,o.$isTextNode)(t))r=u(new s.Map,t.__text,n,i),r.syncPropertiesAndTextFromLexical(e,t,null);else if((0,o.$isLineBreakNode)(t)){const e=new s.Map;e.set("__type","linebreak"),r=f(e,n)}else(0,o.$isDecoratorNode)(t)?(r=F(new s.XmlElement,n,i),r.syncPropertiesFromLexical(e,t,null)):c(86);return r._key=t.__key,r}function x(e){const t=S(e,"__type");return"string"!=typeof t&&void 0!==t&&c(87),t}function N(e,t,n){const o=t._collabNode;if(void 0===o){const o=e.editor._nodes,i=x(t);"string"!=typeof i&&c(87),void 0===o.get(i)&&c(88,i);const r=t.parent,l=void 0===n&&null!==r?N(e,r):n||null;if(l instanceof L||c(89),t instanceof s.XmlText)return R(t,l,i);if(t instanceof s.Map)return"linebreak"===i?f(t,l):u(t,"",l,i);if(t instanceof s.XmlElement)return F(t,l,i)}return o}function T(e,t,n){const o=t.getType(),s=e.editor._nodes.get(o);void 0===s&&c(88,o);const i=new s.klass;if(i.__parent=n,t._key=i.__key,t instanceof L){const n=t._xmlText;t.syncPropertiesFromYjs(e,null),t.applyChildrenYjsDelta(e,n.toDelta()),t.syncChildrenFromYjs(e)}else t instanceof d?t.syncPropertiesAndTextFromYjs(e,null):t instanceof O&&t.syncPropertiesFromYjs(e,null);return e.collabNodeMap.set(i.__key,t),i}function $(e,t,n,i){const r=null===i?t instanceof s.Map?Array.from(t.keys()):Object.keys(t.getAttributes()):Array.from(i);let l;for(let i=0;i<r.length;i++){const c=r[i];if(y(c,n,e)){"__state"===c&&(l||(l=n.getWritable()),k(0,t,l));continue}const a=n[c];let f=S(t,c);if(a!==f){if(f instanceof s.Doc){const t=e.docMap;a instanceof s.Doc&&t.delete(a.guid);const n=(0,o.createEditor)(),i=f.guid;n._key=i,t.set(i,f),f=n}void 0===l&&(l=n.getWritable()),l[c]=f}}}function S(e,t){return e instanceof s.Map?e.get(t):e.getAttribute(t)}function C(e,t,n){e instanceof s.Map?e.set(t,n):e.setAttribute(t,n)}function k(e,t,n){const i=S(t,"__state");i instanceof s.Map&&(0,o.$getWritableNodeState)(n).updateFromJSON(i.toJSON())}function w(e,t,n,o){const i=o.__type,r=e.nodeProperties;let l=r.get(i);void 0===l&&(l=Object.keys(o).filter(t=>!y(t,o,e)),r.set(i,l));const c=e.editor.constructor;!function(e,t,n,o){const i=o.__state,r=S(t,"__state");if(!i)return;const[l,c]=i.getInternalState(),a=n&&n.__state,f=r instanceof s.Map?r:new s.Map;if(a===i)return;const[d,u]=a&&f.doc?a.getInternalState():[void 0,new Map];if(l)for(const[e,t]of Object.entries(l))d&&t!==d[e]&&f.set(e,t);for(const[e,t]of c)u.get(e)!==t&&f.set(e.key,e.unparse(t));r||C(t,"__state",f)}(0,t,n,o);for(let i=0;i<l.length;i++){const r=l[i],a=null===n?void 0:n[r];let f=o[r];if(a!==f){if(f instanceof c){const t=e.docMap;let n;if(a instanceof c){const e=a._key;n=t.get(e),t.delete(e)}const i=n||new s.Doc,r=i.guid;f._key=r,t.set(r,i),f=i,e.editor.update(()=>{o.markDirty()})}C(t,r,f)}}}function v(e,t,n,o){return e.slice(0,t)+o+e.slice(t+n)}function E(e,t,n){let o=0,s=0;const i=e._children,r=i.length;for(;s<r;s++){const e=i[s],l=o;if(o+=e.getSize(),(n?o>=t:o>t)&&e instanceof d){let n=t-l-1;return n<0&&(n=0),{length:o-t,node:e,nodeIndex:s,offset:n}}if(o>t)return{length:0,node:e,nodeIndex:s,offset:l};if(s===r-1)return{length:0,node:null,nodeIndex:s+1,offset:l+1}}return{length:0,node:null,nodeIndex:0,offset:0}}function b(e){const t=e.anchor,n=e.focus;let s=!1;try{const e=t.getNode(),i=n.getNode();(!e.isAttached()||!i.isAttached()||(0,o.$isTextNode)(e)&&t.offset>e.getTextContentSize()||(0,o.$isTextNode)(i)&&n.offset>i.getTextContentSize())&&(s=!0)}catch(e){s=!0}return s}function P(e,t){const n=t._nodeMap.get(e);if(!n)return void(0,o.$getRoot)().selectStart();const s=n.__prev;let i=null;s&&(i=(0,o.$getNodeByKey)(s)),null===i&&null!==n.__parent&&(i=(0,o.$getNodeByKey)(n.__parent)),null!==i?null!==i&&i.isAttached()?i.selectEnd():P(i.__key,t):(0,o.$getRoot)().selectStart()}class O{constructor(e,t,n){this._key="",this._xmlElem=e,this._parent=t,this._type=n}getPrevNode(e){if(null===e)return null;const t=e.get(this._key);return(0,o.$isDecoratorNode)(t)?t:null}getNode(){const e=(0,o.$getNodeByKey)(this._key);return(0,o.$isDecoratorNode)(e)?e:null}getSharedType(){return this._xmlElem}getType(){return this._type}getKey(){return this._key}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}syncPropertiesFromLexical(e,t,n){const o=this.getPrevNode(n);w(e,this._xmlElem,o,t)}syncPropertiesFromYjs(e,t){const n=this.getNode();null===n&&c(83),$(e,this._xmlElem,n,t)}destroy(e){const t=e.collabNodeMap;t.get(this._key)===this&&t.delete(this._key)}}function F(e,t,n){const o=new O(e,t,n);return e._collabNode=o,o}class L{constructor(e,t,n){this._key="",this._children=[],this._xmlText=e,this._type=n,this._parent=t}getPrevNode(e){if(null===e)return null;const t=e.get(this._key);return(0,o.$isElementNode)(t)?t:null}getNode(){const e=(0,o.$getNodeByKey)(this._key);return(0,o.$isElementNode)(e)?e:null}getSharedType(){return this._xmlText}getType(){return this._type}getKey(){return this._key}isEmpty(){return 0===this._children.length}getSize(){return 1}getOffset(){const e=this._parent;return null===e&&c(90),e.getChildOffset(this)}syncPropertiesFromYjs(e,t){const n=this.getNode();null===n&&c(91),$(e,this._xmlText,n,t)}applyChildrenYjsDelta(e,t){const n=this._children;let o=0,s=null;for(let i=0;i<t.length;i++){const r=t[i],l=r.insert,c=r.delete;if(null!=r.retain)o+=r.retain;else if("number"==typeof c){let e=c;for(;e>0;){const{node:t,nodeIndex:s,offset:i,length:r}=E(this,o,!1);if(t instanceof L||t instanceof a||t instanceof O)n.splice(s,1),e-=1;else{if(!(t instanceof d))break;{const o=Math.min(e,r),l=0!==s?n[s-1]:null,c=t.getSize();if(0===i&&r===c){n.splice(s,1);const e=v(t._text,i,o-1,"");e.length>0&&(l instanceof d?l._text+=e:this._xmlText.delete(i,e.length))}else t._text=v(t._text,i,o,"");e-=o}}}}else{if(null==l)throw new Error("Unexpected delta format");if("string"==typeof l){const{node:e,offset:t}=E(this,o,!0);e instanceof d?e._text=v(e._text,t,0,l):this._xmlText.delete(t,l.length),o+=l.length}else{const t=l,{node:i,nodeIndex:r,length:c}=E(this,o,!1),a=N(e,t,this);if(i instanceof d&&c>0&&c<i._text.length){const e=i._text,t=e.length-c;i._text=v(e,t,c,""),n.splice(r+1,0,a),s=v(e,0,t,"")}else n.splice(r,0,a);null!==s&&a instanceof d&&(a._text=s+a._text,s=null),o+=1}}}}syncChildrenFromYjs(e){const t=this.getNode();null===t&&c(92);const n=t.__key,s=r(t,null),i=s.length,l=this._children,f=l.length,u=e.collabNodeMap,h=new Set;let g,p,_=0,y=null;f!==i&&(p=t.getWritable());for(let i=0;i<f;i++){const r=s[_],m=l[i],x=m.getNode(),N=m._key;if(null!==x&&r===N){const t=(0,o.$isTextNode)(x);if(h.add(r),t)if(m._key=r,m instanceof L){const t=m._xmlText;m.syncPropertiesFromYjs(e,null),m.applyChildrenYjsDelta(e,t.toDelta()),m.syncChildrenFromYjs(e)}else m instanceof d?m.syncPropertiesAndTextFromYjs(e,null):m instanceof O?m.syncPropertiesFromYjs(e,null):m instanceof a||c(93);y=x,_++}else{if(void 0===g){g=new Set;for(let e=0;e<f;e++){const t=l[e]._key;""!==t&&g.add(t)}}if(null!==x&&void 0!==r&&!g.has(r)){const e=(0,o.$getNodeByKeyOrThrow)(r);(0,o.removeFromParent)(e),i--,_++;continue}p=t.getWritable();const s=T(e,m,n),c=s.__key;if(u.set(c,m),null===y){const e=p.getFirstChild();if(p.__first=c,null!==e){const t=e.getWritable();t.__prev=c,s.__next=t.__key}}else{const e=y.getWritable(),t=y.getNextSibling();if(e.__next=c,s.__prev=y.__key,null!==t){const e=t.getWritable();e.__prev=c,s.__next=e.__key}}i===f-1&&(p.__last=c),p.__size++,y=s}}for(let t=0;t<i;t++){const n=s[t];if(!h.has(n)){const t=(0,o.$getNodeByKeyOrThrow)(n),s=e.collabNodeMap.get(n);void 0!==s&&s.destroy(e),(0,o.removeFromParent)(t)}}}syncPropertiesFromLexical(e,t,n){w(e,this._xmlText,this.getPrevNode(n),t)}_syncChildFromLexical(e,t,n,s,i,r){const l=this._children[t],c=(0,o.$getNodeByKeyOrThrow)(n);l instanceof L&&(0,o.$isElementNode)(c)?(l.syncPropertiesFromLexical(e,c,s),l.syncChildrenFromLexical(e,c,s,i,r)):l instanceof d&&(0,o.$isTextNode)(c)?l.syncPropertiesAndTextFromLexical(e,c,s):l instanceof O&&(0,o.$isDecoratorNode)(c)&&l.syncPropertiesFromLexical(e,c,s)}syncChildrenFromLexical(e,t,n,s,i){const l=this.getPrevNode(n),c=null===l?[]:r(l,n),a=r(t,null),f=c.length-1,d=a.length-1,u=e.collabNodeMap;let h,g,p=0,_=0;for(;p<=f&&_<=d;){const t=c[p],r=a[_];if(t===r)this._syncChildFromLexical(e,_,r,n,s,i),p++,_++;else{void 0===h&&(h=new Set(c)),void 0===g&&(g=new Set(a));const n=g.has(t),s=h.has(r);if(n){const t=m(e,(0,o.$getNodeByKeyOrThrow)(r),this);u.set(r,t),s?(this.splice(e,_,1,t),p++,_++):(this.splice(e,_,0,t),_++)}else this.splice(e,_,1),p++}}const y=p>f,x=_>d;if(y&&!x)for(;_<=d;++_){const t=a[_],n=m(e,(0,o.$getNodeByKeyOrThrow)(t),this);this.append(n),u.set(t,n)}else if(x&&!y)for(let t=this._children.length-1;t>=_;t--)this.splice(e,t,1)}append(e){const t=this._xmlText,n=this._children,o=n[n.length-1],s=void 0!==o?o.getOffset()+o.getSize():0;if(e instanceof L)t.insertEmbed(s,e._xmlText);else if(e instanceof d){const n=e._map;null===n.parent&&t.insertEmbed(s,n),t.insert(s+1,e._text)}else e instanceof a?t.insertEmbed(s,e._map):e instanceof O&&t.insertEmbed(s,e._xmlElem);this._children.push(e)}splice(e,t,n,o){const s=this._children,i=s[t];if(void 0===i)return void 0===o&&c(94),void this.append(o);const r=i.getOffset();-1===r&&c(95);const l=this._xmlText;if(0!==n&&l.delete(r,i.getSize()),o instanceof L)l.insertEmbed(r,o._xmlText);else if(o instanceof d){const e=o._map;null===e.parent&&l.insertEmbed(r,e),l.insert(r+1,o._text)}else o instanceof a?l.insertEmbed(r,o._map):o instanceof O&&l.insertEmbed(r,o._xmlElem);if(0!==n){const o=s.slice(t,t+n);for(let t=0;t<o.length;t++)o[t].destroy(e)}void 0!==o?s.splice(t,n,o):s.splice(t,n)}getChildOffset(e){let t=0;const n=this._children;for(let o=0;o<n.length;o++){const s=n[o];if(s===e)return t;t+=s.getSize()}return-1}destroy(e){const t=e.collabNodeMap,n=this._children;for(let t=0;t<n.length;t++)n[t].destroy(e);t.get(this._key)===this&&t.delete(this._key)}}function R(e,t,n){const o=new L(e,t,n);return e._collabNode=o,o}function M(e,t,n,o,i,r){null==o&&c(81);const l=R(o.get("root",s.XmlText),null,"root");return l._key="root",{clientID:o.clientID,collabNodeMap:new Map,cursors:new Map,cursorsContainer:null,doc:o,docMap:i,editor:e,excludedProperties:r||new Map,id:n,nodeProperties:new Map,root:l}}function A(e,t){const n=t.collabNodeMap.get(e.key);if(void 0===n)return null;let i=e.offset,r=n.getSharedType();if(n instanceof d){r=n._parent._xmlText;const e=n.getOffset();if(-1===e)return null;i=e+1+i}else if(n instanceof L&&"element"===e.type){const t=e.getNode();(0,o.$isElementNode)(t)||c(184);let n=0,s=0,r=t.getFirstChild();for(;null!==r&&s++<i;)(0,o.$isTextNode)(r)?n+=r.getTextContentSize()+1:n++,r=r.getNextSibling();i=n}return(0,s.createRelativePositionFromTypeIndex)(r,i)}function K(e,t){return(0,s.createAbsolutePositionFromRelativePosition)(e,t.doc)}function I(e,t){if(null==e){if(null!=t)return!0}else if(null==t||!(0,s.compareRelativePositions)(e,t))return!0;return!1}function B(e,t){return{color:t,name:e,selection:null}}function z(e,t){const n=e.cursorsContainer;if(null!==n){const e=t.selections,o=e.length;for(let t=0;t<o;t++)n.removeChild(e[t])}}function D(e,t){const n=t.selection;null!==n&&z(e,n)}function Y(e,t,n,o,s){const i=e.color,r=document.createElement("span");r.style.cssText=`position:absolute;top:0;bottom:0;right:-1px;width:1px;background-color:${i};z-index:10;`;const l=document.createElement("span");return l.textContent=e.name,l.style.cssText=`position:absolute;left:-2px;top:-16px;background-color:${i};color:#fff;line-height:12px;font-size:12px;padding:2px;font-family:Arial;font-weight:bold;white-space:nowrap;`,r.appendChild(l),{anchor:{key:t,offset:n},caret:r,color:i,focus:{key:o,offset:s},name:l,selections:[]}}function j(e,t,n,s){const i=e.editor,r=i.getRootElement(),c=e.cursorsContainer;if(null===c||null===r)return;const a=c.offsetParent;if(null===a)return;const f=a.getBoundingClientRect(),d=t.selection;if(null===n)return null===d?void 0:(t.selection=null,void z(e,d));t.selection=n;const u=n.caret,h=n.color,g=n.selections,p=n.anchor,_=n.focus,y=p.key,m=_.key,x=s.get(y),N=s.get(m);if(null==x||null==N)return;let T;if(x===N&&(0,o.$isLineBreakNode)(x))T=[i.getElementByKey(y).getBoundingClientRect()];else{const e=(0,l.cb)(i,x,p.offset,N,_.offset);if(null===e)return;T=(0,l.zT)(i,e)}const $=g.length,S=T.length;for(let e=0;e<S;e++){const t=T[e];let n=g[e];if(void 0===n){n=document.createElement("span"),g[e]=n;const t=document.createElement("span");n.appendChild(t),c.appendChild(n)}const o=`position:absolute;top:${t.top-f.top}px;left:${t.left-f.left}px;height:${t.height}px;width:${t.width}px;pointer-events:none;z-index:5;`;n.style.cssText=o,n.firstChild.style.cssText=`${o}left:0;top:0;background-color:${h};opacity:0.3;`,e===S-1&&u.parentNode!==n&&n.appendChild(u)}for(let e=$-1;e>=S;e--){const t=g[e];c.removeChild(t),g.pop()}}function U(e,t){const{anchorPos:n,focusPos:o}=t;let s=null,i=0,r=null,l=0;if(null!==n&&null!==o){const t=K(n,e),c=K(o,e);null!==t&&null!==c&&([s,i]=G(t.type,t.index),[r,l]=G(c.type,c.index))}return{anchorCollabNode:s,anchorOffset:i,focusCollabNode:r,focusOffset:l}}function W(e,t){const n=t.awareness.getLocalState();if(null===n)return;const{anchorCollabNode:s,anchorOffset:i,focusCollabNode:r,focusOffset:l}=U(e,n);if(null!==s&&null!==r){const e=s.getKey(),t=r.getKey(),n=(0,o.$getSelection)();if(!(0,o.$isRangeSelection)(n))return;X(n.anchor,e,i),X(n.focus,t,l)}}function X(e,t,n){if(e.key!==t||e.offset!==n){let s=(0,o.$getNodeByKey)(t);if(null!==s&&!(0,o.$isElementNode)(s)&&!(0,o.$isTextNode)(s)){const e=s.getParentOrThrow();t=e.getKey(),n=s.getIndexWithinParent(),s=e}e.set(t,n,(0,o.$isElementNode)(s)?"element":"text")}}function G(e,t){const n=e._collabNode;if(void 0===n)return[null,0];if(n instanceof L){const{node:e,offset:o}=E(n,t,!0);return null===e?[n,0]:[e,o]}return[null,0]}function H(e,t){return t.awareness.getStates()}function J(e,t,n){const{getAwarenessStates:o=H}=n??{},s=Array.from(o(e,t)),i=e.clientID,r=e.cursors,l=e.editor._editorState._nodeMap,c=new Set;for(let t=0;t<s.length;t++){const n=s[t],[o,a]=n;if(o!==i){c.add(o);const{name:t,color:n,focusing:s}=a;let i=null,f=r.get(o);if(void 0===f&&(f=B(t,n),r.set(o,f)),s){const{anchorCollabNode:t,anchorOffset:n,focusCollabNode:o,focusOffset:s}=U(e,a);if(null!==t&&null!==o){const e=t.getKey(),r=o.getKey();if(i=f.selection,null===i)i=Y(f,e,n,r,s);else{const t=i.anchor,o=i.focus;t.key=e,t.offset=n,o.key=r,o.offset=s}}}j(e,f,i,l)}}const a=Array.from(r.keys());for(let t=0;t<a.length;t++){const n=a[t];if(!c.has(n)){const t=r.get(n);void 0!==t&&(D(e,t),r.delete(n))}}}function V(e,t,n,s){const i=t.awareness,r=i.getLocalState();if(null===r)return;const{anchorPos:l,focusPos:c,name:a,color:f,focusing:d,awarenessData:u}=r;let h=null,g=null;(null!==s&&(null===l||s.is(n))||null!==n)&&((0,o.$isRangeSelection)(s)&&(h=A(s.anchor,e),g=A(s.focus,e)),(I(l,h)||I(c,g))&&i.setLocalState({...r,anchorPos:h,awarenessData:u,color:f,focusPos:g,focusing:d,name:a}))}function q(e,t){if(t instanceof s.YMapEvent&&function(e,t){const{target:n}=t;if(!n._item||"__state"!==n._item.parentSub||void 0!==x(n)||!(n.parent instanceof s.XmlText||n.parent instanceof s.XmlElement||n.parent instanceof s.Map))return!1;const i=N(e,n.parent).getNode();if(i){const e=(0,o.$getWritableNodeState)(i.getWritable());for(const o of t.keysChanged)e.updateFromUnknown(o,n.get(o))}return!0}(e,t))return;const{target:n}=t,i=N(e,n);if(i instanceof L&&t instanceof s.YTextEvent){const{keysChanged:n,childListChanged:o,delta:s}=t;n.size>0&&i.syncPropertiesFromYjs(e,n),o&&(i.applyChildrenYjsDelta(e,s),i.syncChildrenFromYjs(e))}else if(i instanceof d&&t instanceof s.YMapEvent){const{keysChanged:n}=t;n.size>0&&i.syncPropertiesAndTextFromYjs(e,n)}else if(i instanceof O&&t instanceof s.YXmlEvent){const{attributesChanged:n}=t;n.size>0&&i.syncPropertiesFromYjs(e,n)}else c(82)}function Q(e,t,n,s,i=J){const r=e.editor,l=r._editorState;n.forEach(e=>e.delta),r.update(()=>{for(let t=0;t<n.length;t++){const o=n[t];q(e,o)}const i=(0,o.$getSelection)();if((0,o.$isRangeSelection)(i))if(b(i)){const n=l._selection;(0,o.$isRangeSelection)(n)&&(W(e,t),b(i))&&P(i.anchor.key,l),V(e,t,n,(0,o.$getSelection)())}else W(e,t);s||(0,o.$addUpdateTag)(o.SKIP_SCROLL_INTO_VIEW_TAG)},{onUpdate:()=>{i(e,t),r.update(()=>{0===(0,o.$getRoot)().getChildrenSize()&&(0,o.$getRoot)().append((0,o.$createParagraphNode)())})},skipTransforms:!0,tag:s?o.HISTORIC_TAG:o.COLLABORATION_TAG})}function Z(e,t,n,s,i,r,l,c){!function(e,t){e.doc.transact(t,e)}(e,()=>{s.read(()=>{if(c.has(o.COLLABORATION_TAG)||c.has(o.HISTORIC_TAG))return void(l.size>0&&function(e,t){const n=Array.from(t),s=e.collabNodeMap,i=[],r=[];for(let e=0;e<n.length;e++){const t=n[e],l=(0,o.$getNodeByKey)(t),c=s.get(t);if(c instanceof d)if((0,o.$isTextNode)(l))i.push([c,l.__text]);else{const e=c.getOffset();if(-1===e)continue;const t=c._parent;c._normalized=!0,t._xmlText.delete(e,1),r.push(c)}}for(let e=0;e<r.length;e++){const t=r[e],n=t.getKey();s.delete(n);const o=t._parent._children,i=o.indexOf(t);o.splice(i,1)}for(let e=0;e<i.length;e++){const[t,n]=i[e];t._text=n}}(e,l));if(i.has("root")){const t=n._nodeMap,s=(0,o.$getRoot)(),l=e.root;l.syncPropertiesFromLexical(e,s,t),l.syncChildrenFromLexical(e,s,t,i,r)}const s=(0,o.$getSelection)(),a=n._selection;V(e,t,a,s)})})}const ee=(0,o.createCommand)("CONNECTED_COMMAND"),te=(0,o.createCommand)("TOGGLE_CONNECT_COMMAND");function ne(e,t){return new s.UndoManager(t,{trackedOrigins:new Set([e,null])})}function oe(e,t,n,o,s){e.awareness.setLocalState({anchorPos:null,awarenessData:s,color:n,focusPos:null,focusing:o,name:t})}function se(e,t,n,o,s){const{awareness:i}=e;let r=i.getLocalState();null===r&&(r={anchorPos:null,awarenessData:s,color:n,focusPos:null,focusing:o,name:t}),r.focusing=o,i.setLocalState(r)}},90956:(e,t,n)=>{n.d(t,{AH:()=>x,Cb:()=>$,LP:()=>S,Nx:()=>h,Rk:()=>C,SD:()=>u,Wh:()=>d,Xg:()=>g,cb:()=>c,zI:()=>_,zT:()=>a});var o=n(63137);function s(e,...t){const n=new URL("https://lexical.dev/docs/error"),o=new URLSearchParams;o.append("code",e);for(const e of t)o.append("v",e);throw n.search=o.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const i=new Map;function r(e){let t=e;for(;null!=t;){if(t.nodeType===Node.TEXT_NODE)return t;t=t.firstChild}return null}function l(e){const t=e.parentNode;if(null==t)throw new Error("Should never happen");return[t,Array.from(t.childNodes).indexOf(e)]}function c(e,t,n,s,i){const c=t.getKey(),a=s.getKey(),f=document.createRange();let d=e.getElementByKey(c),u=e.getElementByKey(a),h=n,g=i;if((0,o.$isTextNode)(t)&&(d=r(d)),(0,o.$isTextNode)(s)&&(u=r(u)),void 0===t||void 0===s||null===d||null===u)return null;"BR"===d.nodeName&&([d,h]=l(d)),"BR"===u.nodeName&&([u,g]=l(u));const p=d.firstChild;d===u&&null!=p&&"BR"===p.nodeName&&0===h&&0===g&&(g=1);try{f.setStart(d,h),f.setEnd(u,g)}catch(e){return null}return!f.collapsed||h===g&&c===a||(f.setStart(u,g),f.setEnd(d,h)),f}function a(e,t){const n=e.getRootElement();if(null===n)return[];const o=n.getBoundingClientRect(),s=getComputedStyle(n),i=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),r=Array.from(t.getClientRects());let l,c=r.length;r.sort((e,t)=>{const n=e.top-t.top;return Math.abs(n)<=3?e.left-t.left:n});for(let e=0;e<c;e++){const t=r[e],n=l&&l.top<=t.top&&l.top+l.height>t.top&&l.left+l.width>t.left,s=t.width+i===o.width;n||s?(r.splice(e--,1),c--):l=t}return r}function f(e){const t={};if(!e)return t;const n=e.split(";");for(const e of n)if(""!==e){const[n,o]=e.split(/:([^]+)/);n&&o&&(t[n.trim()]=o.trim())}return t}function d(e){let t=i.get(e);return void 0===t&&(t=f(e),i.set(e,t)),t}function u(e,t){const n=e.getStartEndPoints();if(t.isSelected(e)&&!(0,o.$isTokenOrSegmented)(t)&&null!==n){const[s,i]=n,r=e.isBackward(),l=s.getNode(),c=i.getNode(),a=t.is(l),f=t.is(c);if(a||f){const[n,s]=(0,o.$getCharacterOffsets)(e),i=l.is(c),a=t.is(r?c:l),f=t.is(r?l:c);let d,u=0;i?(u=n>s?s:n,d=n>s?n:s):a?(u=r?s:n,d=void 0):f&&(u=0,d=r?n:s),t.__text=t.__text.slice(u,d)}}return t}function h(e){if("text"===e.type)return e.offset===e.getNode().getTextContentSize();const t=e.getNode();return(0,o.$isElementNode)(t)||s(177),e.offset===t.getChildrenSize()}function g(e){const t=e.getStyle(),n=f(t);i.set(t,n)}function p(e,t){const n=e.getFormatType(),o=e.getIndent();n!==t.getFormatType()&&t.setFormat(n),o!==t.getIndent()&&t.setIndent(o)}function _(e,t,n=p){if(null===e)return;const s=e.getStartEndPoints(),i=new Map;let r=null;if(s){const[e,t]=s;r=(0,o.$createRangeSelection)(),r.anchor.set(e.key,e.offset,e.type),r.focus.set(t.key,t.offset,t.type);const n=k(e.getNode(),o.INTERNAL_$isBlock),l=k(t.getNode(),o.INTERNAL_$isBlock);(0,o.$isElementNode)(n)&&i.set(n.getKey(),n),(0,o.$isElementNode)(l)&&i.set(l.getKey(),l)}for(const t of e.getNodes())if((0,o.$isElementNode)(t)&&(0,o.INTERNAL_$isBlock)(t))i.set(t.getKey(),t);else if(null===s){const e=k(t,o.INTERNAL_$isBlock);(0,o.$isElementNode)(e)&&i.set(e.getKey(),e)}for(const[e,o]of i){const s=t();n(o,s),o.replace(s,!0),r&&(e===r.anchor.key&&r.anchor.set(s.getKey(),r.anchor.offset,r.anchor.type),e===r.focus.key&&r.focus.set(s.getKey(),r.focus.offset,r.focus.type))}r&&e.is((0,o.$getSelection)())&&(0,o.$setSelection)(r)}function y(e){return e.getNode().isAttached()}function m(e){let t=e;for(;null!==t&&!(0,o.$isRootOrShadowRoot)(t);){const e=t.getLatest(),n=t.getParent();0===e.getChildrenSize()&&t.remove(!0),t=n}}function x(e,t,n=null){const s=e.getStartEndPoints(),i=s?s[0]:null,r=e.getNodes(),l=r.length;if(null!==i&&(0===l||1===l&&"element"===i.type&&0===i.getNode().getChildrenSize())){const e="text"===i.type?i.getNode().getParentOrThrow():i.getNode(),o=e.getChildren();let s=t();return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),o.forEach(e=>s.append(e)),n&&(s=n.append(s)),void e.replace(s)}let c=null,a=[];for(let s=0;s<l;s++){const i=r[s];(0,o.$isRootOrShadowRoot)(i)?(N(e,a,a.length,t,n),a=[],c=i):null===c||null!==c&&(0,o.$hasAncestor)(i,c)?a.push(i):(N(e,a,a.length,t,n),a=[i])}N(e,a,a.length,t,n)}function N(e,t,n,i,r=null){if(0===t.length)return;const l=t[0],c=new Map,a=[];let f=(0,o.$isElementNode)(l)?l:l.getParentOrThrow();f.isInline()&&(f=f.getParentOrThrow());let d=!1;for(;null!==f;){const e=f.getPreviousSibling();if(null!==e){f=e,d=!0;break}if(f=f.getParentOrThrow(),(0,o.$isRootOrShadowRoot)(f))break}const u=new Set;for(let e=0;e<n;e++){const n=t[e];(0,o.$isElementNode)(n)&&0===n.getChildrenSize()&&u.add(n.getKey())}const h=new Set;for(let e=0;e<n;e++){const n=t[e];let r=n.getParent();if(null!==r&&r.isInline()&&(r=r.getParent()),null!==r&&(0,o.$isLeafNode)(n)&&!h.has(n.getKey())){const e=r.getKey();if(void 0===c.get(e)){const t=i();t.setFormat(r.getFormatType()),t.setIndent(r.getIndent()),a.push(t),c.set(e,t),r.getChildren().forEach(e=>{t.append(e),h.add(e.getKey()),(0,o.$isElementNode)(e)&&e.getChildrenKeys().forEach(e=>h.add(e))}),m(r)}}else if(u.has(n.getKey())){(0,o.$isElementNode)(n)||s(179);const e=i();e.setFormat(n.getFormatType()),e.setIndent(n.getIndent()),a.push(e),n.remove(!0)}}if(null!==r)for(let e=0;e<a.length;e++){const t=a[e];r.append(t)}let g=null;if((0,o.$isRootOrShadowRoot)(f))if(d)if(null!==r)f.insertAfter(r);else for(let e=a.length-1;e>=0;e--){const t=a[e];f.insertAfter(t)}else{const e=f.getFirstChild();if((0,o.$isElementNode)(e)&&(f=e),null===e)if(r)f.append(r);else for(let e=0;e<a.length;e++){const t=a[e];f.append(t),g=t}else if(null!==r)e.insertBefore(r);else for(let t=0;t<a.length;t++){const n=a[t];e.insertBefore(n),g=n}}else if(r)f.insertAfter(r);else for(let e=a.length-1;e>=0;e--){const t=a[e];f.insertAfter(t),g=t}const p=(0,o.$getPreviousSelection)();(0,o.$isRangeSelection)(p)&&y(p.anchor)&&y(p.focus)?(0,o.$setSelection)(p.clone()):null!==g?g.selectEnd():e.dirty=!0}function T(e){const t=e.anchor.getNode(),n=(0,o.$isRootNode)(t)?t:t.getParentOrThrow(),s=(0,o.$getEditor)().getElementByKey(n.getKey());if(null===s)return!1;const i=s.ownerDocument.defaultView;return null!==i&&"vertical-rl"===i.getComputedStyle(s).writingMode}function $(e,t){const n=T(e)?!t:t,s=(0,o.$caretFromPoint)(e.focus,n?"previous":"next");if((0,o.$isExtendableTextPointCaret)(s))return!1;for(const e of(0,o.$extendCaretToRange)(s)){if((0,o.$isChildCaret)(e))return!e.origin.isInline();if(!(0,o.$isElementNode)(e.origin)){if((0,o.$isDecoratorNode)(e.origin))return!0;break}}return!1}function S(e){const t=e.anchor.getNode();return"rtl"===((0,o.$isRootNode)(t)?t:t.getParentOrThrow()).getDirection()}function C(e,t,n){const o=S(e);let s;s=T(e)||o?!n:n,function(e,t,n){e.modify(t?"extend":"move",n,"character")}(e,t,s)}function k(e,t){let n=e;for(;null!==n&&null!==n.getParent()&&!t(n);)n=n.getParentOrThrow();return t(n)?n:null}}}]);
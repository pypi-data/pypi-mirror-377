"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5003,6440],{3188:(e,t,r)=>{r.d(t,{k:()=>L});var n=r(18008),a=r(45474),o=r(80914),i=r(58007);const s=new Map,c="undefined"==typeof BroadcastChannel?class{constructor(e){this.room=e,this.onmessage=null,this._onChange=t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:o.Ey(t.newValue||"")}),i.k9(this._onChange)}postMessage(e){i.JT.setItem(this.room,o.nk(o.zS(e)))}close(){i.o6(this._onChange)}}:BroadcastChannel,l=e=>n._4(s,e,()=>{const t=a.vt(),r=new c(e);return r.onmessage=e=>t.forEach(t=>t(e.data,"broadcastchannel")),{bc:r,subs:t}}),d=(e,t,r=null)=>{const n=l(e);n.bc.postMessage(t),n.subs.forEach(e=>e(t,r))};var u=r(38229),m=r(39189),h=r(50809),p=r(9366);const v=(e,t)=>{m.zd(e,0);const r=p.FX(t);m.Gu(e,r)},f=(e,t,r)=>{m.zd(e,1),m.Gu(e,p.PR(t,r))},w=(e,t,r)=>{try{p.QE(t,h.bo(e),r)}catch(e){console.error("Caught error while handling a Yjs update",e)}},g=w;var y=r(54195),x=r(48201),S=r(51318),k=r(287),b=r(8417),T=r(42165);const C=[];C[0]=(e,t,r,n,a)=>{m.zd(e,0);const o=((e,t,r,n)=>{const a=h.cw(e);switch(a){case 0:((e,t,r)=>{f(t,r,h.bo(e))})(e,t,r);break;case 1:w(e,r,n);break;case 2:g(e,r,n);break;default:throw new Error("Unknown message type")}return a})(t,e,r.doc,r);n&&1===o&&!r.synced&&(r.synced=!0)},C[3]=(e,t,r,n,a)=>{m.zd(e,1),m.Gu(e,y.X3(r.awareness,Array.from(r.awareness.getStates().keys())))},C[1]=(e,t,r,n,a)=>{y.tQ(r.awareness,h.bo(t),r)},C[2]=(e,t,r,n,a)=>{((e,t,r)=>{0===h.cw(e)&&r(0,h.t3(e))})(t,r.doc,(e,t)=>A(r,t))};const A=(e,t)=>console.warn(`Permission denied to access ${e.url}.\n${t}`),V=(e,t,r)=>{const n=h.$C(t),a=m.xv(),o=h.cw(n),i=e.messageHandlers[o];return i?i(a,n,e,r,o):console.error("Unable to compute message"),a},E=(e,t,r)=>{t===e.ws&&(e.emit("connection-close",[r,e]),e.ws=null,t.close(),e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,y._g(e.awareness,Array.from(e.awareness.getStates().keys()).filter(t=>t!==e.doc.clientID),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(I,S.jk(100*S.n7(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e))},I=e=>{if(e.shouldConnect&&null===e.ws){const t=new e._WS(e.url,e.protocols);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=r=>{e.wsLastMessageReceived=u._g();const n=V(e,new Uint8Array(r.data),!0);m.Bw(n)>1&&t.send(m.Fo(n))},t.onerror=t=>{e.emit("connection-error",[t,e])},t.onclose=r=>{E(e,t,r)},t.onopen=()=>{e.wsLastMessageReceived=u._g(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);const r=m.xv();if(m.zd(r,0),v(r,e.doc),t.send(m.Fo(r)),null!==e.awareness.getLocalState()){const r=m.xv();m.zd(r,1),m.Gu(r,y.X3(e.awareness,[e.doc.clientID])),t.send(m.Fo(r))}},e.emit("status",[{status:"connecting"}])}},j=(e,t)=>{const r=e.ws;e.wsconnected&&r&&r.readyState===r.OPEN&&r.send(t),e.bcconnected&&d(e.bcChannel,t,e)};class _ extends x.W{constructor(e,t,r,{connect:n=!0,awareness:a=new y.ww(r),params:o={},protocols:i=[],WebSocketPolyfill:s=WebSocket,resyncInterval:c=-1,maxBackoffTime:l=2500,disableBc:h=!1}={}){for(super();"/"===e[e.length-1];)e=e.slice(0,e.length-1);this.serverUrl=e,this.bcChannel=e+"/"+t,this.maxBackoffTime=l,this.params=o,this.protocols=i,this.roomname=t,this.doc=r,this._WS=s,this.awareness=a,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=h,this.wsUnsuccessfulReconnects=0,this.messageHandlers=C.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=n,this._resyncInterval=0,c>0&&(this._resyncInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){const e=m.xv();m.zd(e,0),v(e,r),this.ws.send(m.Fo(e))}},c)),this._bcSubscriber=(e,t)=>{if(t!==this){const t=V(this,new Uint8Array(e),!1);m.Bw(t)>1&&d(this.bcChannel,m.Fo(t),this)}},this._updateHandler=(e,t)=>{if(t!==this){const t=m.xv();m.zd(t,0),((e,t)=>{m.zd(e,2),m.Gu(e,t)})(t,e),j(this,m.Fo(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:e,updated:t,removed:r},n)=>{const o=e.concat(t).concat(r),i=m.xv();m.zd(i,1),m.Gu(i,y.X3(a,o)),j(this,m.Fo(i))},this._exitHandler=()=>{y._g(this.awareness,[r.clientID],"app closed")},b.Ll&&void 0!==T&&T.on("exit",this._exitHandler),a.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.wsconnected&&3e4<u._g()-this.wsLastMessageReceived&&E(this,this.ws,null)},3e3),n&&this.connect()}get url(){const e=(t=this.params,k.Tj(t,(e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`).join("&"));var t;return this.serverUrl+"/"+this.roomname+(0===e.length?"":"?"+e)}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),b.Ll&&void 0!==T&&T.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;var e,t;this.bcconnected||(e=this.bcChannel,t=this._bcSubscriber,l(e).subs.add(t),this.bcconnected=!0);const r=m.xv();m.zd(r,0),v(r,this.doc),d(this.bcChannel,m.Fo(r),this);const n=m.xv();m.zd(n,0),f(n,this.doc),d(this.bcChannel,m.Fo(n),this);const a=m.xv();m.zd(a,3),d(this.bcChannel,m.Fo(a),this);const o=m.xv();m.zd(o,1),m.Gu(o,y.X3(this.awareness,[this.doc.clientID])),d(this.bcChannel,m.Fo(o),this)}disconnectBc(){const e=m.xv();m.zd(e,1),m.Gu(e,y.X3(this.awareness,[this.doc.clientID],new Map)),j(this,m.Fo(e)),this.bcconnected&&(((e,t)=>{const r=l(e);r.subs.delete(t)&&0===r.subs.size&&(r.bc.close(),s.delete(e))})(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&E(this,this.ws,null)}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(I(this),this.connectBc())}}var R,z=r(63711),N=r(72490),D=r(9570);!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Error="error"}(R||(R={}));class L{type="datalayer";_status=R.Disconnected;_provider=null;_sharedModel=null;_statusChanged=new N.Signal(this);_errorOccurred=new N.Signal(this);_syncStateChanged=new N.Signal(this);_isDisposed=!1;_config;_onSync=null;_onConnectionClose=null;constructor(e){this._config=e}get status(){return this._status}get isConnected(){return this._status===R.Connected}get isDisposed(){return this._isDisposed}get events(){return{statusChanged:this._statusChanged,errorOccurred:this._errorOccurred,syncStateChanged:this._syncStateChanged}}setStatus(e){this._status!==e&&(this._status=e,this._statusChanged.emit(e))}async connect(e,t,r){if(this.isConnected)console.warn("Already connected to Datalayer collaboration service");else{this.setStatus(R.Connecting);try{const{configuration:n}=D.$K.getState(),a=this._config.runUrl??n?.runUrl,o=this._config.token??n?.token;if(!a)throw new Error("Datalayer runUrl is not configured");if(!o)throw new Error("Datalayer token is not configured");const{ydoc:i,awareness:s}=e,c=z.URLExt.join(a,"/api/spacer/v1/documents"),l=c.replace(/^http/,"ws"),d=await async function({url:e,token:t}){const r={Accept:"application/json"};t&&(r.Authorization=`Bearer ${t}`);const n=await fetch(e,{method:"GET",headers:r,credentials:t?"include":"omit",mode:"cors",cache:"no-store"});if(n.ok)return(await n.json()).sessionId;throw console.error("Failed to fetch session ID.",n),new Error("Failed to fetch session ID.")}({url:z.URLExt.join(c,t),token:o});this._provider=new _(l,t,i,{disableBc:!0,params:{sessionId:d,token:o},awareness:s,...r}),this._sharedModel=e,this._onSync=e=>{this.handleSync(e)},this._onConnectionClose=e=>{e&&this.handleConnectionClose(e)},this._provider.on("sync",this._onSync),this._provider.on("connection-close",this._onConnectionClose),console.log("Connected to Datalayer collaboration service")}catch(e){throw this.setStatus(R.Error),this._errorOccurred.emit(e),e}}}disconnect(){this._provider&&(this._onSync&&this._provider.off("sync",this._onSync),this._onConnectionClose&&this._provider.off("connection-close",this._onConnectionClose),this._provider.disconnect(),this._provider=null),this._sharedModel=null,this.setStatus(R.Disconnected)}getProvider(){return this._provider}getSharedModel(){return this._sharedModel}handleConnectionClose(e){console.warn("Collaboration connection closed:",e),this.setStatus(R.Disconnected),4002===e.code&&console.warn("Datalayer collaboration session expired")}handleSync(e){this._syncStateChanged.emit(e),e&&this.setStatus(R.Connected)}dispose(){this._isDisposed||(this.disconnect(),this._isDisposed=!0)}}},4662:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(52908),a=r.n(n),o=r(10293),i=r.n(o)()(a());i.push([e.id,'.prc-TreeView-TreeViewRootUlStyles-eZtxW{list-style:none;margin:0;padding:0}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0{outline:none}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0):focus-visible>div,:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0).focus-visible>div{box-shadow:var(--boxShadow-thick,inset 0 0 0 .125rem) var(--fgColor-accent,var(--color-accent-fg))}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0):focus-visible>div,:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0).focus-visible>div{outline:2px solid HighlightText;outline-offset:-2}}[data-has-leading-action]:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0){--has-leading-action:1}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn{--level:1;--toggle-width:1rem;--min-item-height:2rem;border-radius:var(--borderRadius-medium,.375rem);color:var(--fgColor-default,var(--color-fg-default));cursor:pointer;display:grid;font-size:var(--text-body-size-medium,.875rem);grid-template-areas:"spacer leadingAction toggle content";grid-template-columns:var(--spacer-width) var(--leading-action-width) var(--toggle-width) 1fr;position:relative;width:100%;--leading-action-width:calc(var(--has-leading-action, 0)*1.5rem);--spacer-width:calc((var(--level) - 1)*(var(--toggle-width)/2))}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):hover{background-color:var(--control-transparent-bgColor-hover,var(--color-action-list-item-default-hover-bg))}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):hover{outline:2px solid transparent;outline-offset:-2px}}@media (pointer:coarse){.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn{--toggle-width:1.5rem;--min-item-height:2.75rem}}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):has(.prc-TreeView-TreeViewItemSkeleton-fqk59):hover{background-color:transparent;cursor:default}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):has(.prc-TreeView-TreeViewItemSkeleton-fqk59):hover{outline:none}}.prc-TreeView-TreeViewRootUlStyles-eZtxW:where([data-omit-spacer=true]) .prc-TreeView-TreeViewItemContainer--2Rkn{grid-template-columns:0 0 0 1fr}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0[aria-current=true]>.prc-TreeView-TreeViewItemContainer--2Rkn{background-color:var(--control-transparent-bgColor-selected,var(--color-action-list-item-default-selected-bg))}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0[aria-current=true]>.prc-TreeView-TreeViewItemContainer--2Rkn):after{background-color:var(--fgColor-accent,var(--color-accent-fg));border-radius:var(--borderRadius-medium,.375rem);content:"";height:1.5rem;left:calc(var(--base-size-8,.5rem)*-1);position:absolute;top:calc(50% - var(--base-size-12,.75rem));width:.25rem}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0[aria-current=true]>.prc-TreeView-TreeViewItemContainer--2Rkn):after{background-color:HighlightText}}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemToggle-gWUdE{align-items:flex-start;color:var(--fgColor-muted,var(--color-fg-muted));display:flex;grid-area:toggle;height:100%;justify-content:center;padding-top:calc(var(--min-item-height)/2 - var(--base-size-12,.75rem)/2)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemToggleHover-nEgP-:hover{background-color:var(--control-transparent-bgColor-hover,var(--color-action-list-item-default-hover-bg))}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemToggleEnd-t-AEB{border-bottom-left-radius:var(--borderRadius-medium,.375rem);border-top-left-radius:var(--borderRadius-medium,.375rem)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContent-f0r0b{display:flex;gap:var(--stack-gap-condensed,.5rem);grid-area:content;height:100%;line-height:var(--custom-line-height,var(--text-body-lineHeight-medium,1.4285));padding:0 var(--base-size-8,.5rem);padding-bottom:calc((var(--min-item-height) - var(--custom-line-height, 1.3rem))/2);padding-top:calc((var(--min-item-height) - var(--custom-line-height, 1.3rem))/2)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContentText-smZM-{flex:1 1 auto;width:0}.prc-TreeView-TreeViewRootUlStyles-eZtxW:where([data-truncate-text=true]) .prc-TreeView-TreeViewItemContentText-smZM-{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.prc-TreeView-TreeViewRootUlStyles-eZtxW:where([data-truncate-text=false]) .prc-TreeView-TreeViewItemContentText-smZM-{word-break:break-word}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemVisual-dRlGq{align-items:center;color:var(--fgColor-muted,var(--color-fg-muted));display:flex;height:var(--custom-line-height,1.3rem)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLeadingAction-VXx8I{color:var(--fgColor-muted,var(--color-fg-muted));display:flex;grid-area:leadingAction}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLeadingAction-VXx8I)>button{flex-shrink:1}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLevelLine-KPSSL{border-color:var(--borderColor-muted,var(--color-border-muted));border-right:var(--borderWidth-thin,.0625rem) solid;height:100%;width:100%}@media (hover:hover){.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLevelLine-KPSSL{border-color:transparent}.prc-TreeView-TreeViewRootUlStyles-eZtxW:focus-within .prc-TreeView-TreeViewItemLevelLine-KPSSL,.prc-TreeView-TreeViewRootUlStyles-eZtxW:hover .prc-TreeView-TreeViewItemLevelLine-KPSSL{border-color:var(--borderColor-muted,var(--color-border-muted))}}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewDirectoryIcon-PHbeP{color:var(--treeViewItem-leadingVisual-iconColor-rest,var(--color-tree-view-item-directory-fill));display:grid}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewVisuallyHidden-4-mPv{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border-width:0;white-space:nowrap}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0{align-items:center;-moz-column-gap:.5rem;column-gap:.5rem;display:flex;height:2rem}@media (pointer:coarse){.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0{height:2.75rem}}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+1){--tree-item-loading-width:67%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+2){--tree-item-loading-width:47%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+3){--tree-item-loading-width:73%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+4){--tree-item-loading-width:64%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+5){--tree-item-loading-width:50%}.prc-TreeView-TreeItemSkeletonTextStyles-wnBY9{width:var(--tree-item-loading-width,67%)}',""]);const s=i},5700:(e,t,r)=>{r.d(t,{N:()=>l});var n=r(18683),a=r(38621),o=r(98754),i=r(58875),s=r(71791),c=r(84604);function l(e){const{commands:t,model:r}=e;return(0,n.jsxs)(o.A,{className:c.VL,sx:{width:16,position:"relative",marginTop:4,marginLeft:"16px !important","& p":{marginBottom:"0 !important"}},children:[(0,n.jsx)(i.K,{size:"small",color:"secondary","aria-label":"Run cell",title:"Run cell",onClick:e=>{e.preventDefault(),t.execute(s.nx.run).catch(e=>{console.error("Failed to run cell.",e)})},icon:a.udU,variant:"invisible"}),(0,n.jsx)(i.K,{size:"small",color:"secondary","aria-label":"Add code cell above",title:"Add code cell above",onClick:e=>{e.preventDefault(),t.execute(s.nx.insertAbove).catch(e=>{console.error("Failed to insert code cell above.",e)})},icon:a.Mtm,variant:"invisible"}),(0,n.jsx)(i.K,{size:"small",color:"secondary","aria-label":"Add markdown cell above",title:"Add markdown cell above",onClick:e=>{e.preventDefault(),t.execute(s.nx.insertAbove,{cellType:"markdown"}).catch(e=>{console.error("Failed to insert markdown cell above.",e)})},icon:a.Mtm,variant:"invisible"}),"code"===r.type?(0,n.jsx)(i.K,{"aria-label":"Convert to markdow cell",title:"Convert to markdow cell",icon:a.dHM,size:"small",variant:"invisible",onClick:e=>{e.preventDefault(),t.execute(s.nx.changeCellTypeToMarkdown).catch(e=>{console.error("Failed to change cell type to markdown.",e)})}}):(0,n.jsx)(i.K,{"aria-label":"Convert to code cell",title:"Convert to code cell",icon:a.dHM,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),t.execute(s.nx.changeCellTypeToCode).catch(e=>{console.error("Failed to change cell type to code.",e)})}}),(0,n.jsx)(i.K,{size:"small",color:"secondary","aria-label":"Add markdown cell below",title:"Add markdown cell below",onClick:e=>{e.preventDefault(),t.execute(s.nx.insertBelow,{cellType:"markdown"}).catch(e=>{console.error("Failed to insert markdown cell below.",e)})},icon:a.D3D,variant:"invisible"}),(0,n.jsx)(i.K,{size:"small",color:"secondary","aria-label":"Add code cell above",title:"Add code cell above",onClick:e=>{e.preventDefault(),t.execute(s.nx.insertBelow).catch(e=>{console.error("Failed to insert code cell below.",e)})},icon:a.D3D,variant:"invisible"}),(0,n.jsx)(i.K,{size:"small",color:"error","aria-label":"Delete cell",title:"Delete cell",onClick:e=>{e.preventDefault(),t.execute(s.nx.deleteCells).catch(e=>{console.error("Failed to delete cells.",e)})},icon:a.uv5,variant:"invisible"})]})}},6543:(e,t,r)=>{r.d(t,{C:()=>y});var n=r(18683),a=r(9387),o=r(46343),i=r(34447),s=r(98754),c=r(35650),l=r(34429),d=r(70985),u=r(11029),m=r(81089),h=r(87123),p=r(41273),v=r(6417),f=r(26480),w=r(92131),g=r(33872);function y(e){const{children:t,connection:r,podName:y,multiServiceManager:x,disabled:S}=e,{addRuntimeSnapshot:k,runtimesRunUrl:b,runtimeSnapshots:T,setRuntimeSnapshots:C}=(0,w.c6)(),{trackAsyncTask:A}=(0,p.d)(),[V,E]=(0,a.useState)(!1),[I,j]=(0,a.useState)(!1),[_,R]=(0,a.useState)(!1),[z,N]=(0,a.useState)(T[0]?.id??""),[D,L]=(0,a.useState)();(0,a.useEffect)(()=>{(0,v.Ay)().then(e=>{C(e),!z&&e.length>0&&N(e[0].id)}).catch(e=>{console.error(`Failed to fetch remote kernel snapshots; ${e}`)})},[b]);const U=(0,a.useCallback)(()=>{L(void 0),E(!0)},[]),P=(0,a.useCallback)(e=>{N(e.target.value)},[]),$=(0,a.useCallback)(async({id:e,connection:t,podName:r})=>{r?await(0,v.Pk)({id:r,from:e}):t&&await(0,f.j)({connection:t,id:e})},[]),M=(0,a.useCallback)(async()=>{try{let e,t;R(!0);let n="",a="";if(y&&x?.remote)a=(0,g.u)("cloud"),t=x.remote.runtimesManager.snapshot({podName:y,name:a,description:a,stop:!1}),n=y.split("-",2).reverse()[0],t.then(t=>{e=t});else if(r&&x?.browser){const o=r.model;n=o.id,a=(0,g.u)("browser");let i=!0;t=(0,f.T)({connection:x.browser.kernels.connectTo({model:o}),metadata:{filename:`${a}.data`},onUploadProgress:()=>{i&&(i=!1,(0,v.Ay)().then(t=>{e=t.find(e=>e.name===a)}))}})}t&&(A(t,{error:{message:(e,t)=>"Empty snapshot"===e?`Runtime ${n} will not be snapshotted as it does not contain any serializable state.`:`Failed to pause runtime ${n} - ${e}`},pending:{message:`Taking a snapshot of runtime ${n}…`},success:{message:()=>`Runtime ${n} successfully snapshotted as ${a}.`}}),await t,e&&k(e))}finally{R(!1)}},[r,y,x]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.W,{children:[(0,n.jsx)(d.W.Button,{leadingVisual:o.A,variant:"invisible",size:"small",disabled:I||_||S,children:t}),(0,n.jsx)(d.W.Overlay,{children:(0,n.jsxs)(i.l,{children:[(0,n.jsx)(i.l.Item,{onSelect:U,disabled:I||0===T.length,children:"Load a runtime snapshot…"}),(0,n.jsx)(i.l.Item,{onSelect:M,disabled:_,children:"Take a runtime snapshot"})]})})]}),V&&(0,n.jsx)(h.l,{title:(0,n.jsx)("span",{style:{color:"var(--fgColor-default)"},children:"Choose a runtime snapshot to load"}),onClose:()=>{E(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:e=>{e.defaultPrevented||(e.preventDefault(),E(!1))}},{buttonType:"primary",content:I?(0,n.jsx)(l.A,{size:"small"}):"Load",disabled:I,onClick:async e=>{if(!e.defaultPrevented){e.preventDefault(),j(!0);try{L(void 0);const e=T.find(e=>e.id===z);e&&(r||y)?await $({connection:r,id:e.id,podName:y}):L("No runtime snapshot found.")}finally{j(!1),E(!1)}}},autoFocus:!0}],children:(0,n.jsxs)(s.A,{as:"form",children:[(0,n.jsxs)(u.A,{children:[(0,n.jsx)(u.A.Label,{children:"Snapshot"}),(0,n.jsx)(m.A,{name:"snapshot",value:z,onChange:P,block:!0,children:T.map(e=>(0,n.jsx)(m.A.Option,{value:e.id,children:e.name?`${e.name} (${e.id})`:e.id},e.id))})]}),D&&(0,n.jsx)(c.A,{variant:"danger",children:D})]})})]})}y.defaultProps={disabled:!1}},7384:(e,t,r)=>{r.r(t),r.d(t,{createMarkdownParser:()=>l,default:()=>d});var n=r(98238),a=r(63711),o=r(1290),i=r(5279);new n.Token("@jupyterlab/mermaid:IMermaidManager","a manager for rendering mermaid text-based diagrams");const s=new n.Token("@jupyterlab/mermaid:IMermaidMarkdown","a manager for rendering mermaid text-based diagrams in markdown fenced code blocks"),c="```~~~";function l(e,t){return{render:r=>u.render(r,e,t)}}const d={id:"@jupyterlab/markedparser-extension:plugin",description:"Provides the Markdown parser.",autoStart:!0,provides:i.co,requires:[o.SW],optional:[s],activate:(e,t,r)=>l(t,{blocks:r?[r]:[]})};var u;!function(e){let t=null,o=null,i=[],s=null,l={},d=new a.LruCache;async function u(e){if(o)return o;if(t)return await t.promise;i=(null==e?void 0:e.blocks)||[],i=i.sort((e,t)=>{var r,n;return(null!==(r=e.rank)&&void 0!==r?r:1/0)-(null!==(n=t.rank)&&void 0!==n?n:1/0)}),t=new n.PromiseDelegate;const[{marked:a,Renderer:s},c]=await Promise.all([r.e(5846).then(r.bind(r,55846)),m()]);for(const e of c)a.use(e);return l={async:!0,gfm:!0,walkTokens:p,renderer:h(s)},o=a,t.resolve(o),o}async function m(){return Promise.all([(async()=>(await r.e(529).then(r.bind(r,90529))).gfmHeadingId())(),(async()=>(await r.e(9741).then(r.bind(r,59741))).mangle())()])}function h(e){const t=new e,r=t.code;return t.code=({text:e,lang:n,escaped:a})=>{for(const t of i)if(n&&t.languages.includes(n)){const r=t.render(e);if(null!=r)return r}const o=`${n}${c}${e}${c}`,s=d.get(o);return null!=s?s:r.call(t,{text:e,lang:n,escaped:a})},t}async function p(e){if("code"===e.type){if(e.lang)for(const t of i)if(t.languages.includes(e.lang))return void await t.walk(e.text);await async function(e){const{lang:t,text:r}=e;if(!t||!s)return;const n=`${t}${c}${r}${c}`;if(d.get(n))return;const a=document.createElement("div");try{await s.highlight(r,s.findBest(t),a);const e=`<pre><code class="language-${t}">${a.innerHTML}</code></pre>`;d.set(n,e)}catch(e){console.error(`Failed to highlight ${t} code`,e)}finally{a.remove()}}(e)}}e.render=async function(e,t,r){return s=t,o||(o=await u(r)),o(e,l)},e.initializeMarked=u}(u||(u={}))},10069:(e,t,r)=>{r.d(t,{Ks:()=>i});var n=r(97283),a=r(7282);const o=(0,n.y)(e=>({aiAgents:[],addAIAgent:t=>{e(e=>e.aiAgents.includes(t)?{}:{aiAgents:e.aiAgents.concat([t])})},deleteAIAgent:t=>{e(e=>({aiAgents:e.aiAgents.filter(e=>e.documentId===t)}))},updateAIAgent:(t,r)=>{e(e=>{const n=e.aiAgents.findIndex(e=>e.documentId===t);return n>=0?(e.aiAgents[n].runtimeId=r,{aiAgents:[...e.aiAgents]}):{}})}}));function i(e){return(0,a.Pj)(o,e)}},17310:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(9387);const a={small:16,medium:32,large:64};function o({title:e,titleId:t,size:r,...o},i){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 72 72",fill:"currentColor","aria-hidden":"true",ref:i,width:r?"string"==typeof r?a[r]:r:"16px","aria-labelledby":t},o),e?n.createElement("title",{id:t},e):null,n.createElement("circle",{cx:36.146,cy:36.428,r:22.543,fill:"#ea5a47"}),n.createElement("path",{fill:"#d22f27",d:"M52.524 20.931a22.544 22.544 0 01-36.242 26.145A22.542 22.542 0 1052.524 20.93z"}),n.createElement("path",{fill:"#f1b31c",d:"M52.794 22.755c7.674-.926 13.138-.024 14.191 2.849C68.825 30.622 56.51 39.754 39.478 46S7.146 53.242 5.306 48.224c-1.07-2.919 2.647-7.228 9.296-11.552l.076 1.553c-2.509 2.253-3.714 4.341-3.138 5.913 1.434 3.909 13.352 3.133 26.62-1.733S61.02 30.426 59.588 26.517c-.553-1.507-2.665-2.318-5.812-2.466z"}),n.createElement("g",{fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2},n.createElement("path",{d:"M17.156 46.594a21.539 21.539 0 1138.77-18.688M57.677 37.164a21.555 21.555 0 01-34.892 16.164"}),n.createElement("path",{d:"M52.794 22.755c7.674-.926 13.138-.024 14.191 2.849C68.825 30.622 56.51 39.754 39.478 46S7.146 53.242 5.306 48.224c-1.07-2.919 2.647-7.228 9.296-11.552"}),n.createElement("path",{d:"M53.776 24.05c3.147.15 5.259.96 5.811 2.467 1.434 3.91-8.16 11.023-21.428 15.888s-25.185 5.642-26.619 1.733c-.576-1.572.63-3.66 3.138-5.913"})))}const i=n.forwardRef(o)},27446:(e,t,r)=>{r.d(t,{R:()=>s});var n=r(18683),a=r(99180),o=r(38621),i=r(18316);const s=e=>{const{data:t,fileName:r,variant:s,extension:c}=e;return(0,n.jsx)(a.Q,{variant:s,leadingVisual:o.s3U,onClick:e=>(0,i.xD)(t,r,c),children:"Download"})};s.defaultProps={variant:"default",name:"data",extension:"json"}},32916:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(9387);const a={small:16,medium:32,large:64};function o({title:e,titleId:t,size:r,colored:o,...i},s){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:o?"currentColor":["#fff","#fffff","white","#FFF","#FFFFFF"].includes("currentColor")?"white":"currentColor",fillRule:"evenodd",style:{width:r?"string"==typeof r?a[r]:r:"16px",flex:"none",lineHeight:1},viewBox:"0 0 24 24","aria-hidden":"true",ref:s,"aria-labelledby":t},i),e?n.createElement("title",{id:t},e):null,n.createElement("path",{d:"M15.688 2.343a2.588 2.588 0 00-3.61 0l-9.626 9.44a.863.863 0 01-1.203 0 .823.823 0 010-1.18l9.626-9.44a4.313 4.313 0 016.016 0 4.116 4.116 0 011.204 3.54 4.3 4.3 0 013.609 1.18l.05.05a4.115 4.115 0 010 5.9l-8.706 8.537a.274.274 0 000 .393l1.788 1.754a.823.823 0 010 1.18.863.863 0 01-1.203 0l-1.788-1.753a1.92 1.92 0 010-2.754l8.706-8.538a2.47 2.47 0 000-3.54l-.05-.049a2.588 2.588 0 00-3.607-.003l-7.172 7.034-.002.002-.098.097a.863.863 0 01-1.204 0 .823.823 0 010-1.18l7.273-7.133a2.47 2.47 0 00-.003-3.537z"}),n.createElement("path",{d:"M14.485 4.703a.823.823 0 000-1.18.863.863 0 00-1.204 0l-7.119 6.982a4.115 4.115 0 000 5.9 4.314 4.314 0 006.016 0l7.12-6.982a.823.823 0 000-1.18.863.863 0 00-1.204 0l-7.119 6.982a2.588 2.588 0 01-3.61 0 2.47 2.47 0 010-3.54l7.12-6.982z"}))}const i=n.forwardRef(o)},35903:(e,t,r)=>{r.d(t,{Gr:()=>i});var n=r(97283),a=r(7282);const o=(0,n.y)((e,t)=>({datasources:[],updateDatasources:t=>e(e=>({datasources:t}))}));function i(e){return(0,a.Pj)(o,e)}},45077:(e,t,r)=>{r.d(t,{O:()=>a});var n=r(18683);const a=e=>{const{code:t}=e;return(0,n.jsx)("pre",{style:{fontSize:"12px",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:t})}},56944:(e,t,r)=>{r.d(t,{w:()=>i});var n=r(63711),a=r(9570),o=r(76199);const i=(e="api/ai-agents/v1")=>{const{configuration:t}=(0,a._O)(),{requestDatalayer:r}=(0,o.F)({notifyOnError:!1});return{createAIAgent:(a,o,i,s,c,{signal:l,baseUrl:d=e}={})=>r({url:n.URLExt.join(t.aiagentsRunUrl,d,"agents"),method:"POST",body:{document_id:a,document_type:o,runtime:{ingress:i,token:s,kernel_id:c}},signal:l}),getAIAgents:({signal:a,baseUrl:o=e}={})=>r({url:n.URLExt.join(t.aiagentsRunUrl,o,"agents"),method:"GET",signal:a}),deleteAIAgent:(a,{signal:o,baseUrl:i=e}={})=>r({url:n.URLExt.join(t.aiagentsRunUrl,i,"agents",a),method:"DELETE",signal:o}),getAIAgent:(a,{signal:o,baseUrl:i=e}={})=>r({url:n.URLExt.join(t.aiagentsRunUrl,i,"agents",a),method:"GET",signal:o}),patchAIAgent:(a,o,i,s,{signal:c,baseUrl:l=e}={})=>r({url:n.URLExt.join(t.aiagentsRunUrl,l,"agents",a),method:"PATCH",body:{runtime:o&&i&&s?{ingress:o,token:i,kernel_id:s}:null},signal:c})}}},66210:(e,t,r)=>{r.d(t,{G:()=>i});var n=r(9387),a=r(10069),o=r(56944);function i(e){const{getAIAgent:t}=(0,o.w)(),{aiAgents:r,addAIAgent:i,deleteAIAgent:s,updateAIAgent:c}=(0,a.Ks)();return(0,n.useEffect)(()=>{let n;const a=setInterval(async()=>{n=new AbortController;try{const a=await t(e,{signal:n.signal});if(!a.success)return void s(e);const o=r.find(t=>t.documentId===e),l=a.agent.runtime?.id;o?o.runtimeId!==l&&c(e,l):i({documentId:e,runtimeId:l})}catch(t){s(e)}},6e4);return()=>{n?.abort("Component unmounted"),clearInterval(a)}},[r,e]),r.find(t=>t.documentId===e)}},68652:(e,t,r)=>{r.d(t,{XV:()=>fe});var n=r(18683),a=r(9387),o=r(63711),i=r(98238),s=r(81461),c=r(58875),l=r(34429),d=r(87319),u=r(38621),m=r(34164),h=r(46186),p=r.n(h),v=r(4662);p()(v.A,{insert:"head",singleton:!1}),v.A.locals;var f="prc-TreeView-TreeViewItemVisual-dRlGq",w="prc-TreeView-TreeViewVisuallyHidden-4-mPv",g=r(17781),y=r(58449),x=r(41896),S=r(92209),k=r(27432);function b(e){var t,r,n;const a=e.getAttribute("aria-label"),o=e.getAttribute("aria-labelledby");return a||(o?null!==(t=null===(r=document.getElementById(o))||void 0===r?void 0:r.textContent)&&void 0!==t?t:"":null!==(n=e.textContent)&&void 0!==n?n:"")}var T=r(27907);function C(e){return e&&e!==document.body?function(e){return e.scrollHeight>e.clientHeight&&!(-1!==window.getComputedStyle(e).overflowY.indexOf("hidden"))}(e)?e:C(e.parentElement):null}var A=r(80292);function V(e,t,r){var n;if(t instanceof HTMLElement){try{if(t.closest("dialog:modal"))return}catch{}return null!==(n=function(e,t){switch(`${function(e){if("treeitem"!==e.getAttribute("role"))throw new Error("Element is not a treeitem");switch(e.getAttribute("aria-expanded")){case"true":return"open";case"false":return"closed";default:return"end"}}(e)} ${t.key}`){case"open ArrowRight":return I(e);case"open ArrowLeft":case"closed ArrowRight":case"end ArrowRight":return;case"closed ArrowLeft":case"end ArrowLeft":return j(e)}switch(t.key){case"ArrowUp":return E(e,"previous");case"ArrowDown":return E(e,"next");case"Backspace":return j(e);case"Home":return function(e){const t=e.closest("[role=tree]"),r=null==t?void 0:t.querySelector("[role=treeitem]");return r instanceof HTMLElement?r:void 0}(e);case"End":return function(e){const t=e.closest("[role=tree]"),r=Array.from((null==t?void 0:t.querySelectorAll("[role=treeitem]"))||[]);if(0===r.length)return;let n=r.length-1,a=r[n];for(;n>0&&a instanceof HTMLElement&&null!==(o=a.parentElement)&&void 0!==o&&o.closest("[role=treeitem][aria-expanded=false]");){var o;n-=1,a=r[n]}return a instanceof HTMLElement?a:void 0}(e);case"PageUp":return function(e){const t=e.closest('[role="tree"]');if(!t)return;const r=Array.from(t.querySelectorAll('[role="treeitem"]'));if(0===r.length)return;const n=R(t,r[0].firstElementChild),a=Math.floor(r.indexOf(e)/n),o=r.indexOf(e)-n*a;return r[Math.max(0,(a-1)*n+o)]}(e);case"PageDown":return function(e){const t=e.closest('[role="tree"]');if(!t)return;const r=Array.from(t.querySelectorAll('[role="treeitem"]'));if(0===r.length)return;const n=R(t,r[0].firstElementChild),a=Math.floor(r.indexOf(e)/n),o=r.indexOf(e)-n*a;return r[Math.min(r.length-1,(a+1)*n+o)]}(e)}}(t,r))&&void 0!==n?n:t}}function E(e,t){const r=e.closest("[role=tree]");if(!r)return;const n=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,e=>e instanceof HTMLElement&&"treeitem"===e.getAttribute("role")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP);let a=n.firstChild();for(;a!==e;)a=n.nextNode();let o="next"===t?n.nextNode():n.previousNode();for(;o instanceof HTMLElement&&null!==(i=o.parentElement)&&void 0!==i&&i.closest("[role=treeitem][aria-expanded=false]");){var i;o="next"===t?n.nextNode():n.previousNode()}return o instanceof HTMLElement?o:void 0}function I(e){const t=e.querySelector("[role=treeitem]");return t instanceof HTMLElement?t:void 0}function j(e){const t=e.closest("[role=group]"),r=null==t?void 0:t.closest("[role=treeitem]");return r instanceof HTMLElement?r:void 0}const _={height:32};function R(e,t){var r,n;const a=C(e),{height:o}=null!==(r=null==t?void 0:t.getBoundingClientRect())&&void 0!==r?r:_,i=null!==(n=null==a?void 0:a.clientHeight)&&void 0!==n?n:window.innerHeight;return Math.floor(i/o)}function z(e){return e===document.activeElement}var N=r(72533),D=r(74306),L=r(49740);const U=a.createContext({announceUpdate:()=>{},expandedStateCache:{current:new Map}}),P=a.createContext({itemId:"",level:1,isSubTreeEmpty:!1,setIsSubTreeEmpty:()=>{},isExpanded:!1,setIsExpanded:()=>{},leadingVisualId:"",trailingVisualId:""}),$=e=>{const t=(0,d.c)(23),{"aria-label":r,"aria-labelledby":o,children:i,flat:s,truncate:c,className:l,style:u}=e,h=void 0===c||c,p=a.useRef(null),v=a.useRef(!1),[f,w]=a.useState("");let g;t[0]===Symbol.for("react.memo_cache_sentinel")?(g=e=>{w(e)},t[0]=g):g=t[0];const x=g;let k;t[1]===Symbol.for("react.memo_cache_sentinel")?(k=()=>{v.current=!0},t[1]=k):k=t[1];const C=k;let E,I,j,_;t[2]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{const e=function(){v.current=!1};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}},I=[],t[2]=E,t[3]=I):(E=t[2],I=t[3]),(0,a.useEffect)(E,I),t[4]===Symbol.for("react.memo_cache_sentinel")?(j={containerRef:p,mouseDownRef:v},t[4]=j):j=t[4],function(e){const t=(0,d.c)(6),{containerRef:r,mouseDownRef:n}=e;let a,o;t[0]!==r||t[1]!==n?(a=()=>{var e,t,a;if(n.current)return;const o=null===(e=r.current)||void 0===e?void 0:e.querySelector("[aria-current]"),i=null===(t=r.current)||void 0===t?void 0:t.querySelector('[role="treeitem"]');return o instanceof HTMLElement?o:document.activeElement instanceof HTMLElement&&null!==(a=r.current)&&void 0!==a&&a.contains(document.activeElement)&&"treeitem"===document.activeElement.getAttribute("role")?document.activeElement:i instanceof HTMLElement?i:void 0},t[0]=r,t[1]=n,t[2]=a):a=t[2],t[3]!==r||t[4]!==a?(o={containerRef:r,bindKeys:A.z0.ArrowVertical|A.z0.ArrowHorizontal|A.z0.HomeAndEnd|A.z0.Backspace|A.z0.PageUpDown,preventScroll:!0,getNextFocusable:V,focusInStrategy:a},t[3]=r,t[4]=a,t[5]=o):o=t[5],(0,T.G)(o)}(j),t[5]===Symbol.for("react.memo_cache_sentinel")?(_={containerRef:p,onFocusChange:Q},t[5]=_):_=t[5],function(e){const t=(0,d.c)(11),{containerRef:r,onFocusChange:n}=e,o=a.useRef(""),i=a.useRef(0),s=a.useRef(n),{safeSetTimeout:c,safeClearTimeout:l}=(0,S.A)();let u,m,h;t[0]!==n?(u=()=>{s.current=n},m=[n],t[0]=n,t[1]=u,t[2]=m):(u=t[1],m=t[2]),a.useEffect(u,m),t[3]!==r?(h=e=>{if(!e)return;if(!r.current)return;const t=r.current,n=Array.from(t.querySelectorAll('[role="treeitem"]')),a=n.findIndex(z);let o=(c=a,(i=n).map((e,t)=>i[(c+t)%i.length]));var i,c;1===e.length&&(o=o.slice(1));const l=o.find(t=>b(t).toLowerCase().startsWith(e.toLowerCase()));l&&s.current(l)},t[3]=r,t[4]=h):h=t[4];const p=h;let v,f;t[5]!==r||t[6]!==p||t[7]!==l||t[8]!==c?(v=()=>{if(!r.current)return;const e=r.current,t=function(e){!e.key||e.key.length>1||" "===e.key||e.ctrlKey||e.altKey||e.metaKey||(o.current=o.current+e.key,p(o.current),l(i.current),i.current=c(()=>o.current="",300),e.preventDefault(),e.stopPropagation())};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)},f=[r,p,l,c],t[5]=r,t[6]=p,t[7]=l,t[8]=c,t[9]=v,t[10]=f):(v=t[9],f=t[10]),a.useEffect(v,f)}(_);const R=a.useRef(null);if(null===R.current){let e;t[6]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,t[6]=e):e=t[6],R.current=e}let N,D;t[7]===Symbol.for("react.memo_cache_sentinel")?(N={announceUpdate:x,expandedStateCache:R},t[7]=N):N=t[7],t[8]!==f?(D=(0,n.jsx)(y.A,{role:"status","aria-live":"polite","aria-atomic":"true",children:f}),t[8]=f,t[9]=D):D=t[9];const L=h||!1;let P,$,M;return t[10]!==l?(P=(0,m.$)(l,"prc-TreeView-TreeViewRootUlStyles-eZtxW"),t[10]=l,t[11]=P):P=t[11],t[12]!==r||t[13]!==o||t[14]!==i||t[15]!==s||t[16]!==u||t[17]!==L||t[18]!==P?($=(0,n.jsx)("ul",{ref:p,role:"tree","aria-label":r,"aria-labelledby":o,"data-omit-spacer":s,"data-truncate-text":L,onMouseDown:C,className:P,style:u,children:i}),t[12]=r,t[13]=o,t[14]=i,t[15]=s,t[16]=u,t[17]=L,t[18]=P,t[19]=$):$=t[19],t[20]!==$||t[21]!==D?(M=(0,n.jsx)(U.Provider,{value:N,children:(0,n.jsxs)(n.Fragment,{children:[D,$]})}),t[20]=$,t[21]=D,t[22]=M):M=t[22],M};$.displayName="TreeView";const M=a.forwardRef(({id:e,containIntrinsicSize:t,current:r=!1,defaultExpanded:o,expanded:i,onExpandedChange:s,onSelect:c,children:l,className:h,"aria-label":p,"aria-labelledby":v},f)=>{const[w,g]=(0,k.H)(l,{leadingAction:J,leadingVisual:q,trailingVisual:G}),{expandedStateCache:y}=a.useContext(U),S=(0,x.B)(),b=(0,x.B)(),T=(0,x.B)(),[C,A]=function({name:e="custom",defaultValue:t,value:r,onChange:n}){const[o,i]=a.useState(null!=r?r:t),s=a.useRef(null),c=a.useRef(n);a.useEffect(()=>{c.current=n}),null===s.current&&(s.current=void 0!==r);const l=a.useCallback(e=>{var t;const r="function"==typeof e?e(o):e;!1===s.current&&i(r),null===(t=c.current)||void 0===t||t.call(c,r)},[o]);return a.useEffect(()=>{s.current,s.current},[e,r]),!0===s.current?[r,l]:[o,l]}({name:e,defaultValue:()=>{var t,n,a;return null!==(t=null!==(n=null===(a=y.current)||void 0===a?void 0:a.get(e))&&void 0!==n?n:o)&&void 0!==t?t:r},value:null!==i&&i,onChange:s}),{level:V}=a.useContext(P),{hasSubTree:E,subTree:I,childrenWithoutSubTree:j}=function(e){const t=(0,d.c)(8);let r,n;t[0]!==e?(n=a.Children.toArray(e).find(Z),t[0]=e,t[1]=n):n=t[1];const o=n;let i;t[2]!==e?(i=a.Children.toArray(e).filter(K),t[2]=e,t[3]=i):i=t[3];const s=i,c=Boolean(o);let l;return t[4]!==s||t[5]!==o||t[6]!==c?(l={subTree:o,childrenWithoutSubTree:s,hasSubTree:c},t[4]=s,t[5]=o,t[6]=c,t[7]=l):l=t[7],r=l,r}(g),[_,R]=a.useState(!E),[z,N]=a.useState(!1),D=a.useCallback(t=>{var r;A(t),null===(r=y.current)||void 0===r||r.set(e,t)},[e,A,y]),L=a.useCallback(e=>{D(!C),null==e||e.stopPropagation()},[C,D]),$=a.useCallback(e=>{switch(e.key){case"Enter":case" ":c?c(e):L(e),e.stopPropagation();break;case"ArrowRight":if(e.altKey||e.metaKey)return;e.preventDefault(),e.stopPropagation(),D(!0);break;case"ArrowLeft":if(e.altKey||e.metaKey)return;e.preventDefault(),e.stopPropagation(),D(!1)}},[c,D,L]),M=[w.leadingVisual?b:null,w.trailingVisual?T:null].filter(Boolean);return(0,n.jsx)(P.Provider,{value:{itemId:e,level:V+1,isSubTreeEmpty:_,setIsSubTreeEmpty:R,isExpanded:C,setIsExpanded:D,leadingVisualId:b,trailingVisualId:T},children:(0,n.jsxs)("li",{className:(0,m.$)("PRIVATE_TreeView-item",h,"prc-TreeView-TreeViewItem-ShJr0"),ref:f,tabIndex:0,id:e,role:"treeitem","aria-label":p,"aria-labelledby":p?void 0:v||S,"aria-describedby":M.length?M.join(" "):void 0,"aria-level":V,"aria-expanded":(!_||C&&E)&&null!==i?C:void 0,"aria-current":r?"true":void 0,"aria-selected":z?"true":"false","data-has-leading-action":!!w.leadingAction||void 0,onKeyDown:$,onFocus:e=>{var t;null===(t=e.currentTarget.firstElementChild)||void 0===t||t.scrollIntoView({block:"nearest",inline:"nearest"}),N(!0),e.stopPropagation()},onBlur:()=>N(!1),onClick:e=>{c?c(e):L(e),e.stopPropagation()},onAuxClick:e=>{c&&1===e.button&&c(e),e.stopPropagation()},children:[(0,n.jsxs)("div",{className:(0,m.$)("PRIVATE_TreeView-item-container","prc-TreeView-TreeViewItemContainer--2Rkn"),style:{"--level":V,contentVisibility:t?"auto":void 0,containIntrinsicSize:t},children:[(0,n.jsx)("div",{style:{gridArea:"spacer",display:"flex"},children:(0,n.jsx)(F,{level:V})}),w.leadingAction,E?(0,n.jsx)("div",{className:(0,m.$)("PRIVATE_TreeView-item-toggle",c&&"PRIVATE_TreeView-item-toggle--hover",1===V&&"PRIVATE_TreeView-item-toggle--end","prc-TreeView-TreeViewItemToggle-gWUdE","prc-TreeView-TreeViewItemToggleHover-nEgP-","prc-TreeView-TreeViewItemToggleEnd-t-AEB"),onClick:e=>{c&&L(e)},children:C?(0,n.jsx)(u.D3D,{size:12}):(0,n.jsx)(u.vKP,{size:12})}):null,(0,n.jsxs)("div",{id:S,className:(0,m.$)("PRIVATE_TreeView-item-content","prc-TreeView-TreeViewItemContent-f0r0b"),children:[w.leadingVisual,(0,n.jsx)("span",{className:(0,m.$)("PRIVATE_TreeView-item-content-text","prc-TreeView-TreeViewItemContentText-smZM-"),children:j}),w.trailingVisual]})]}),I]})})}),F=e=>{const t=(0,d.c)(3),{level:r}=e;let a,o;return t[0]===Symbol.for("react.memo_cache_sentinel")?(a={width:"100%",display:"flex"},t[0]=a):a=t[0],t[1]!==r?(o=(0,n.jsx)("div",{style:a,children:Array.from({length:r-1}).map(ee)}),t[1]=r,t[2]=o):o=t[2],o};M.displayName="TreeView.Item";const B=e=>{const t=(0,d.c)(29),{count:r,state:o,children:i,"aria-label":s}=e,{announceUpdate:c}=a.useContext(U),{itemId:l,isExpanded:u,isSubTreeEmpty:m,setIsSubTreeEmpty:h}=a.useContext(P),p=a.useRef(null),v=a.useRef(null),[f,w]=a.useState(!1),[g,y]=a.useState(""),x=function(e){const t=a.useRef(e);return a.useEffect(()=>{t.current=e},[e]),t.current}(o),{safeSetTimeout:k}=(0,S.A)();let T,C,A,V,E,j,_;if(t[0]!==i||t[1]!==m||t[2]!==h||t[3]!==o?(T=()=>{void 0!==o&&"done"!==o||(m||i?m&&i&&h(!1):h(!0))},C=[o,m,h,i],t[0]=i,t[1]=m,t[2]=h,t[3]=o,t[4]=T,t[5]=C):(T=t[4],C=t[5]),a.useEffect(T,C),t[6]!==c||t[7]!==l||t[8]!==f||t[9]!==x||t[10]!==k||t[11]!==o?(A=()=>{const e=document.getElementById(l);if(e)if(y(b(e)),"loading"===x&&"done"===o){var t;const r=b(e);if(null!==(t=v.current)&&void 0!==t&&t.childElementCount?c(`${r} content loaded`):c(`${r} is empty`),f){const t=I(e);k(t?()=>{t.focus()}:()=>{e.focus()}),w(!1)}}else if("loading"===o){const t=b(e);c(`${t} content loading`)}},V=[f,x,o,l,c,v,k],t[6]=c,t[7]=l,t[8]=f,t[9]=x,t[10]=k,t[11]=o,t[12]=A,t[13]=V):(A=t[12],V=t[13]),a.useEffect(A,V),t[14]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{const e=function(){w(!0)},t=function(e){e.relatedTarget&&w(!1)},r=p.current;if(r)return r.addEventListener("focus",e),r.addEventListener("blur",t),()=>{r.removeEventListener("focus",e),r.removeEventListener("blur",t)}},t[14]=E):E=t[14],t[15]!==o?(j=[p,o],t[15]=o,t[16]=j):j=t[16],a.useEffect(E,j),!u)return null;t[17]===Symbol.for("react.memo_cache_sentinel")?(_={listStyle:"none",padding:0,margin:0},t[17]=_):_=t[17];const R=s||g;let z,N,D;return t[18]!==i||t[19]!==r||t[20]!==o?(z="loading"===o?(0,n.jsx)(W,{ref:p,count:r}):i,t[18]=i,t[19]=r,t[20]=o,t[21]=z):z=t[21],t[22]!==m||t[23]!==o?(N=m&&"loading"!==o?(0,n.jsx)(O,{}):null,t[22]=m,t[23]=o,t[24]=N):N=t[24],t[25]!==N||t[26]!==R||t[27]!==z?(D=(0,n.jsxs)("ul",{role:"group",style:_,ref:v,"aria-label":R,children:[z,N]}),t[25]=N,t[26]=R,t[27]=z,t[28]=D):D=t[28],D};B.displayName="TreeView.SubTree";const H=()=>{const e=(0,d.c)(1);let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,n.jsxs)("span",{className:(0,m.$)("prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0","prc-TreeView-TreeViewItemSkeleton-fqk59","PRIVATE_TreeView-item-skeleton"),children:[(0,n.jsx)(D.N,{size:16,square:!0}),(0,n.jsx)(L.r,{className:"prc-TreeView-TreeItemSkeletonTextStyles-wnBY9"})]}),e[0]=t):t=e[0],t},W=a.forwardRef((e,t)=>{const r=(0,d.c)(15),{count:a}=e,o=(0,x.B)();if(a){let e,i,s,c;return r[0]!==a?(e=Array.from({length:a}).map(te),r[0]=a,r[1]=e):e=r[1],r[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,m.$)("PRIVATE_VisuallyHidden",w),r[2]=i):i=r[2],r[3]!==a?(s=(0,n.jsxs)("div",{className:i,children:["Loading ",a," items"]}),r[3]=a,r[4]=s):s=r[4],r[5]!==o||r[6]!==t||r[7]!==e||r[8]!==s?(c=(0,n.jsxs)(M,{id:o,ref:t,children:[e,s]}),r[5]=o,r[6]=t,r[7]=e,r[8]=s,r[9]=c):c=r[9],c}let i,s,c;return r[10]===Symbol.for("react.memo_cache_sentinel")?(i=(0,n.jsx)(q,{children:(0,n.jsx)(l.A,{size:"small"})}),s=(0,n.jsx)(N.A,{className:"fgColor-muted",children:"Loading..."}),r[10]=i,r[11]=s):(i=r[10],s=r[11]),r[12]!==o||r[13]!==t?(c=(0,n.jsxs)(M,{id:o,ref:t,children:[i,s]}),r[12]=o,r[13]=t,r[14]=c):c=r[14],c}),O=a.forwardRef((e,t)=>{const r=(0,d.c)(4),a=(0,x.B)();let o,i;return r[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,n.jsx)(N.A,{className:"fgColor-muted",children:"No items found"}),r[0]=o):o=r[0],r[1]!==t||r[2]!==a?(i=(0,n.jsx)(M,{expanded:null,id:a,ref:t,children:o}),r[1]=t,r[2]=a,r[3]=i):i=r[3],i});function K(e){return!(a.isValidElement(e)&&e.type===B)}function Z(e){return a.isValidElement(e)&&e.type===B}const q=e=>{const t=(0,d.c)(13),{isExpanded:r,leadingVisualId:o}=a.useContext(P);let i;t[0]!==r||t[1]!==e.children?(i="function"==typeof e.children?e.children({isExpanded:r}):e.children,t[0]=r,t[1]=e.children,t[2]=i):i=t[2];const s=i;let c,l,u,h,p;return t[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,m.$)("PRIVATE_VisuallyHidden",w),t[3]=c):c=t[3],t[4]!==o||t[5]!==e.label?(l=(0,n.jsx)("div",{className:c,"aria-hidden":!0,id:o,children:e.label}),t[4]=o,t[5]=e.label,t[6]=l):l=t[6],t[7]===Symbol.for("react.memo_cache_sentinel")?(u=(0,m.$)("PRIVATE_TreeView-item-visual",f),t[7]=u):u=t[7],t[8]!==s?(h=(0,n.jsx)("div",{className:u,"aria-hidden":!0,children:s}),t[8]=s,t[9]=h):h=t[9],t[10]!==l||t[11]!==h?(p=(0,n.jsxs)(n.Fragment,{children:[l,h]}),t[10]=l,t[11]=h,t[12]=p):p=t[12],p};q.displayName="TreeView.LeadingVisual";const G=e=>{const t=(0,d.c)(13),{isExpanded:r,trailingVisualId:o}=a.useContext(P);let i;t[0]!==r||t[1]!==e.children?(i="function"==typeof e.children?e.children({isExpanded:r}):e.children,t[0]=r,t[1]=e.children,t[2]=i):i=t[2];const s=i;let c,l,u,h,p;return t[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,m.$)("PRIVATE_VisuallyHidden",w),t[3]=c):c=t[3],t[4]!==e.label||t[5]!==o?(l=(0,n.jsx)("div",{className:c,"aria-hidden":!0,id:o,children:e.label}),t[4]=e.label,t[5]=o,t[6]=l):l=t[6],t[7]===Symbol.for("react.memo_cache_sentinel")?(u=(0,m.$)("PRIVATE_TreeView-item-visual",f),t[7]=u):u=t[7],t[8]!==s?(h=(0,n.jsx)("div",{className:u,"aria-hidden":!0,children:s}),t[8]=s,t[9]=h):h=t[9],t[10]!==l||t[11]!==h?(p=(0,n.jsxs)(n.Fragment,{children:[l,h]}),t[10]=l,t[11]=h,t[12]=p):p=t[12],p};G.displayName="TreeView.TrailingVisual";const J=e=>{const t=(0,d.c)(12),{isExpanded:r}=a.useContext(P);let o;t[0]!==r||t[1]!==e.children?(o="function"==typeof e.children?e.children({isExpanded:r}):e.children,t[0]=r,t[1]=e.children,t[2]=o):o=t[2];const i=o;let s,c,l,u,h;return t[3]===Symbol.for("react.memo_cache_sentinel")?(s=(0,m.$)("PRIVATE_VisuallyHidden",w),t[3]=s):s=t[3],t[4]!==e.label?(c=(0,n.jsx)("div",{className:s,"aria-hidden":!0,children:e.label}),t[4]=e.label,t[5]=c):c=t[5],t[6]===Symbol.for("react.memo_cache_sentinel")?(l=(0,m.$)("PRIVATE_TreeView-item-leading-action","prc-TreeView-TreeViewItemLeadingAction-VXx8I"),t[6]=l):l=t[6],t[7]!==i?(u=(0,n.jsx)("div",{className:l,"aria-hidden":!0,children:i}),t[7]=i,t[8]=u):u=t[8],t[9]!==c||t[10]!==u?(h=(0,n.jsxs)(n.Fragment,{children:[c,u]}),t[9]=c,t[10]=u,t[11]=h):h=t[11],h};J.displayName="TreeView.LeadingAction";const X=e=>{const t=(0,d.c)(9),{title:r,children:o,onRetry:i,onDismiss:s}=e,c=void 0===r?"Error":r,{itemId:l,setIsExpanded:u}=a.useContext(P);let m,h;return t[0]!==l||t[1]!==s||t[2]!==i||t[3]!==u?(m=e=>{setTimeout(()=>{const e=document.getElementById(l);null==e||e.focus()}),"confirm"===e?null==i||i():(u(!1),null==s||s())},t[0]=l,t[1]=s,t[2]=i,t[3]=u,t[4]=m):m=t[4],t[5]!==o||t[6]!==m||t[7]!==c?(h=(0,n.jsx)("div",{onKeyDown:re,children:(0,n.jsx)(g.K,{title:c,onClose:m,confirmButtonContent:"Retry",cancelButtonContent:"Dismiss",children:o})}),t[5]=o,t[6]=m,t[7]=c,t[8]=h):h=t[8],h};X.displayName="TreeView.ErrorDialog";const Y=Object.assign($,{Item:M,SubTree:B,LeadingAction:J,LeadingVisual:q,TrailingVisual:G,DirectoryIcon:()=>{const e=(0,d.c)(3),{isExpanded:t}=a.useContext(P),r=t?u.OpE:u.mL$;let o,i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,m.$)("PRIVATE_TreeView-directory-icon","prc-TreeView-TreeViewDirectoryIcon-PHbeP"),e[0]=o):o=e[0],e[1]!==r?(i=(0,n.jsx)("div",{className:o,children:(0,n.jsx)(r,{})}),e[1]=r,e[2]=i):i=e[2],i},ErrorDialog:X});function Q(e){e instanceof HTMLElement&&e.focus()}function ee(e,t){return(0,n.jsx)("div",{className:(0,m.$)("PRIVATE_TreeView-item-level-line","prc-TreeView-TreeViewItemLevelLine-KPSSL")},t)}function te(e,t){return(0,n.jsx)(H,{"aria-hidden":!0},t)}function re(e){["Backspace","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Enter"].includes(e.key)&&e.stopPropagation()}ee.displayName="_temp2",te.displayName="_temp3";var ne=r(70985),ae=r(34447),oe=r(52982),ie=r(87123),se=r(2067),ce=r(48461),le=r(55285),de=r(41273),ue=r(80258);function me(e,t){let r=e.map(e=>({...e,fileType:t?.getFileTypeForModel(e)}));return r=r.filter(e=>!e.name.startsWith(".")),r.sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name)),r}function he(e){const{item:t,contents:r,current:o,documentRegistry:i,onContextMenu:s,onSelect:c}=e,l=(0,a.useRef)(null),[d,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(!1),p=(0,a.useCallback)(()=>{h(!0),r.get(t.path).then(e=>{h(!1),u(me(e.content,i))}).catch(()=>{h(!1)})},[r,t,i]),v=(0,a.useCallback)(async e=>{null===d&&e&&p()},[d,t,r]);return(0,n.jsxs)(Y.Item,{ref:l,id:`${t.type}-${t.name}`,onExpandedChange:v,onSelect:()=>{c(t,p)},current:t.path===o?.path,children:[(0,n.jsx)(Y.LeadingVisual,{children:(0,n.jsx)(Y.DirectoryIcon,{})}),(0,n.jsx)("span",{onContextMenu:e=>{e.preventDefault(),o?.path!==t.path&&c(t,p),s(l)},children:t.name}),(0,n.jsx)(Y.SubTree,{state:m?"loading":(d?.length??-1)>=0?"done":"initial",children:d?.map(e=>"directory"===e.type?(0,n.jsx)(he,{item:e,contents:r,current:o,documentRegistry:i,onContextMenu:s,onSelect:c},e.name):(0,n.jsx)(pe,{item:e,current:e.path===o?.path,onSelect:e=>c(e,p),onContextMenu:s},e.name))})]})}function pe(e){const{item:t,current:r,onSelect:o,onContextMenu:i}=e,s=(0,a.useRef)(null),c=t.fileType?.icon;return(0,n.jsxs)(Y.Item,{ref:s,id:`${t.type}-${t.name}`,current:r,onSelect:()=>{o(t)},children:[(0,n.jsx)(Y.LeadingVisual,{children:c?(0,n.jsx)(c.react,{tag:"span"}):(0,n.jsx)(u.oSV,{})}),(0,n.jsx)("span",{onContextMenu:e=>{e.preventDefault(),r||o(t),i(s)},children:t.name})]},t.name)}const ve=1048576;function fe(e){const{contents:t,localContents:r,documentRegistry:d}=e,u=(0,le.aq)(),{trackAsyncTask:m}=(0,de.d)(),[h,p]=(0,a.useState)(null),[v,f]=(0,a.useState)(!0),[w,g]=(0,a.useState)(null),[y,x]=(0,a.useState)(null),[S,k]=(0,a.useState)(!1),[b,T]=(0,a.useState)(!1),C=(0,a.useCallback)(()=>{t.get("").then(e=>{f(!1),p(me(e.content,d))}).catch(e=>{f(!1),console.error(`Failed to fetch folder '' content for manager ${t.serverSettings.appUrl}.`,e)})},[t]);(0,a.useEffect)(()=>{C()},[C]);const A=(0,a.useCallback)(async e=>{const r=()=>{if(!u())return Promise.reject(`Failed to upload ${e.name}; StorageBrowser component is unmounted.`)};r();const n=e.size>ve,a=w?"directory"===w.type?w.path:o.PathExt.dirname(w.path):"",s=a?o.PathExt.join(a,e.name):e.name,c=e.name,l=async(n,a)=>{r();const o=new FileReader;o.readAsDataURL(n),await new Promise((t,r)=>{o.onload=t,o.onerror=t=>r(`Failed to upload "${e.name}":`+t)}),r();const i=o.result.split(",")[1],l={type:"file",format:"base64",name:c,chunk:a,content:i};return await t.save(s,l)},d={error:{message:t=>{const r=`Failed to upload ${e.name}.`;return console.error(r,t),r}},pending:{message:`Uploading ${e.name}…`},success:{message:()=>`${e.name} uploaded.`}};if(!n){const t=l(e);return m(t,d),t.then(()=>{w?w.refresh():C()}),t}{const t=new i.PromiseDelegate;m(t.promise,d);try{let r;for(let n=0;!r;n+=ve){const a=n+ve,o=a>=e.size,i=o?-1:a/ve,s=await l(e.slice(n,a),i);o&&(r=s,t.resolve(r))}return w?w.refresh():C(),r}catch(e){throw t.reject(e),e}}},[t,w,C]),V=(0,a.useCallback)(e=>{x(y===e?null:e)},[y]),E=(0,a.useCallback)(()=>{k(!0)},[]),I=(0,a.useCallback)(()=>{if(w){const e=t.delete(w.path);m(e,{success:{message:()=>`${w.path} deleted.`},pending:{message:`Deleting ${w.path}…`},error:{message:e=>{const t=`Failed to delete ${w.path}.`;return console.error(t,e),t}}}),e.finally(()=>{w.refresh()})}k(!1)},[t,w]),j=(0,a.useCallback)(()=>{T(!0)},[]),_=(0,a.useCallback)(()=>{w&&r&&t.get(w.path).then(e=>{const t=r?.save(e.path,e);m(t,{success:{message:()=>`${w.path} copied to local.`},pending:{message:`Copying to local ${w.path}…`},error:{message:e=>{const t=`Failed to copy to local ${w.path}.`;return console.error(t,e),t}}}),t.finally(()=>{w.refresh()}),T(!1)})},[r,w]),R=(0,a.useCallback)((e,t)=>{g(e.path===w?.path?null:{...e,refresh:t})},[w]);return(0,n.jsxs)(oe.az,{sx:{display:"grid",gridTemplateAreas:'"header" "content"'},children:[(0,n.jsxs)(oe.az,{sx:{gridArea:"header",display:"flex",alignItems:"center"},children:[(0,n.jsx)(s.A,{as:"h4",sx:{fontSize:"var(--text-title-size-small)",lineHeight:"var(--text-title-lineHeight-medium)",fontWeight:"var(--text-title-weight-medium)",flex:"1 1 auto"},children:"Contents Browser"}),(0,n.jsxs)(oe.az,{children:[(0,n.jsx)(c.K,{variant:"invisible","aria-label":"Refresh contents browser.",title:"Refresh contents browser.",icon:ce.A,onClick:C}),(0,n.jsx)(ue.HF,{label:"Upload a file",multiple:!0,upload:A})]})]}),v?(0,n.jsx)(oe.az,{sx:{gridArea:"content",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40px",height:"100vh"},children:(0,n.jsx)(l.A,{})}):(0,n.jsx)(oe.az,{sx:{gridArea:"content"},children:h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Y,{children:h?.map(e=>"directory"===e.type?(0,n.jsx)(he,{item:e,contents:t,current:w,documentRegistry:d,onContextMenu:V,onSelect:R},e.name):(0,n.jsx)(pe,{item:e,current:w?.path===e.path,onSelect:e=>{R(e,C)},onContextMenu:V},e.name))}),(0,n.jsx)(ne.W,{anchorRef:y??void 0,open:null!==y?.current,onOpenChange:()=>{x(null)},children:(0,n.jsx)(ne.W.Overlay,{children:(0,n.jsxs)(ae.l,{children:[(0,n.jsx)(ae.l.Item,{title:"Delete the active item.",onSelect:E,children:"Delete…"}),r&&(0,n.jsx)(ae.l.Item,{title:"Copy the active item to the local drive.",onSelect:j,children:"Copy to local drive…"})]})})}),S&&(0,n.jsx)(ie.l,{title:(0,n.jsx)("span",{style:{color:"var(--fgColor-default)"},children:"Confirm deletion"}),onClose:()=>{k(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{k(!1)}},{buttonType:"danger",content:"Delete",onClick:()=>{I()}}],children:`Are you sure you want to delete ${w?.path}?`}),b&&(0,n.jsx)(ie.l,{title:(0,n.jsx)("span",{style:{color:"var(--fgColor-default)"},children:"Confirm copy to local"}),onClose:()=>{T(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{T(!1)}},{buttonType:"danger",content:"Copy to local",onClick:()=>{_()}}],children:`Are you sure you want to copy to local ${w?.path}?`})]}):(0,n.jsx)(se.E,{children:(0,n.jsx)(se.E.Heading,{children:"No contents"})})})]})}},73553:(e,t,r)=>{r.d(t,{k:()=>ce});var n=r(18683),a=r(9387),o=r(22462),i=r(98754),s=r(90117),c=r(1290),l=r(37706),d=r(62097),u=r(89492),m=r(71784),h=r(67004),p=r(63711),v=r(14377),f=r(47501),w=r(83303),g=r(7384),y=r(30574),x=r(14738),S=r(29028),k=r(47798),b=r(39756),T=r(11796),C=r(70639),A=r(89915),V=r(53054),E=r(75987),I=r(38921),j=r(16950),_=r(79246),R=r(72490),z=r(14809),N=r(59205),D=r(20137),L=r(45458),U=r(89462),P=r(66698),$=r(17402),M=r(66087),F=r(98238),B=r(9366);const H=M.sj.define({combine:e=>e[e.length-1]}),W=D.Lz.baseTheme({".jp-remote-cursor":{borderLeft:"1px solid black",marginLeft:"-1px"},".jp-remote-cursor.jp-mod-primary":{borderLeftWidth:"2px"},".jp-remote-selection":{opacity:.5},".cm-tooltip":{border:"none"},".cm-tooltip.jp-remote-userInfo":{color:"var(--jp-ui-inverse-font-color0)",padding:"0px 2px"}}),O=M.YH.define();class K{style;marker;constructor(e,t){this.style=e,this.marker=t}draw(){const e=this.marker.draw();for(const[t,r]of Object.entries(this.style))e.style[t]=r;return e}eq(e){return this.marker.eq(e.marker)&&F.JSONExt.deepEqual(this.style,e.style)}update(e,t){for(const[t,r]of Object.entries(this.style))e.style[t]=r;return this.marker.update(e,t.marker)}}const Z=(0,D.qd)({above:!0,markers(e){const{awareness:t,ytext:r}=e.state.facet(H),n=r.doc,a=[];return t.getStates().forEach((o,i)=>{if(i===t.doc.clientID)return;const s=o.cursors;for(const t of s??[]){if(!t?.anchor||!t?.head)return;const i=(0,B.IT)(t.anchor,n),s=(0,B.IT)(t.head,n);if(i?.type!==r||s?.type!==r)return;const c=t.primary??1?"jp-remote-cursor jp-mod-primary":"jp-remote-cursor",l=M.OF.cursor(s.index,s.index>i.index?-1:1);for(const t of D.Ip.forRange(e,c,l))a.push(new K({borderLeftColor:o.user?.color??"black"},t))}}),a},update:(e,t)=>!!e.transactions.find(e=>e.annotation(O)),class:"jp-remote-cursors"});function q(e){const t=new Array,{awareness:r,ytext:n}=e.facet(H),a=n.doc;for(const[e,o]of r.getStates())if(e!==r.doc.clientID)for(const e of o.cursors??[]){if(!e?.head)continue;const r=(0,B.IT)(e.head,a);r?.type===n&&t.push({pos:r.index,above:!0,create:()=>{const e=document.createElement("div");return e.classList.add("jp-remote-userInfo"),e.style.backgroundColor=o.user?.color??"darkgrey",e.textContent=o.user?.display_name??"Anonymous",{dom:e}}})}return t}const G=M.sU.define({create:q,update:(e,t)=>t.annotation(O)?q(t.state):e,provide:e=>D.DK.computeN([e],t=>t.field(e))}),J=(0,D.qd)({above:!1,markers(e){const{awareness:t,ytext:r}=e.state.facet(H),n=r.doc,a=[];return t.getStates().forEach((o,i)=>{if(i===t.doc.clientID)return;const s=o.cursors;for(const t of s??[]){if((t.empty??1)||!t?.anchor||!t?.head)return;const i=(0,B.IT)(t.anchor,n),s=(0,B.IT)(t.head,n);if(i?.type!==r||s?.type!==r)return;const c="jp-remote-selection";for(const t of D.Ip.forRange(e,c,M.OF.range(i.index,s.index)))a.push(new K({backgroundColor:o.user?.color??"black"},t))}}),a},update:(e,t)=>!!e.transactions.find(e=>e.annotation(O)),class:"jp-remote-selections"}),X=D.Z9.fromClass(class{editorAwareness;_listener;constructor(e){this.editorAwareness=e.state.facet(H),this._listener=({added:t,updated:r,removed:n})=>{t.concat(r).concat(n).findIndex(e=>e!==this.editorAwareness.awareness.doc.clientID)>=0&&e.dispatch({annotations:[O.of([])]})},this.editorAwareness.awareness.on("change",this._listener)}destroy(){this.editorAwareness.awareness.off("change",this._listener)}update(e){if(!e.docChanged&&!e.selectionSet)return;const{awareness:t,ytext:r}=this.editorAwareness,n=t.getLocalState();if(n){const a=e.view.hasFocus&&e.view.dom.ownerDocument.hasFocus(),o=e.state.selection,i=new Array;if(a&&o){for(const e of o.ranges){const t=e===o.main,n=(0,B.SF)(r,e.anchor),a=(0,B.SF)(r,e.head);i.push({anchor:n,head:a,primary:t,empty:e.empty})}if(!n.cursors||i.length>0){const e=n.cursors?.map(e=>({...e,anchor:e?.anchor?(0,B.sH)(e.anchor):null,head:e?.head?(0,B.sH)(e.head):null}));F.JSONExt.deepEqual(i,e)||t.setLocalStateField("cursors",i)}}}}},{provide:()=>[W,Z,J,G,(0,D.vX)({position:"absolute",parent:document.body})]});var Y=r(50059),Q=r(71791);const ee=1e3,te=new Array,re=".datalayer/ping.ipynb";function ne(e){const{commands:t,extensions:r=te,kernelId:o,renderers:c,serviceManager:p,model:f,onSessionConnection:w}=e,[g,y]=(0,a.useState)(!0),[T,C]=(0,a.useState)(new Array),[A,V]=(0,a.useState)(null),E=(0,a.useMemo)(()=>e.id||(0,$.YG)(),[e.id]),j=(0,a.useMemo)(()=>e.path||re,[e.path]),_=(0,a.useMemo)(()=>new ae({commands:t,renderers:c}),[t,c]),D=(0,a.useMemo)(()=>new x.S.ContentFactory({editorFactory:_.editorServices.factoryService.newInlineEditor}),[_.editorServices.factoryService.newInlineEditor]);(0,a.useEffect)(()=>{const e=new l.A({model:new d.X}),t=new z.x0,r=new u.C({context:{widget:t},providers:[new m.G],timeout:ee}),n=new h.$({completer:e,reconciliator:r});return e.hide(),z.x0.attach(e,document.body),V(n),()=>{n.dispose(),e.dispose(),t.dispose()}},[]);const[M,F]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=new S.k({name:"Notebook",label:"Notebook",modelName:"notebook",fileTypes:["notebook"],defaultFor:["notebook"],preferKernel:!0,autoStartDefault:!1,canStartKernel:!1,shutdownOnClose:!1,rendermime:_.rendermime,contentFactory:D,mimeTypeService:_.editorServices.mimeTypeService,notebookConfig:{...k.a.defaultNotebookConfig,recordTiming:!0}});return F(e),()=>{e.dispose(),F(t=>t===e?null:t)}},[D,_]);const[B,H]=(0,a.useState)(null);(0,a.useEffect)(()=>{const t=A?new b.G({namespace:E}):null,r=A?(0,Q.VV)(_.commands,A,t,e.path):null;return H(t),()=>{r?.dispose(),t?.dispose(),H(e=>e===t?null:e)}},[A,E,_.commands,e.path]);const[W,O]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=new oe(f),t=new v.o({factory:e,manager:p??new ie,path:j,kernelPreference:{shouldStart:!1,canStart:!1,autoStartDefault:!1,shutdownOnDispose:!1}});return function(e,t,r,n,a=!1){const o=!r;e.sessionContext._initialize=async()=>{const t=e.sessionContext.sessionManager;await t.ready,await t.refreshRunning();const n=(0,I.find)(t.running(),t=>t.kernel?.id===(e.sessionContext.kernelPreference.id??""));if(n)try{const a=t.connectTo({model:{...n,path:r??n.path,name:r??n.name},kernelConnectionOptions:{handleComms:!0}});e.sessionContext._handleNewSession(a),this._kernel?.connection?.dispose()}catch(t){return e.sessionContext._handleSessionError(t),Promise.reject(t)}return await e.sessionContext._startIfNecessary()},e.dispose=()=>{e.isDisposed||(e._isDisposed=!0,e.sessionContext.dispose(),e._disposed.emit(void 0),R.Signal.clearData(this))},o&&(e._populate=async()=>{if(e._isPopulated=!0,e._isReady=!0,e._populatedPromise.resolve(void 0),e.isDisposed)return;const t=e._model.defaultKernelName||e.sessionContext.kernelPreference.name;e.sessionContext.kernelPreference={...e.sessionContext.kernelPreference,name:t,language:e._model.defaultKernelLanguage},a||e.sessionContext.initialize().then(t=>{t&&e._dialogs.selectKernel(e.sessionContext.sessionContext)})},e.initialize=async r=>{e.model.dirty=!1;const n=(new Date).toISOString(),a={path:t,name:t,type:"notebook",content:void 0,writable:!0,created:n,last_modified:n,mimetype:"application/x-ipynb+json",format:"json"};e._updateContentsModel(a),await e._populate(),e.model.sharedModel.clearUndoHistory()}),e.sessionContext.sessionChanged.connect((e,t)=>{const r=t.newValue;console.log("Current Jupyter Session Connection.",r),n?.(r??void 0)}),e.sessionContext.kernelChanged.connect((e,t)=>{const r=t.newValue;console.log("Current Jupyter Kernel Connection.",r),r&&!r.handleComms&&(console.log("Updating the current Kernel Connection to enforce Comms support.",r.handleComms),r.handleComms=!0)}),e.sessionContext.ready.then(()=>{n?.(e?.sessionContext.session??void 0)}),e.initialize(!r)}(t,E,j!==re?j:void 0,w,!p),O(t),()=>{t.dispose(),e.dispose(),O(e=>e===t?null:e)}},[E,p,f,w,j]),(0,a.useEffect)(()=>{W&&o&&!W.sessionContext.isDisposed&&W.sessionContext.changeKernel({id:o}).catch(e=>{console.error("Failed to change kernel model.",e)})},[W,o]);const[K,Z]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=null,t=null;if(W&&(e=M?.createNew(W)??null,e)){C(r.map(t=>(t.init({notebookId:E,commands:_.commands,panel:e}),t.createNew(e,W),t.component??(0,n.jsx)(n.Fragment,{}))));const a=e.content.rendermime;t=new L.SS(W,a,{saveState:!1}),a.addFactory({safe:!0,mimeTypes:[U.a],defaultRank:1,createRenderer:e=>new P.X(e,t)},1);for(const r of e.content.widgets)if("code"===r.model.type)for(const e of r.outputArea.widgets)for(const r of Array.from(e.children()))r instanceof P.X&&(r.manager=t);y(!1)}return Z(e),e||C([]),()=>{if(t?.dispose(),e){e.content&&R.Signal.clearData(e.content);try{e.dispose()}catch(e){}}Z(t=>t===e?null:t)}},[W,r,_.commands,M]),(0,a.useEffect)(()=>{let e=!0,t=null,r=null;return K&&(B&&(B.has(K)||B.add(K).catch(e=>{console.error(`Failed to track the notebook panel '${E}'.`)})),A&&(t=(e,t)=>{t&&t.ready.then(()=>{A.editor=t?.editor})},r=(t,r)=>{if(!e)return;const n=K.content.activeCell?.editor,a=new m.G,o=new u.C({context:{widget:K,editor:n,session:r.newValue},providers:[a],timeout:ee});A.editor=n,A.reconciliator=o},K.context.sessionContext.sessionChanged.connect(r),K.context.sessionContext.ready.then(()=>{r?.(K.context.sessionContext,{name:"session",oldValue:null,newValue:K.context.sessionContext.session})}),K.content.activeCellChanged.connect(t))),()=>{e=!1,A&&(t&&K?.content.activeCellChanged.disconnect(t),r&&K?.context.sessionContext.sessionChanged.connect(r),A.editor=null,A.reconciliator=new u.C({context:{widget:new z.x0},providers:[new m.G],timeout:ee}))}},[A,K,B]),(0,a.useEffect)(()=>{const e=e=>{_.commands.processKeydownEvent(e)};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[_.commands]),(0,n.jsxs)(n.Fragment,{children:[T.map((e,t)=>(0,n.jsx)(i.A,{children:e},`${e}-${t}`)),g?(0,n.jsx)(s.a,{},"notebook-loader"):K?(0,n.jsx)(i.A,{sx:{height:"100%"},children:(0,n.jsx)(Y.j,{id:E,children:K},"notebook-container")}):(0,n.jsx)(N.l,{variant:"critical",description:"Unable to create the notebook view.",hideTitle:!0,title:"Error"},"notebook-error")]})}class ae{_commands;_editorServices;_rendermime;constructor(e={}){this._commands=e.commands??new j.J;const t=new c.T9;for(const e of c.T9.getDefaultLanguages())t.addLanguage(e);t.addLanguage({name:"ipythongfm",mime:"text/x-ipythongfm",load:async()=>(await Promise.all([r.e(6636),r.e(9946),r.e(2899),r.e(5949)]).then(r.bind(r,15949))).markdown({codeLanguages:e=>t.findBest(e)})});const n=A.dn.filter(e=>"text/javascript"!==e.mimeTypes[0]).concat([w.rendererFactory,f.rendererFactory]).concat(e.renderers??[]);this._rendermime=new V.K({initialFactories:n,latexTypesetter:new y.p,markdownParser:(0,g.createMarkdownParser)(t)});const a=new c.mN(t),o=new c.k8;for(const e of c.k8.getDefaultThemes())o.addTheme(e);const i=new c.AG;for(const e of c.AG.getDefaultExtensions({themes:o}))i.addExtension(e);i.addExtension({name:"shared-model-binding",factory:e=>{const t=e.model.sharedModel;return c.AG.createImmutableExtension((0,c.rX)({ytext:t.ysource,undoManager:t.undoManager??void 0}))}}),i.addExtension({name:"remote-user-cursors",factory(e){const{awareness:t,ysource:r}=e.model.sharedModel;return c.AG.createImmutableExtension((n={awareness:t,ytext:r},[H.of(n),X]));var n}});const s=function(){const e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null}();s&&i.addExtension({name:"csp-nonce",factory:()=>c.AG.createImmutableExtension(D.Lz.cspNonce.of(s))});const l=new c.Ez({extensions:i,languages:t});this._editorServices={factoryService:l,mimeTypeService:a}}get commands(){return this._commands}get editorServices(){return this._editorServices}get rendermime(){return this._rendermime}}class oe extends C.p{model;constructor(e){super(),this.model=e}createNew(e){return this.model}}class ie{contents=Object.freeze({fileChanged:{connect:()=>{}},getSharedModelFactory:e=>null,localPath(e){const t=e.split("/"),r=t[0].split(":");return 1!==r.length&&this._additionalDrives.has(r[0])?p.PathExt.join(r.slice(1).join(":"),...t.slice(1)):p.PathExt.removeSlash(e)},normalize(e){const t=e.split(":");return 1===t.length?p.PathExt.normalize(e):`${t[0]}:${p.PathExt.normalize(t.slice(1).join(":"))}`}});kernelspecs=Object.freeze({ready:new Promise(()=>{})});sessions=Object.freeze({ready:new Promise(()=>{})});ready=Promise.resolve()}const se=o.DU`
  .dla-Box-Notebook .jp-Cell .dla-CellSidebar-Container {
    display: none;
  }
  .dla-Box-Notebook .jp-Cell.jp-mod-active .dla-CellSidebar-Container {
    display: block;
  }
`;function ce(e){const{Toolbar:t,children:r,cellSidebarMargin:o=120,collaborationProvider:c,commands:l,extensions:d,height:u="100vh",maxHeight:m="100vh",id:h,nbformat:p,onNotebookModelChanged:v,onSessionConnection:f,path:w,readonly:g=!1,renderers:y,serviceManager:x,startDefaultKernel:S=!1,url:k}=e,[b,C]=(0,a.useState)(!0),A=function(e={}){const{kernels:t,requestedKernelId:r,startDefaultKernel:n=!1}=e,[o,i]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{let e,a=!0;return t&&(async()=>{let o;if(await t.ready,r)for(const e of t.running())if(e.id===r){o=r;break}!o&&n&&a&&(console.log("Starting new kernel."),e=await t.startNew(),a?o=e.id:e.dispose()),a&&i(o)})(),()=>{a=!1,e&&(console.log(`Shutting down kernel '${e.id}'.`),e.shutdown().catch(t=>{console.warn(`Failed to shutdown kernel '${e?.id}'.`,t)}).finally(()=>{e?.dispose()}))}},[t,r,n]),o}({requestedKernelId:e.kernelId,kernels:x.kernels,startDefaultKernel:S}),V=function(e){const{collaborationProvider:t,nbformat:r,readonly:n=!1,url:o,path:i,serviceManager:s,id:c}=e,[l,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=!0;const a=new _.DisposableSet;if(t&&s&&c){const r=async()=>{try{const r=new E.Xn;if(await t.connect(r,c,{serviceManager:s,path:i}),e){const e=new T.x({collaborationEnabled:!0,disableDocumentWideUndoRedo:!0,sharedModel:r});e.readOnly=n,d(e),a.add({dispose:()=>{t.disconnect()},get isDisposed(){return!1}})}}catch(e){console.error("Failed to setup collaboration:",e)}};r()}else{const t=e=>{const t=new T.x;e&&(e.cells.forEach(e=>{e.metadata.editable=!n}),t.fromJSON(e)),t.readOnly=n,d(t)};!r&&o?async function(e){return fetch(e).then(e=>e.text()).then(e=>JSON.parse(e))}(o).then(r=>{e&&t(r)}):t(r)}return()=>{e=!1,a.dispose()}},[t,r,n,o,i,s,c]),l}({collaborationProvider:c,nbformat:p,readonly:g,url:k,path:w,serviceManager:x,id:h});return(0,a.useEffect)(()=>{V&&C(!1),v?.(V)},[V,v]),(0,a.useEffect)(()=>{const e=()=>{c&&V&&V.sharedModel.awareness.setLocalStateField("user",x.user.identity)};return e(),x.user.userChanged.connect(e),()=>{x.user.userChanged.disconnect(e)}},[c,V,x]),b?(0,n.jsx)(s.a,{},"notebook-loader"):(0,n.jsxs)(i.A,{style:{height:u,width:"100%",position:"relative"},id:"dla-Jupyter-Notebook",children:[t&&(0,n.jsx)(t,{notebookId:h}),(0,n.jsxs)(i.A,{className:"dla-Box-Notebook",sx:{height:u,maxHeight:m,width:"100%",overflowY:"hidden","& .datalayer-NotebookPanel-header":{minHeight:"50px"},"& .jp-Notebook":{flex:"1 1 auto !important",height:"100%",overflowY:"scroll"},"& .jp-NotebookPanel":{},"& .jp-Toolbar":{display:"none",zIndex:0},"& .jp-Toolbar .jp-HTMLSelect.jp-DefaultStyle select":{fontSize:"14px"},"& .jp-Toolbar > .jp-Toolbar-responsive-opener":{display:"none"},"& .jp-Toolbar-kernelName":{display:"none"},"& .jp-Cell":{width:`calc(100% - ${o}px)`},"& .jp-Notebook-footer":{width:`calc(100% - ${o+82}px)`},"& .jp-CodeMirrorEditor":{cursor:"text !important"},".dla-Box-Notebook":{position:"relative"}},children:[r,(0,n.jsx)(se,{}),V&&x&&(0,n.jsx)(ne,{commands:l,id:h,extensions:d,kernelId:A,model:V,path:w,renderers:y,serviceManager:x,onSessionConnection:f})]})]})}},75345:(e,t,r)=>{r.d(t,{E:()=>c});var n=r(18683),a=r(71791),o=r(99180),i=r(38621),s=r(9387);function c(e){const{commandRegistry:t,runtimeDesc:r,sessionConnection:c}=e,[l,d]=(0,s.useState)();return(0,s.useEffect)(()=>{const e=()=>{d(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}},[c]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Q,{variant:"invisible",size:"small",leadingVisual:i.udU,disabled:!r?.location||"busy"===l,onClick:e=>t?.execute(a.nx.runAll),children:"Run all"}),(0,n.jsx)(o.Q,{variant:"invisible",size:"small",leadingVisual:i.wFz,disabled:!r?.location||"busy"!==l,onClick:e=>t?.execute(a.nx.interrupt),children:"Interrupt"})]})}},83051:(e,t,r)=>{r.d(t,{P:()=>V});var n=r(18683),a=r(9387),o=r(34164),i=r(94313),s=r(2918),c=r(46186),l=r.n(c),d=r(83788);l()(d.A,{insert:"head",singleton:!1}),d.A.locals;const u={disabled:"[disabled]",hidden:"[hidden]",inert:"[inert]",negativeTabIndex:'[tabindex="-1"]'},m=["a[href]","button","summary","select","input:not([type=hidden])","textarea",'[tabindex="0"]',"audio[controls]","video[controls]","[contenteditable]"].map(e=>`${e}:not(${Object.values(u).join("):not(")})`);function h(e,t){if(!e||p(e))return!1;const r=v(e,[e]);return Boolean(r)}function p(e){const t=getComputedStyle(e),r=e.matches("[disabled], [hidden], [inert]"),n="none"===t.display||"hidden"===t.visibility;return r||n}function v(e,t){if(!e)return;const r=t.find(t=>t===e),n=p(e);if(e.matches(m.join(", "))&&!r&&!n)return e;for(const r of e.children)if(v(r,t))return!0}var f=r(70070);const w=(e,t)=>a.Children.map(e,e=>a.isValidElement(e)?a.cloneElement(e,{...e.props,square:"square"===t||void 0,className:(0,o.$)(e.props.className,"pc-AvatarItem","prc-AvatarStack-AvatarItem-nS1mt")}):e),g=({disableExpand:e,hasInteractiveChildren:t,stackContainer:r,children:a})=>(0,n.jsx)("div",{"data-disable-expand":e?"":void 0,className:(0,o.$)({"pc-AvatarStack--disableExpand":e},"pc-AvatarStackBody","prc-AvatarStack-AvatarStackBody-mSyoJ"),tabIndex:t||e?void 0:0,ref:r,children:a});g.displayName="AvatarStackBody";const y=({children:e,variant:t="cascade",shape:r="circle",alignRight:c,disableExpand:l,size:d,className:u,style:m,sx:p})=>{const[v,y]=(0,a.useState)(!1),x=(0,a.useRef)(null),S=a.Children.count(e),k=(()=>{const t={narrow:[],regular:[],wide:[]};return a.Children.toArray(e).reduce((e,r)=>{if(!a.isValidElement(r))return e;for(const n of Object.keys(t))(0,s.W8)(r.props.size)?t[n].push(r.props.size[n]||i.E):t[n].push(r.props.size||i.E),e[n]=Math.min(...t[n]);return e},{narrow:i.E,regular:i.E,wide:i.E})})();return(0,a.useEffect)(()=>{if(x.current){const e=()=>{y(h(x.current))},t=new MutationObserver(e);return t.observe(x.current,{childList:!0}),e(),()=>{t.disconnect()}}},[]),(0,n.jsx)(f._,{as:"span","data-variant":t,"data-shape":r,"data-avatar-count":S>3?"3+":S,"data-align-right":c?"":void 0,"data-responsive":!d||(0,s.W8)(d)?"":void 0,className:(0,o.$)({"pc-AvatarStack--variant":t,"pc-AvatarStack--shape":r,"pc-AvatarStack--two":2===S,"pc-AvatarStack--three":3===S,"pc-AvatarStack--three-plus":S>3,"pc-AvatarStack--right":c},u,"prc-AvatarStack-AvatarStack-N-r3C"),style:{...d?(0,s.W8)(d)?{"--stackSize-narrow":`${d.narrow||i.E}px`,"--stackSize-regular":`${d.regular||i.E}px`,"--stackSize-wide":`${d.wide||i.E}px`}:{"--avatar-stack-size":`${d}px`}:{"--stackSize-narrow":`${k.narrow}px`,"--stackSize-regular":`${k.regular}px`,"--stackSize-wide":`${k.wide}px`},...m},sx:p,children:(0,n.jsxs)(g,{disableExpand:l,hasInteractiveChildren:v,stackContainer:x,children:[" ",w(e,r)]})})};y.displayName="AvatarStack";var x=r(45724),S=r(20061);const k=28,b="DatalayerSpacer",T=3e4;var C;!function(e){e.PROGRESS="var(--borderColor-accent-emphasis)",e.ERROR="var(--borderColor-danger-emphasis)",e.SUCCESS="var(--borderColor-success-emphasis)"}(C||(C={}));const A={"-1":C.ERROR,0:C.PROGRESS,1:C.SUCCESS};function V({awareness:e,currentUserHandle:t}){const[r,o]=(0,a.useState)([]);return(0,a.useEffect)(()=>{const r=()=>{const r=e.getStates();o(Array.from(r.values()).filter(e=>e.user&&e.user?.name!==t&&!(e.user?.agent??"").startsWith(b)).reduce((e,t)=>{const r=t.user,n=!((t.notification?.timestamp??0)+T<Date.now()),a=r.agent?{avatarUrl:"https://static.vecteezy.com/system/resources/previews/006/662/139/large_2x/artificial-intelligence-ai-processor-chip-icon-symbol-for-graphic-design-logo-web-site-social-media-mobile-app-ui-illustration-free-vector.jpg",color:r.color,displayName:r.agent,handle:"agent",initials:"AI",username:r.agent,notification:n?`${t.notification?.message} ${(0,x.g)(new Date(t.notification.timestamp))}`:void 0,notificationType:n&&void 0!==t.notification?.message_type?A[t.notification?.message_type.toString()]:void 0}:{avatarUrl:r.avatar_url,color:r.color,displayName:r.display_name,handle:r.name,initials:r.initials,username:r.username};return e.map(e=>e.username).includes(a.username)||e.push(a),e},[]))};r(),e.on("change",r);const n=setInterval(r,T/3);return()=>{clearInterval(n),e.off("change",r)}},[e,t]),(0,n.jsx)(y,{children:r.map(e=>{let t=`${e.displayName}\n${e.handle}`;return e.notification&&(t+=`\n${e.notification}`),(0,n.jsx)(i.A,{sx:{border:e.notificationType?`var(--borderWidth-thick) solid ${e.notificationType}`:"none"},title:t,src:e.avatarUrl?(0,S.$K)(e.avatarUrl):(r=e.color,a=e.initials,"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="${r}" stroke="none" /><text x="12" y="12" fill="black">${a}</text></svg>`)),size:k},e.displayName);var r,a})})}},83788:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(52908),a=r.n(n),o=r(10293),i=r.n(o)()(a());i.push([e.id,'.prc-AvatarStack-AvatarStack-N-r3C{--avatar-border-width:1px;--mask-size:calc(100% + var(--avatar-border-width)*2);--mask-start:-1;--opacity-step:15%;display:flex;height:var(--avatar-stack-size);isolation:isolate;min-width:var(--avatar-stack-size);position:relative}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]){--overlap-size:calc(var(--avatar-stack-size)*0.55);--overlap-size-avatar-three-plus:calc(var(--avatar-stack-size)*0.85)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=stack]){--overlap-size:calc(var(--avatar-stack-size)*0.55);--overlap-size-avatar-three-plus:calc(var(--avatar-stack-size)*0.55)}@media screen and (max-width:calc(48rem - 0.02px)){.prc-AvatarStack-AvatarStack-N-r3C:where([data-responsive]){--avatar-stack-size:var(--stackSize-narrow)}}@media screen and (min-width:48rem){.prc-AvatarStack-AvatarStack-N-r3C:where([data-responsive]){--avatar-stack-size:var(--stackSize-regular)}}@media screen and (min-width:87.5rem){.prc-AvatarStack-AvatarStack-N-r3C:where([data-responsive]){--avatar-stack-size:var(--stackSize-wide)}}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="1"][data-shape=circle]) .prc-AvatarStack-AvatarItem-nS1mt{box-shadow:0 0 0 var(--avatar-border-width) var(--avatar-borderColor,var(--color-avatar-border))}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="1"][data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt{box-shadow:1px 0 #000}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="1"][data-shape=square][data-align-right]) .prc-AvatarStack-AvatarItem-nS1mt{box-shadow:-1px 0 #000}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="2"]){min-width:calc(var(--avatar-stack-size) + var(--avatar-stack-size) - var(--overlap-size))}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3"][data-variant=cascade]){min-width:calc(var(--avatar-stack-size) + var(--avatar-stack-size) - var(--overlap-size) + var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3"][data-variant=stack]){min-width:calc(var(--avatar-stack-size) + (var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))*2)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3+"][data-variant=cascade]){min-width:calc(var(--avatar-stack-size) + var(--avatar-stack-size) - var(--overlap-size) + (var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))*2)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3+"][data-variant=stack]){min-width:calc(var(--avatar-stack-size) + (var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))*3);--overlap-size:var(--overlap-size-avatar-three-plus)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-align-right]){--mask-start:1;direction:rtl}.prc-AvatarStack-AvatarStackBody-mSyoJ{display:flex;position:absolute}.prc-AvatarStack-AvatarStackBody-mSyoJ:where([data-disable-expand]){position:relative}.prc-AvatarStack-AvatarItem-nS1mt{--avatarSize-regular:var(--avatar-stack-size);display:flex;flex-shrink:0;height:var(--avatar-stack-size);overflow:hidden;position:relative;transition:margin .2s ease-in-out,opacity .2s ease-in-out,-webkit-mask-position .2s ease-in-out,-webkit-mask-size .2s ease-in-out;transition:margin .2s ease-in-out,opacity .2s ease-in-out,mask-position .2s ease-in-out,mask-size .2s ease-in-out;transition:margin .2s ease-in-out,opacity .2s ease-in-out,mask-position .2s ease-in-out,mask-size .2s ease-in-out,-webkit-mask-position .2s ease-in-out,-webkit-mask-size .2s ease-in-out;width:var(--avatar-stack-size)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=circle]) .prc-AvatarStack-AvatarItem-nS1mt:is(img){box-shadow:0 0 0 var(--avatar-border-width) transparent}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:is(img){box-shadow:1px 0 #fff}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square][data-align-right]) .prc-AvatarStack-AvatarItem-nS1mt:is(img){box-shadow:-1px 0 #fff}.prc-AvatarStack-AvatarItem-nS1mt:first-child{margin-inline-start:0}.prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+2){margin-inline-start:calc(var(--overlap-size)*-1);-webkit-mask-composite:xor;mask-composite:exclude;-webkit-mask-position:calc((var(--avatar-stack-size) - var(--overlap-size))*var(--mask-start) - var(--avatar-border-width)) center,0 0;mask-position:calc((var(--avatar-stack-size) - var(--overlap-size))*var(--mask-start) - var(--avatar-border-width)) center,0 0;-webkit-mask-repeat:no-repeat,no-repeat;mask-repeat:no-repeat,no-repeat;-webkit-mask-size:var(--mask-size) var(--mask-size),auto;mask-size:var(--mask-size) var(--mask-size),auto;padding:.1px}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=circle]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+2){-webkit-mask-image:radial-gradient(at 50% 50%,#000 70%,transparent 71%),linear-gradient(#000 0 0);mask-image:radial-gradient(at 50% 50%,#000 70%,transparent 71%),linear-gradient(#000 0 0)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+2){-webkit-mask-image:linear-gradient(at 50% 50%,#000 70%,transparent 71%),linear-gradient(#000 0 0);mask-image:linear-gradient(at 50% 50%,#000 70%,transparent 71%),linear-gradient(#000 0 0)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+3){--overlap-size:var(--overlap-size-avatar-three-plus);opacity:calc(100% - var(--opacity-step)*2)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+4){opacity:calc(100% - var(--opacity-step)*3)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+5){opacity:calc(100% - var(--opacity-step)*4)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:first-child{z-index:5}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(2){z-index:4}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(3){z-index:3}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(4){z-index:2}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(5){z-index:1}.prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+6){opacity:0;visibility:hidden}.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):focus-within,.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):hover{width:auto}:is(.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):hover,.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):focus-within) .prc-AvatarStack-AvatarItem-nS1mt{--mask-size:100%;margin-inline-start:var(--base-size-4,.25rem);-webkit-mask-position:calc(var(--avatar-stack-size)*var(--mask-start)) center,0 0;mask-position:calc(var(--avatar-stack-size)*var(--mask-start)) center,0 0;opacity:1;visibility:visible}:is(:is(.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):hover,.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):focus-within) .prc-AvatarStack-AvatarItem-nS1mt):first-child{margin-inline-start:0}',""]);const s=i}}]);
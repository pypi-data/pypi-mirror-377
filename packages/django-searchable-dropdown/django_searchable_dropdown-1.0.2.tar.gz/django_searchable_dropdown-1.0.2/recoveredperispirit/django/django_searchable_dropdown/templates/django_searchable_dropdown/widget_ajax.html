{% load static %}

<div class="searchable-dropdown searchable-dropdown-ajax" 
     data-type="{{ dropdown_type|default:'default' }}"
     {% if ajax_url %}data-ajax-url="{{ ajax_url }}"{% endif %}
     {% if delay %}data-delay="{{ delay }}"{% endif %}
     {% if min_search_length %}data-min-search-length="{{ min_search_length }}"{% endif %}
     {% if max_results %}data-max-results="{{ max_results }}"{% endif %}
     {% if allow_clear != None %}data-allow-clear="{{ allow_clear|yesno:'true,false' }}"{% endif %}
     {% if allow_create != None %}data-allow-create="{{ allow_create|yesno:'true,false' }}"{% endif %}>
    <div class="dropdown-display" tabindex="0">
        <span class="selected-text">{{ placeholder|default:'Digite para buscar...' }}</span>
        <i class="bi bi-chevron-down dropdown-arrow"></i>
    </div>
    
    <div class="dropdown-menu">
        <div class="search-container">
            <input type="text" class="search-input" 
                   placeholder="{{ search_placeholder|default:'Digite para buscar...' }}">
            <i class="bi bi-search search-icon"></i>
        </div>
        
        <div class="options-container">
            <!-- Opções serão carregadas via AJAX -->
        </div>
        
        <div class="no-results" style="display: none;">
            {{ no_results_text|default:'Nenhum resultado encontrado' }}
        </div>
        
        <div class="loading-indicator" style="display: none;">
            <div class="spinner-border spinner-border-sm text-primary" role="status">
                <span class="visually-hidden">Carregando...</span>
            </div>
            <span class="ms-2">Buscando...</span>
        </div>
    </div>
    
    <select name="{{ name }}" id="{{ attrs.id }}" style="display: none;">
        {% for choice in widget.choices %}
            <option value="{{ choice.0 }}" 
                    {% if choice.0 == value %}selected{% endif %}>
                {{ choice.1 }}
            </option>
        {% endfor %}
    </select>
</div>

<link rel="stylesheet" href="{% static 'css/searchable-dropdown.css' %}">


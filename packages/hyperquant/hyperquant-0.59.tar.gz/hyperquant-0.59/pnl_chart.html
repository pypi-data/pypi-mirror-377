<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>策略盈利曲线</title>
                <script type="text/javascript" src="https://assets.pyecharts.org/assets/v5/echarts.min.js"></script>

    
</head>
<body >
    <div id="3c4dfdc1cc7747cd89b177b72cfc81ac" class="chart-container" style="width:100%; height:625px; "></div>
    <script>
        var chart_3c4dfdc1cc7747cd89b177b72cfc81ac = echarts.init(
            document.getElementById('3c4dfdc1cc7747cd89b177b72cfc81ac'), 'white', {renderer: 'canvas'});
        var option_3c4dfdc1cc7747cd89b177b72cfc81ac = {
    "animation": true,
    "animationThreshold": 2000,
    "animationDuration": 1000,
    "animationEasing": "cubicOut",
    "animationDelay": 0,
    "animationDurationUpdate": 300,
    "animationEasingUpdate": "cubicOut",
    "animationDelayUpdate": 0,
    "aria": {
        "enabled": false
    },
    "color": [
        "#5470c6",
        "#91cc75",
        "#fac858",
        "#ee6666",
        "#73c0de",
        "#3ba272",
        "#fc8452",
        "#9a60b4",
        "#ea7ccc"
    ],
    "series": [
        {
            "type": "line",
            "name": "\u76c8\u5229\u66f2\u7ebf",
            "connectNulls": false,
            "xAxisIndex": 0,
            "yAxisIndex": 0,
            "symbolSize": 4,
            "showSymbol": false,
            "smooth": true,
            "clip": true,
            "step": false,
            "stackStrategy": "samesign",
            "data": [
                [
                    "2025-01-01 00:00:00",
                    1.0
                ],
                [
                    "2025-01-02 00:00:00",
                    1.01
                ],
                [
                    "2025-01-03 00:00:00",
                    1.0302
                ],
                [
                    "2025-01-04 00:00:00",
                    1.061106
                ],
                [
                    "2025-01-05 00:00:00",
                    1.1035502400000001
                ],
                [
                    "2025-01-06 00:00:00",
                    1.158727752
                ],
                [
                    "2025-01-07 00:00:00",
                    1.22825141712
                ],
                [
                    "2025-01-08 00:00:00",
                    1.3142290163184
                ],
                [
                    "2025-01-09 00:00:00",
                    1.4193673376238722
                ],
                [
                    "2025-01-10 00:00:00",
                    1.547110398010021
                ],
                [
                    "2025-01-11 00:00:00",
                    1.7018214378110232
                ],
                [
                    "2025-01-12 00:00:00",
                    1.889021795970236
                ],
                [
                    "2025-01-13 00:00:00",
                    2.1157044114866643
                ],
                [
                    "2025-01-14 00:00:00",
                    2.3907459849799304
                ],
                [
                    "2025-01-15 00:00:00",
                    2.725450422877121
                ],
                [
                    "2025-01-16 00:00:00",
                    3.134267986308689
                ],
                [
                    "2025-01-17 00:00:00",
                    3.6357508641180787
                ],
                [
                    "2025-01-18 00:00:00",
                    4.253828511018152
                ],
                [
                    "2025-01-19 00:00:00",
                    5.019517643001419
                ],
                [
                    "2025-01-20 00:00:00",
                    5.973225995171688
                ],
                [
                    "2025-01-21 00:00:00",
                    7.167871194206026
                ],
                [
                    "2025-01-22 00:00:00",
                    8.673124144989291
                ],
                [
                    "2025-01-23 00:00:00",
                    10.581211456886935
                ],
                [
                    "2025-01-24 00:00:00",
                    13.01489009197093
                ],
                [
                    "2025-01-25 00:00:00",
                    16.138463714043954
                ],
                [
                    "2025-01-26 00:00:00",
                    20.173079642554942
                ],
                [
                    "2025-01-27 00:00:00",
                    25.418080349619228
                ],
                [
                    "2025-01-28 00:00:00",
                    32.28096204401642
                ],
                [
                    "2025-01-29 00:00:00",
                    41.31963141634102
                ],
                [
                    "2025-01-30 00:00:00",
                    53.30232452707992
                ],
                [
                    "2025-01-31 00:00:00",
                    69.2930218852039
                ],
                [
                    "2025-02-01 00:00:00",
                    90.77385866961711
                ],
                [
                    "2025-02-02 00:00:00",
                    119.8214934438946
                ],
                [
                    "2025-02-03 00:00:00",
                    159.36258628037982
                ],
                [
                    "2025-02-04 00:00:00",
                    213.54586561570898
                ],
                [
                    "2025-02-05 00:00:00",
                    288.28691858120715
                ],
                [
                    "2025-02-06 00:00:00",
                    392.0702092704417
                ],
                [
                    "2025-02-07 00:00:00",
                    537.1361867005052
                ],
                [
                    "2025-02-08 00:00:00",
                    741.2479376466971
                ],
                [
                    "2025-02-09 00:00:00",
                    1030.3346333289091
                ],
                [
                    "2025-02-10 00:00:00",
                    1442.4684866604728
                ],
                [
                    "2025-02-11 00:00:00",
                    2033.8805661912668
                ],
                [
                    "2025-02-12 00:00:00",
                    2888.1104039915986
                ],
                [
                    "2025-02-13 00:00:00",
                    4129.997877707986
                ],
                [
                    "2025-02-14 00:00:00",
                    5947.196943899499
                ],
                [
                    "2025-02-15 00:00:00",
                    8623.435568654273
                ],
                [
                    "2025-02-16 00:00:00",
                    12590.21593023524
                ],
                [
                    "2025-02-17 00:00:00",
                    18507.617417445803
                ],
                [
                    "2025-02-18 00:00:00",
                    27391.273777819788
                ],
                [
                    "2025-02-19 00:00:00",
                    40812.99792895148
                ],
                [
                    "2025-02-20 00:00:00",
                    61219.49689342722
                ],
                [
                    "2025-02-21 00:00:00",
                    92441.4403090751
                ],
                [
                    "2025-02-22 00:00:00",
                    140510.98926979414
                ],
                [
                    "2025-02-23 00:00:00",
                    214981.81358278505
                ],
                [
                    "2025-02-24 00:00:00",
                    331071.99291748897
                ],
                [
                    "2025-02-25 00:00:00",
                    513161.58902210795
                ],
                [
                    "2025-02-26 00:00:00",
                    800532.0788744885
                ],
                [
                    "2025-02-27 00:00:00",
                    1256835.3638329469
                ],
                [
                    "2025-02-28 00:00:00",
                    1985799.8748560562
                ],
                [
                    "2025-03-01 00:00:00",
                    3157421.801021129
                ],
                [
                    "2025-03-02 00:00:00",
                    5051874.881633807
                ],
                [
                    "2025-03-03 00:00:00",
                    8133518.559430429
                ],
                [
                    "2025-03-04 00:00:00",
                    13176300.066277295
                ],
                [
                    "2025-03-05 00:00:00",
                    21477369.108031992
                ],
                [
                    "2025-03-06 00:00:00",
                    35222885.33717247
                ],
                [
                    "2025-03-07 00:00:00",
                    58117760.80633458
                ],
                [
                    "2025-03-08 00:00:00",
                    96475482.93851541
                ],
                [
                    "2025-03-09 00:00:00",
                    161114056.50732073
                ],
                [
                    "2025-03-10 00:00:00",
                    270671614.93229884
                ],
                [
                    "2025-03-11 00:00:00",
                    457435029.23558503
                ],
                [
                    "2025-03-12 00:00:00",
                    777639549.7004946
                ],
                [
                    "2025-03-13 00:00:00",
                    1329763629.987846
                ],
                [
                    "2025-03-14 00:00:00",
                    2287193443.579095
                ],
                [
                    "2025-03-15 00:00:00",
                    3956844657.3918343
                ],
                [
                    "2025-03-16 00:00:00",
                    6884909703.861792
                ],
                [
                    "2025-03-17 00:00:00",
                    12048591981.758135
                ],
                [
                    "2025-03-18 00:00:00",
                    21205521887.894318
                ],
                [
                    "2025-03-19 00:00:00",
                    37533773741.572945
                ],
                [
                    "2025-03-20 00:00:00",
                    66810117259.99984
                ],
                [
                    "2025-03-21 00:00:00",
                    119590109895.39972
                ],
                [
                    "2025-03-22 00:00:00",
                    215262197811.7195
                ],
                [
                    "2025-03-23 00:00:00",
                    389624578039.21234
                ],
                [
                    "2025-03-24 00:00:00",
                    709116732031.3665
                ],
                [
                    "2025-03-25 00:00:00",
                    1297683619617.4006
                ],
                [
                    "2025-03-26 00:00:00",
                    2387737860096.017
                ],
                [
                    "2025-03-27 00:00:00",
                    4417315041177.632
                ],
                [
                    "2025-03-28 00:00:00",
                    8216205976590.395
                ],
                [
                    "2025-03-29 00:00:00",
                    15364305176224.04
                ],
                [
                    "2025-03-30 00:00:00",
                    28884893731301.19
                ],
                [
                    "2025-03-31 00:00:00",
                    54592449152159.26
                ],
                [
                    "2025-04-01 00:00:00",
                    103725653389102.58
                ],
                [
                    "2025-04-02 00:00:00",
                    198115997973185.94
                ],
                [
                    "2025-04-03 00:00:00",
                    380382716108517.0
                ],
                [
                    "2025-04-04 00:00:00",
                    734138642089437.9
                ],
                [
                    "2025-04-05 00:00:00",
                    1424228965653509.5
                ],
                [
                    "2025-04-06 00:00:00",
                    2777246483024344.0
                ],
                [
                    "2025-04-07 00:00:00",
                    5443403106727714.0
                ],
                [
                    "2025-04-08 00:00:00",
                    1.0723504120253596e+16
                ],
                [
                    "2025-04-09 00:00:00",
                    2.123253815810212e+16
                ],
                [
                    "2025-04-10 00:00:00",
                    4.225275093462322e+16
                ]
            ],
            "hoverAnimation": true,
            "label": {
                "show": false,
                "margin": 8,
                "valueAnimation": false
            },
            "logBase": 10,
            "seriesLayoutBy": "column",
            "lineStyle": {
                "show": true,
                "width": 1,
                "opacity": 1,
                "curveness": 0,
                "type": "solid",
                "color": "red"
            },
            "areaStyle": {
                "opacity": 0
            },
            "itemStyle": {
                "color": "red"
            },
            "zlevel": 0,
            "z": 0
        }
    ],
    "legend": [
        {
            "data": [
                "\u76c8\u5229\u66f2\u7ebf"
            ],
            "selected": {},
            "show": true,
            "left": "45",
            "top": 45,
            "orient": "vertical",
            "padding": 5,
            "itemGap": 10,
            "itemWidth": 25,
            "itemHeight": 14,
            "backgroundColor": "transparent",
            "borderColor": "#ccc",
            "borderRadius": 0,
            "pageButtonItemGap": 5,
            "pageButtonPosition": "end",
            "pageFormatter": "{current}/{total}",
            "pageIconColor": "#2f4554",
            "pageIconInactiveColor": "#aaa",
            "pageIconSize": 15,
            "animationDurationUpdate": 800,
            "selector": false,
            "selectorPosition": "auto",
            "selectorItemGap": 7,
            "selectorButtonGap": 10
        }
    ],
    "tooltip": {
        "show": true,
        "trigger": "axis",
        "triggerOn": "mousemove|click",
        "axisPointer": {
            "type": "cross"
        },
        "showContent": true,
        "alwaysShowContent": false,
        "showDelay": 0,
        "hideDelay": 100,
        "enterable": false,
        "confine": false,
        "appendToBody": false,
        "transitionDuration": 0.4,
        "textStyle": {
            "color": "#000",
            "fontSize": 13
        },
        "backgroundColor": "rgba(245, 245, 245, 0.8)",
        "borderColor": "#ccc",
        "borderWidth": 1,
        "padding": 5,
        "order": "seriesAsc"
    },
    "xAxis": [
        {
            "show": true,
            "scale": false,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "axisLabel": {
                "show": true,
                "margin": 8,
                "valueAnimation": false
            },
            "inverse": false,
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": true,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "animation": true,
            "animationThreshold": 2000,
            "animationDuration": 1000,
            "animationEasing": "cubicOut",
            "animationDelay": 0,
            "animationDurationUpdate": 300,
            "animationEasingUpdate": "cubicOut",
            "animationDelayUpdate": 0,
            "data": [
                "2025-01-01 00:00:00",
                "2025-01-02 00:00:00",
                "2025-01-03 00:00:00",
                "2025-01-04 00:00:00",
                "2025-01-05 00:00:00",
                "2025-01-06 00:00:00",
                "2025-01-07 00:00:00",
                "2025-01-08 00:00:00",
                "2025-01-09 00:00:00",
                "2025-01-10 00:00:00",
                "2025-01-11 00:00:00",
                "2025-01-12 00:00:00",
                "2025-01-13 00:00:00",
                "2025-01-14 00:00:00",
                "2025-01-15 00:00:00",
                "2025-01-16 00:00:00",
                "2025-01-17 00:00:00",
                "2025-01-18 00:00:00",
                "2025-01-19 00:00:00",
                "2025-01-20 00:00:00",
                "2025-01-21 00:00:00",
                "2025-01-22 00:00:00",
                "2025-01-23 00:00:00",
                "2025-01-24 00:00:00",
                "2025-01-25 00:00:00",
                "2025-01-26 00:00:00",
                "2025-01-27 00:00:00",
                "2025-01-28 00:00:00",
                "2025-01-29 00:00:00",
                "2025-01-30 00:00:00",
                "2025-01-31 00:00:00",
                "2025-02-01 00:00:00",
                "2025-02-02 00:00:00",
                "2025-02-03 00:00:00",
                "2025-02-04 00:00:00",
                "2025-02-05 00:00:00",
                "2025-02-06 00:00:00",
                "2025-02-07 00:00:00",
                "2025-02-08 00:00:00",
                "2025-02-09 00:00:00",
                "2025-02-10 00:00:00",
                "2025-02-11 00:00:00",
                "2025-02-12 00:00:00",
                "2025-02-13 00:00:00",
                "2025-02-14 00:00:00",
                "2025-02-15 00:00:00",
                "2025-02-16 00:00:00",
                "2025-02-17 00:00:00",
                "2025-02-18 00:00:00",
                "2025-02-19 00:00:00",
                "2025-02-20 00:00:00",
                "2025-02-21 00:00:00",
                "2025-02-22 00:00:00",
                "2025-02-23 00:00:00",
                "2025-02-24 00:00:00",
                "2025-02-25 00:00:00",
                "2025-02-26 00:00:00",
                "2025-02-27 00:00:00",
                "2025-02-28 00:00:00",
                "2025-03-01 00:00:00",
                "2025-03-02 00:00:00",
                "2025-03-03 00:00:00",
                "2025-03-04 00:00:00",
                "2025-03-05 00:00:00",
                "2025-03-06 00:00:00",
                "2025-03-07 00:00:00",
                "2025-03-08 00:00:00",
                "2025-03-09 00:00:00",
                "2025-03-10 00:00:00",
                "2025-03-11 00:00:00",
                "2025-03-12 00:00:00",
                "2025-03-13 00:00:00",
                "2025-03-14 00:00:00",
                "2025-03-15 00:00:00",
                "2025-03-16 00:00:00",
                "2025-03-17 00:00:00",
                "2025-03-18 00:00:00",
                "2025-03-19 00:00:00",
                "2025-03-20 00:00:00",
                "2025-03-21 00:00:00",
                "2025-03-22 00:00:00",
                "2025-03-23 00:00:00",
                "2025-03-24 00:00:00",
                "2025-03-25 00:00:00",
                "2025-03-26 00:00:00",
                "2025-03-27 00:00:00",
                "2025-03-28 00:00:00",
                "2025-03-29 00:00:00",
                "2025-03-30 00:00:00",
                "2025-03-31 00:00:00",
                "2025-04-01 00:00:00",
                "2025-04-02 00:00:00",
                "2025-04-03 00:00:00",
                "2025-04-04 00:00:00",
                "2025-04-05 00:00:00",
                "2025-04-06 00:00:00",
                "2025-04-07 00:00:00",
                "2025-04-08 00:00:00",
                "2025-04-09 00:00:00",
                "2025-04-10 00:00:00"
            ]
        }
    ],
    "yAxis": [
        {
            "show": true,
            "scale": true,
            "nameLocation": "end",
            "nameGap": 15,
            "gridIndex": 0,
            "inverse": false,
            "position": "right",
            "offset": 0,
            "splitNumber": 5,
            "minInterval": 0,
            "splitLine": {
                "show": true,
                "lineStyle": {
                    "show": true,
                    "width": 1,
                    "opacity": 1,
                    "curveness": 0,
                    "type": "solid"
                }
            },
            "splitArea": {
                "show": true,
                "areaStyle": {
                    "opacity": 1
                }
            },
            "animation": true,
            "animationThreshold": 2000,
            "animationDuration": 1000,
            "animationEasing": "cubicOut",
            "animationDelay": 0,
            "animationDurationUpdate": 300,
            "animationEasingUpdate": "cubicOut",
            "animationDelayUpdate": 0
        }
    ],
    "title": [
        {
            "show": false,
            "target": "blank",
            "subtarget": "blank",
            "padding": 5,
            "itemGap": 10,
            "textAlign": "auto",
            "textVerticalAlign": "auto",
            "triggerEvent": false
        }
    ],
    "toolbox": {
        "show": true,
        "orient": "vertical",
        "itemSize": 15,
        "itemGap": 10,
        "left": "left",
        "top": "43",
        "feature": {
            "saveAsImage": {
                "type": "png",
                "backgroundColor": "auto",
                "connectedBackgroundColor": "#fff",
                "show": true,
                "title": "\u4fdd\u5b58\u4e3a\u56fe\u7247",
                "pixelRatio": 1
            },
            "restore": {
                "show": true,
                "title": "\u8fd8\u539f"
            },
            "dataView": {
                "show": true,
                "title": "\u6570\u636e\u89c6\u56fe",
                "readOnly": false,
                "lang": [
                    "\u6570\u636e\u89c6\u56fe",
                    "\u5173\u95ed",
                    "\u5237\u65b0"
                ],
                "backgroundColor": "#fff",
                "textareaColor": "#fff",
                "textareaBorderColor": "#333",
                "textColor": "#000",
                "buttonColor": "#c23531",
                "buttonTextColor": "#fff"
            },
            "dataZoom": {
                "show": true,
                "title": {
                    "zoom": "\u533a\u57df\u7f29\u653e",
                    "back": "\u533a\u57df\u7f29\u653e\u8fd8\u539f"
                },
                "icon": {},
                "filterMode": "filter"
            },
            "magicType": {
                "show": true,
                "type": [
                    "line",
                    "bar",
                    "stack",
                    "tiled"
                ],
                "title": {
                    "line": "\u5207\u6362\u4e3a\u6298\u7ebf\u56fe",
                    "bar": "\u5207\u6362\u4e3a\u67f1\u72b6\u56fe",
                    "stack": "\u5207\u6362\u4e3a\u5806\u53e0",
                    "tiled": "\u5207\u6362\u4e3a\u5e73\u94fa"
                },
                "icon": {}
            }
        }
    },
    "dataZoom": [
        {
            "show": true,
            "type": "slider",
            "showDetail": true,
            "showDataShadow": true,
            "realtime": true,
            "start": 80,
            "end": 100,
            "orient": "horizontal",
            "xAxisIndex": [
                0
            ],
            "zoomLock": false,
            "bottom": "15",
            "filterMode": "filter"
        },
        [
            {
                "show": true,
                "type": "slider",
                "showDetail": true,
                "showDataShadow": true,
                "realtime": true,
                "start": 80,
                "end": 100,
                "orient": "horizontal",
                "xAxisIndex": [
                    0
                ],
                "zoomLock": false,
                "bottom": "15",
                "filterMode": "filter"
            }
        ]
    ],
    "axisPointer": {
        "show": true,
        "type": "line",
        "link": [
            {
                "xAxisIndex": "all"
            }
        ],
        "label": {
            "show": true,
            "margin": 8,
            "backgroundColor": "#777",
            "valueAnimation": false
        },
        "triggerTooltip": true,
        "triggerOn": "mousemove|click"
    },
    "brush": {
        "toolbox": [
            "rect",
            "polygon",
            "keep",
            "clear"
        ],
        "brushLink": "all",
        "xAxisIndex": "all",
        "brushType": "lineX",
        "brushMode": "single",
        "transformable": true,
        "brushStyle": {
            "borderWidth": 1,
            "color": "rgba(120,140,180,0.3)",
            "borderColor": "rgba(120,140,180,0.8)"
        },
        "throttleType": "fixRate",
        "throttleDelay": 0,
        "removeOnClick": true,
        "outOfBrush": {
            "colorAlpha": 0.1
        },
        "z": 10000
    },
    "grid": [
        {
            "show": false,
            "zlevel": 0,
            "z": 2,
            "left": "45",
            "top": 45,
            "right": "380",
            "height": 500,
            "containLabel": false,
            "backgroundColor": "transparent",
            "borderColor": "#ccc",
            "borderWidth": 1,
            "shadowOffsetX": 0,
            "shadowOffsetY": 0
        }
    ]
};
        chart_3c4dfdc1cc7747cd89b177b72cfc81ac.setOption(option_3c4dfdc1cc7747cd89b177b72cfc81ac);
            window.addEventListener('resize', function(){
                chart_3c4dfdc1cc7747cd89b177b72cfc81ac.resize();
            })
    </script>
</body>
</html>

        <script>
        function fixDecLen(fd,dec_length){
            //line_other_param[i].dec_length
            if (dec_length>=0){
                let dzz=10 ** dec_length;
                fd=Math.round(fd * dzz) / dzz;
                //fd=fd.toFixed(dec_length);
            }
            return fd;
        }        
        var line_other_param=[{name:'盈利曲线',window_cumprod_base_one:false,color:'red',dec_length:2,},
        ];
        var cc=document.getElementsByClassName("chart-container");
        var cc_name=cc[0].id;
        var chart_ins=window["chart_"+cc_name];
        var dataZoom_startValue_i=0;
        var dataZoom_endValue_i=0;
        var dataZoom_startValue=0;
        var dataZoom_endValue=0;
        var chart_option=window["option_"+cc_name];
        var chart_option_back=JSON.parse(JSON.stringify(chart_option));
    
        chart_option.tooltip.formatter = function(params) {
            let res = params[0].axisValue;
            for (let i = 0; i < params.length; i++) {
                // 判断 line_other_param[i] 是否存在以及 dec_length 是否存在
                let dec_length = (line_other_param[i] && line_other_param[i].dec_length) || 2; // 默认值为 2
                res += '<div>';
                res += params[i].marker;

                if (params[i].seriesType === 'line') {
                    res += params[i].seriesName + '：' + fixDecLen(params[i].value[1], dec_length);
                } else if (params[i].seriesType === 'candlestick') {
                    let zdf = params[i].value[2] / params[i].value[1] - 1;
                    zdf = (zdf * 100).toFixed(2);
                    res += params[i].seriesName + '：开(' + fixDecLen(params[i].value[1], dec_length) + '), 收('
                        + fixDecLen(params[i].value[2], dec_length) + '), 低('
                        + fixDecLen(params[i].value[3], dec_length) + '), 高('
                        + fixDecLen(params[i].value[4], dec_length) + '), 涨(<span style="color:' + (zdf > 0 ? 'red' : 'green') + ';">'
                        + zdf + '%</span>)';
                } else {
                    res += params[i].seriesName + '：' + fixDecLen(params[i].value, dec_length);
                }
                res += '</div>';
            }
            return res;
        }
    
        chart_ins.setOption(chart_option);
    
        
        
        
        </script>

        <style>
        body {
            margin: 0;
        }  
        .button {
            border: 0px solid #ccc; /* 设置按钮的边框 */
            background-color: transparent; /* 设置按钮的背景颜色为透明 */
            padding: 5px 10px 5px 10px; /* 设置按钮的内边距 */
            cursor: pointer; /* 设置按钮的鼠标样式为手型 */
            font-size: 13px; /* 设置按钮的字体大小 */
        }
        .button:hover {
            background-color: darkorange; /* 设置按钮在鼠标悬停时的背景颜色 */
            color: white;
        }
        </style>
        <div style="position: fixed;left: 40px;top: 40px;bottom: 0;width: 3px;background-color: #e0e3eb;"></div>
        <div style="position: fixed;right: 300px;top: 40px;bottom: 0;width: 3px;background-color: #e0e3eb;"></div>
        <div style="position: fixed;left: 0;right:0;top: 40px;height: 3px;background-color: #e0e3eb;"></div>
        <div style="position: fixed;left: 0px;height: 40px;top: 0;right: 0;background-color:#f9f9f9;display: flex;">
            <div style="padding: 10px 10px 5px 5px;font-size: 16px;font-weight: bold;">策略盈利曲线</div>
            <div style="margin: 8px 0px;width: 1px;height:25px;background-color: #b4b8c3;"></div>
            <div style='display: flex;padding: 5px;font-size: 13px;'>
                <label for="date-input" style="padding-top: 7px;">日期：</label>
                <input id="date-input" name="date" style="width:80px">
                <button class="button" type="submit" id="jump_bt">跳转</button>
                <button class="button" style="display: flex;padding-top: 7px;" type="submit" id="to_front">
                    ➡️&#x3000
                    <span>前进</span>
                </button>
                <button class="button" style="display: flex;padding-top: 7px;" type="submit" id="to_back">
                    ⬅️&#x3000
                    <span>回退</span>
                    
                </button>
                <button class="button" type="submit" id="auto_play">自动前进</button>
            </div>
            <div style="margin: 8px 0px;width: 1px;height:25px;background-color: #b4b8c3;"></div>
            <div style='display: flex;padding: 5px;font-size: 13px;'>
                <label for="date-input" style="padding-top: 7px;">时间窗口宽度：</label>
                <input id="date_win_width" name="date_win_width" style="width:60px">
                <button class="button" type="submit" id="date_win_width_set">设置</button>
            </div>
            <div style="margin: 8px 0px;width: 1px;height:25px;background-color: #b4b8c3;"></div>
            <div id="inf_div" style='border: 0px solid black;font-size:14px;color: red;padding: 10px;'>
            信息显示区
            </div>
        </div>

        <div id="all_data_div" style='position: absolute;top: 45px;right:0px;width:300px;height:auto;border: 0px solid black;font-size:14px;'>
            <div id="data_div" style='display:;'>
            数据显示区
            </div>
            <div style="left: 0;right:0;height: 3px;background-color: #e0e3eb;display:;"></div>
            <div id="ext_data_div" style='display:none;width:0px;border: 0px solid black;font-size:14px;'>
            扩展信息显示
            </div>
            <div style="display:none;left: 0;right:0;height: 3px;background-color: #e0e3eb;"></div>
        </div>
        <script>
            //获取chart实例
            function play_ibe_js_default(ibe,next){
                //如果next为true表示向后移动,false为向前移动,null为不移动
                if(next===true){
                    ibe.begin += 1
                    ibe.end += 1;
                }else if(next===false){
                    ibe.begin -= 1
                    ibe.end -= 1;
                }
                ibe.begin = ibe.begin<0?0:ibe.begin;
                ibe.end = ibe.end<10?10:ibe.end;
                return ibe;
            }
            
            function play_ibe(ibe,next){
                if (typeof play_ibe_js=="function"){
                    return play_ibe_js(ibe,next);
                }else{
                    return play_ibe_js_default(ibe,next);
                }
            }
            
            function cleanInf(){
                document.getElementById("inf_div").innerHTML=""
            }
            function setInf(info,view_sed){
                document.getElementById("inf_div").innerHTML=info
                if (view_sed!=null && view_sed>0){
                    setTimeout(cleanInf, 5000); // 1000毫秒后清除提示
                }
            }
            function darkenColor(colorStr, percent) {
                const f = parseInt(colorStr.slice(1), 16);
                const t = (f * percent) >> 16;
                return "#" + (0x10000 + t).toString(16).slice(1);
            }

            // 监听 datazoom 事件
            chart_ins.on('datazoom', function (params) {
                // 获取当前 dataZoom 的 startValue 和 endValue
                date_data=chart_option.xAxis[0].data;
                let bi=0,ei=0;
                if (params.start>=0){
                    dataZoom_startValue_i = Math.ceil(date_data.length*params.start/100);
                    dataZoom_startValue_i=dataZoom_startValue_i<0?0:dataZoom_startValue_i;
                    dataZoom_endValue_i = Math.ceil(date_data.length*params.end/100);
                    dataZoom_endValue_i=dataZoom_endValue_i>date_data.length-1?date_data.length-1:dataZoom_endValue_i;
                    bi = dataZoom_startValue_i;
                    ei = dataZoom_endValue_i;
                    dataZoom_startValue="";
                    dataZoom_endValue="";
                    // 输出 startValue 和 endValue
                    //console.log("startValue:", date_data[dataZoom_startValue_i]);
                    //console.log("endValue:", date_data[dataZoom_endValue_i]);
                }else{
                    dataZoom_startValue=params.startValue;
                    dataZoom_endValue=params.endValue;
                    dataZoom_startValue_i=-1;
                    dataZoom_endValue_i=-1;
                    for (let i=0;i<chart_option.xAxis[0].data.length;i++){
                        if (chart_option.xAxis[0].data[i]==dataZoom_startValue){
                            bi=i;
                        }
                        if (chart_option.xAxis[0].data[i]==dataZoom_endValue){
                            ei=i;
                        }
                    }
                    dataZoom_startValue_i=bi;
                    dataZoom_endValue_i=ei;
                    // 输出 startValue 和 endValue
                    //console.log("startValue:", dataZoom_startValue);
                    //console.log("endValue:", dataZoom_endValue);
                }
                dataZoom_endValue_i=ei;
                //归1化显示设置window_cumprod_base_one的数据,窗口内的数据根据涨跌幅算净值
                let opt_changed=false;
                for (let i=0;i<chart_option.series.length;i++){
                    if (line_other_param[i].window_cumprod_base_one && chart_option.series[i].type=="line"){
                        opt_changed=true;
                        chart_option.series[i].data[bi][1] = 1;
                        for (let j=bi+1;j<=ei;j++){
                            chart_option.series[i].data[j][1] = chart_option.series[i].data[j-1][1] * (1+chart_option_back.series[i].data[j][1]);
                        }
                    }
                }
                if (opt_changed==true){
                    delete chart_option.dataZoom[0].start;
                    delete chart_option.dataZoom[0].end;
                    chart_option.dataZoom[0].startValue=bi;
                    chart_option.dataZoom[0].endValue=ei;
                    chart_ins.setOption(chart_option);
                }
                //显示当前结束点的数据
                
                let data_div = document.getElementById('data_div');    
                let conn= "<table style='font-size: 12px;word-break: break-word;width:100%'>"
                            +"<tr><td style='background-color: #f7f7f7;;border-right: 1px dashed #000;padding: 5px 0;font-weight: bold;'>当前时间</td>"
                            +"<td style='background-color: #f7f7f7;'>"+chart_option.xAxis[0].data[ei]+"</td>"
                for (let i=0;i<chart_option.series.length;i++){
                    let b_color= "color" in line_other_param[i]?line_other_param[i].color:"#101010";
                    // b_color = darkenColor(b_color); //本来是准备给颜色减淡一些做背景的,有问题先不处理了
                    conn = conn + "<tr><td style='color:"+b_color+";background-color:#f7f7f7;border-right: 1px dashed #000;border-top: 1px dashed #000;padding: 1px 0;font-weight: bold;'>"
                            +chart_option.series[i].name+"</td><td style='border-top: 1px dashed #000;'>";
                    let datacon="";
                    let d=chart_option.series[i].data[ei];
                    let dec_length=line_other_param[i].dec_length;
                    if (chart_option.series[i].type=="line"){
                        d=d[1];
                        d=fixDecLen(d,dec_length);
                        datacon+="<span style='color:"+(d>0?"red":"green")+"'>"+d+"</span>";
                    }else if (chart_option.series[i].type=="candlestick"){
                        let zdf=d[1]/d[0]-1;
                        zdf=(zdf*100).toFixed(2);
                        datacon+="开("+fixDecLen(d[0],dec_length)+"),收("+fixDecLen(d[1],dec_length)+"),<br/>低("
                            +d[2]+"),高("+fixDecLen(d[3],dec_length)+"),<br/>涨:<span style='color:"+(zdf>0?"red":"green")+"';>"
                            +fixDecLen(zdf,dec_length)+"%</span>";
                    }else{
                        datacon+=d;
                    }
                    conn = conn + datacon;
                    conn = conn +"</td></tr>"
                }
                conn = conn + "</table>";
                data_div.innerHTML = conn;
    
                let d_width=dataZoom_endValue_i-dataZoom_startValue_i+1;
                if (typeof set_ext_data_div === 'function'){
                    set_ext_data_div(document.getElementById("ext_data_div"),ei,d_width);
                }
                document.getElementById('date_win_width').value=d_width;                
            });
            //时间窗口宽度设置
            let date_win_width_set = document.getElementById('date_win_width_set');
            date_win_width_set.addEventListener('click', function() {
                let ibe={begin:dataZoom_startValue_i,end:dataZoom_endValue_i};
                let d_width = document.getElementById('date_win_width').value-1;
                ibe.begin = (ibe.end-d_width)>0?(ibe.end-d_width):0; 
                chart_ins.dispatchAction({
                    type: 'dataZoom',
                    startValue: chart_option.xAxis[0].data[ibe.begin],
                    endValue: chart_option.xAxis[0].data[ibe.end],
                });
            });            
            //自动回放
            let auto_play = document.getElementById('auto_play');
            let is_run_play=false;
            auto_play.addEventListener('click', function() {
                if (!is_run_play){
                    auto_play.innerText="停止";
                    is_run_play=true;
                    do_next();
                }else{
                    auto_play.innerText="自动回放";
                    is_run_play=false;
                }
                function do_next(){
                    if (is_run_play){
                        if (chart_option.xAxis[0].data.length-1>dataZoom_endValue_i+1){
                            let ibe={begin:dataZoom_startValue_i,end:dataZoom_endValue_i};
                            ibe=play_ibe(ibe,true);
                            chart_ins.dispatchAction({
                                type: 'dataZoom',
                                startValue: chart_option.xAxis[0].data[ibe.begin],
                                endValue: chart_option.xAxis[0].data[ibe.end],
                            });
                        }else{
                            setInf("已经前进到最后一天",2000);
                            auto_play.innerText="自动回放";
                            return;
                        }
                        let space=2000;
                        if (typeof auto_play_space === 'function'){
                            space=auto_play_space(dataZoom_endValue_i);
                        }
                        setTimeout(do_next, space); // 1000 毫秒后再次执行自己
                    }
                }
            });
            //向前跳转
            let to_front = document.getElementById('to_front');
            to_front.addEventListener('click', function() {
                if (chart_option.xAxis[0].data.length-1>dataZoom_endValue_i+1){
                    let ibe={begin:dataZoom_startValue_i,end:dataZoom_endValue_i};
                    ibe=play_ibe(ibe,true);
                    chart_ins.dispatchAction({
                        type: 'dataZoom',
                        startValue: chart_option.xAxis[0].data[ibe.begin],
                        endValue: chart_option.xAxis[0].data[ibe.end],
                    });
                }else{
                    setInf("已经前进到最后一天",2000);
                }
                
            });
            // 向后跳转
            let to_back = document.getElementById('to_back');
            to_back.addEventListener('click', function() {
                if (dataZoom_endValue_i-1>=10){
                    let ibe={begin:dataZoom_startValue_i,end:dataZoom_endValue_i};
                    ibe=play_ibe(ibe,false);
                    chart_ins.dispatchAction({
                        type: 'dataZoom',
                        startValue: chart_option.xAxis[0].data[ibe.begin],
                        endValue: chart_option.xAxis[0].data[ibe.end],
                    });
                }else{
                    setInf("已经回退到第一天",2000);
                }
            });
            // 日期输入框跳转
            let jump_bt = document.getElementById('jump_bt');
            jump_bt.addEventListener('click', function() {
                let dateInput = document.getElementById('date-input');
                endDate=dateInput.value;
                if (endDate.indexOf("-")<0 && endDate.length>=6){
                    endDate = endDate.replace(/^(\d4)(\d2)(\d2)$/, '$1-$2-$3');

                }
                to_date(endDate);
            });
            
            function to_date(endDate){
                //设置chart的dataZoom实现X轴变化
                //从后向前第一个小于等于该日期的日期/或者X轴中的一个日期,修正endDate,因为有可能用户输入的日期在X轴中不存在,或者大于X轴的最大值,或者小于X轴的最小值
                let endDate_i=-1;
                for (let i=0;i<chart_option.xAxis[0].data.length;i++){
                    if (chart_option.xAxis[0].data[i]>=endDate){
                        endDate=chart_option.xAxis[0].data[i]
                        endDate_i=i;
                        break;
                    }
                }
                let space = dataZoom_endValue_i-dataZoom_startValue_i;
                let ibe={end:endDate_i};
                ibe.begin=ibe.end-space>=0?ibe.end-space:0;
                ibe=play_ibe(ibe,null);
                chart_ins.dispatchAction({
                    type: 'dataZoom',
                    startValue: chart_option.xAxis[0].data[ibe.begin],
                    endValue: chart_option.xAxis[0].data[ibe.end],
                });   
            }
            //默认跳到最后,并显示zoom_space个点的数据
            let d_l=chart_option.xAxis[0].data.length-1;
            let zoom_end=-1;
            d_l = zoom_end>0?zoom_end:d_l;
            d_endValue=chart_option.xAxis[0].data[d_l];
            let d_startValue=chart_option.xAxis[0].data[d_l>100?d_l-100+1:0];
            chart_ins.dispatchAction({
                type: 'dataZoom',
                startValue: d_startValue,
                endValue: d_endValue,
            });
            // 监听点击事件,实现点击曲线隐藏该曲线
            chart_ins.on('click', (params) => {
              if (params.seriesType === 'line') {
                let seriesName = params.seriesName;
                chart_ins.dispatchAction({
                    type: 'legendUnSelect',
                    name: seriesName,
                });
              }
            });
    </script>
Metadata-Version: 2.4
Name: maxtext
Version: 0.1.0
Summary: MaxText is a simple, performant and scalable Jax LLM!
Project-URL: Repository, https://github.com/AI-Hypercomputer/maxtext.git
Project-URL: Bug Tracker, https://github.com/AI-Hypercomputer/maxtext/issues
License-Expression: Apache-2.0
License-File: AUTHORS
License-File: LICENSE
Keywords: deepseek,gemma,jax,llama,llm,mistral,mixtral
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: GPU
Classifier: Programming Language :: ML
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.12
Requires-Dist: absl-py>=2.3.1
Requires-Dist: aiofiles>=24.1.0
Requires-Dist: aiohappyeyeballs>=2.6.1
Requires-Dist: aiohttp>=3.12.15
Requires-Dist: aiosignal>=1.4.0
Requires-Dist: annotated-types>=0.7.0
Requires-Dist: antlr4-python3-runtime>=4.9.3
Requires-Dist: anyio>=4.10.0
Requires-Dist: aqtp>=0.9.0
Requires-Dist: array-record>=0.8.1
Requires-Dist: astroid>=3.3.11
Requires-Dist: astunparse>=1.6.3
Requires-Dist: attrs>=25.3.0
Requires-Dist: auditwheel>=6.4.1
Requires-Dist: black>=24.10.0
Requires-Dist: blobfile>=3.1.0
Requires-Dist: build>=1.2.2.post1
Requires-Dist: cachetools>=5.5.2
Requires-Dist: certifi>=2025.8.3
Requires-Dist: cffi>=1.17.1; platform_python_implementation == 'PyPy'
Requires-Dist: cfgv>=3.4.0
Requires-Dist: charset-normalizer>=3.4.3
Requires-Dist: chex>=0.1.90
Requires-Dist: click>=8.2.1
Requires-Dist: cloud-accelerator-diagnostics>=0.1.1
Requires-Dist: cloud-tpu-diagnostics>=0.1.5
Requires-Dist: cloudpickle>=3.1.1
Requires-Dist: clu>=0.0.12
Requires-Dist: colorama>=0.4.6
Requires-Dist: contourpy>=1.3.2
Requires-Dist: coverage>=7.10.6
Requires-Dist: cycler>=0.12.1
Requires-Dist: decorator>=5.2.1
Requires-Dist: dill>=0.3.8
Requires-Dist: distlib>=0.4.0
Requires-Dist: dm-tree>=0.1.9
Requires-Dist: docstring-parser>=0.17.0
Requires-Dist: editdistance>=0.8.1
Requires-Dist: einops>=0.8.1
Requires-Dist: etils>=1.13.0
Requires-Dist: evaluate>=0.4.5
Requires-Dist: execnet>=2.1.1
Requires-Dist: fastapi>=0.116.1
Requires-Dist: filelock>=3.18.0
Requires-Dist: flatbuffers>=25.2.10
Requires-Dist: flax>=0.11.2
Requires-Dist: fonttools>=4.59.0
Requires-Dist: frozenlist>=1.7.0
Requires-Dist: fsspec>=2025.7.0
Requires-Dist: gast>=0.6.0
Requires-Dist: gcsfs>=2025.7.0
Requires-Dist: google-api-core>=2.25.1
Requires-Dist: google-api-python-client>=2.181.0
Requires-Dist: google-auth-httplib2>=0.2.0
Requires-Dist: google-auth-oauthlib>=1.2.2
Requires-Dist: google-auth>=2.40.3
Requires-Dist: google-cloud-aiplatform>=1.111.0
Requires-Dist: google-cloud-appengine-logging>=1.6.2
Requires-Dist: google-cloud-audit-log>=0.3.2
Requires-Dist: google-cloud-bigquery>=3.36.0
Requires-Dist: google-cloud-core>=2.4.3
Requires-Dist: google-cloud-logging>=3.12.1
Requires-Dist: google-cloud-monitoring>=2.27.2
Requires-Dist: google-cloud-resource-manager>=1.14.2
Requires-Dist: google-cloud-storage>=2.19.0
Requires-Dist: google-crc32c>=1.7.1
Requires-Dist: google-genai>=1.33.0
Requires-Dist: google-pasta>=0.2.0
Requires-Dist: google-resumable-media>=2.7.2
Requires-Dist: googleapis-common-protos>=1.70.0
Requires-Dist: grain>=0.2.12
Requires-Dist: grpc-google-iam-v1>=0.14.2
Requires-Dist: grpcio-status>=1.71.2
Requires-Dist: grpcio>=1.74.0
Requires-Dist: gviz-api>=1.10.0
Requires-Dist: h11>=0.16.0
Requires-Dist: h5py>=3.14.0
Requires-Dist: hf-xet>=1.1.9; platform_machine == 'aarch64' or platform_machine == 'amd64' or platform_machine == 'arm64' or platform_machine == 'x86_64'
Requires-Dist: httpcore>=1.0.9
Requires-Dist: httplib2>=0.30.0
Requires-Dist: httpx>=0.28.1
Requires-Dist: huggingface-hub>=0.34.4
Requires-Dist: humanize>=4.13.0
Requires-Dist: hypothesis>=6.136.4
Requires-Dist: identify>=2.6.14
Requires-Dist: idna>=3.10
Requires-Dist: immutabledict>=4.2.1
Requires-Dist: importlab>=0.8.1
Requires-Dist: importlib-metadata>=8.7.0
Requires-Dist: importlib-resources>=6.5.2
Requires-Dist: iniconfig>=2.1.0
Requires-Dist: isort>=6.0.1
Requires-Dist: jax>=0.7.0
Requires-Dist: jaxlib>=0.7.0
Requires-Dist: jaxtyping>=0.3.2
Requires-Dist: jinja2>=3.1.6
Requires-Dist: joblib>=1.5.2
Requires-Dist: jsonlines>=4.0.0
Requires-Dist: keras>=3.11.3
Requires-Dist: kiwisolver>=1.4.8
Requires-Dist: libclang>=18.1.1
Requires-Dist: libcst>=1.8.2
Requires-Dist: libtpu>=0.0.19; platform_machine == 'x86_64' and sys_platform == 'linux'
Requires-Dist: lxml>=6.0.1
Requires-Dist: markdown-it-py>=3.0.0
Requires-Dist: markdown>=3.9
Requires-Dist: markupsafe>=3.0.2
Requires-Dist: matplotlib>=3.10.3
Requires-Dist: mccabe>=0.7.0
Requires-Dist: mdurl>=0.1.2
Requires-Dist: ml-collections>=1.1.0
Requires-Dist: ml-dtypes>=0.5.3
Requires-Dist: ml-goodput-measurement>=0.0.14
Requires-Dist: more-itertools>=10.8.0
Requires-Dist: mpmath>=1.3.0
Requires-Dist: msgpack>=1.1.1
Requires-Dist: msgspec>=0.19.0
Requires-Dist: multidict>=6.6.4
Requires-Dist: multiprocess>=0.70.16
Requires-Dist: mypy-extensions>=1.1.0
Requires-Dist: namex>=0.1.0
Requires-Dist: nest-asyncio>=1.6.0
Requires-Dist: networkx>=3.5
Requires-Dist: ninja>=1.13.0
Requires-Dist: nltk>=3.9.1
Requires-Dist: nodeenv>=1.9.1
Requires-Dist: numpy>=2.0.2
Requires-Dist: oauthlib>=3.3.1
Requires-Dist: omegaconf>=2.3.0
Requires-Dist: opentelemetry-api>=1.36.0
Requires-Dist: opt-einsum>=3.4.0
Requires-Dist: optax>=0.2.5
Requires-Dist: optree>=0.17.0
Requires-Dist: orbax-checkpoint>=0.11.24
Requires-Dist: packaging>=25.0
Requires-Dist: pandas>=2.3.2
Requires-Dist: parameterized>=0.9.0
Requires-Dist: pathspec>=0.12.1
Requires-Dist: pathwaysutils>=0.1.2
Requires-Dist: pillow>=11.3.0
Requires-Dist: platformdirs>=4.4.0
Requires-Dist: pluggy>=1.6.0
Requires-Dist: portpicker>=1.6.0
Requires-Dist: pre-commit>=4.3.0
Requires-Dist: prometheus-client>=0.22.1
Requires-Dist: promise>=2.3
Requires-Dist: propcache>=0.3.2
Requires-Dist: proto-plus>=1.26.1
Requires-Dist: protobuf>=5.29.5
Requires-Dist: psutil>=7.0.0
Requires-Dist: pyarrow>=21.0.0
Requires-Dist: pyasn1-modules>=0.4.2
Requires-Dist: pyasn1>=0.6.1
Requires-Dist: pycnite>=2024.7.31
Requires-Dist: pycparser>=2.22; platform_python_implementation == 'PyPy'
Requires-Dist: pycryptodomex>=3.23.0
Requires-Dist: pydantic-core>=2.33.2
Requires-Dist: pydantic>=2.11.7
Requires-Dist: pydot>=4.0.1
Requires-Dist: pyelftools>=0.32
Requires-Dist: pyglove>=0.4.5
Requires-Dist: pygments>=2.19.2
Requires-Dist: pyink>=24.10.1
Requires-Dist: pylint>=3.3.8
Requires-Dist: pyparsing>=3.2.3
Requires-Dist: pyproject-hooks>=1.2.0
Requires-Dist: pytest-xdist>=3.8.0
Requires-Dist: pytest>=8.4.1
Requires-Dist: python-dateutil>=2.9.0.post0
Requires-Dist: pytype>=2024.10.11
Requires-Dist: pytz>=2025.2
Requires-Dist: pyyaml>=6.0.2
Requires-Dist: regex>=2025.9.1
Requires-Dist: requests-oauthlib>=2.0.0
Requires-Dist: requests>=2.32.5
Requires-Dist: rich>=14.1.0
Requires-Dist: rsa>=4.9.1
Requires-Dist: safetensors>=0.6.2
Requires-Dist: scipy>=1.16.0
Requires-Dist: sentencepiece>=0.2.1
Requires-Dist: seqio>=0.0.20
Requires-Dist: setuptools>=80.9.0
Requires-Dist: shapely>=2.1.1
Requires-Dist: shortuuid>=1.0.13
Requires-Dist: simple-parsing>=0.1.7
Requires-Dist: simplejson>=3.20.1
Requires-Dist: six>=1.17.0
Requires-Dist: sniffio>=1.3.1
Requires-Dist: sortedcontainers>=2.4.0
Requires-Dist: starlette>=0.47.3
Requires-Dist: sympy>=1.14.0
Requires-Dist: tabulate>=0.9.0
Requires-Dist: tenacity>=9.1.2
Requires-Dist: tensorboard-data-server>=0.7.2
Requires-Dist: tensorboard-plugin-profile>=2.13.0
Requires-Dist: tensorboard>=2.19.0
Requires-Dist: tensorboardx>=2.6.4
Requires-Dist: tensorflow-datasets>=4.9.9
Requires-Dist: tensorflow-metadata>=1.17.2
Requires-Dist: tensorflow-text>=2.19.0
Requires-Dist: tensorflow>=2.19.1
Requires-Dist: tensorstore>=0.1.76
Requires-Dist: termcolor>=3.1.0
Requires-Dist: tiktoken>=0.11.0
Requires-Dist: tokenizers>=0.22.0
Requires-Dist: toml>=0.10.2
Requires-Dist: tomlkit>=0.13.3
Requires-Dist: toolz>=1.0.0
Requires-Dist: tqdm>=4.67.1
Requires-Dist: transformers>=4.56.1
Requires-Dist: treescope>=0.1.10
Requires-Dist: typing-extensions>=4.14.1
Requires-Dist: typing-inspection>=0.4.1
Requires-Dist: tzdata>=2025.2
Requires-Dist: uritemplate>=4.2.0
Requires-Dist: urllib3>=2.5.0
Requires-Dist: uvicorn>=0.35.0
Requires-Dist: virtualenv>=20.34.0
Requires-Dist: wadler-lindig>=0.1.7
Requires-Dist: websockets>=15.0.1
Requires-Dist: werkzeug>=3.1.3
Requires-Dist: wheel>=0.45.1
Requires-Dist: wrapt>=1.17.3
Requires-Dist: xxhash>=3.5.0
Requires-Dist: yarl>=1.20.1
Requires-Dist: zipp>=3.23.0
Requires-Dist: zstandard>=0.23.0
Description-Content-Type: text/markdown

<!--
 # Copyright 2023‚Äì2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#    https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
 -->

# MaxText

MaxText is a high performance, highly scalable, open-source LLM library and reference implementation written in pure Python/[JAX](https://docs.jax.dev/en/latest/jax-101.html) and targeting Google Cloud TPUs and GPUs for training. 

MaxText provides a library of high performance models to choose from, including Gemma, Llama, DeepSeek, Qwen, and Mistral. For each of these models, MaxText supports pre-training (up to tens of thousands of chips) and scalable post-training, with popular techniques like Supervised Fine-Tuning (SFT) and Group Relative Policy Optimization (GRPO, a type of Reinforcement Learning). 

MaxText achieves high Model FLOPs Utilization (MFU) and tokens/second from single host to very large clusters while staying simple and largely "optimization-free" thanks to the power of JAX and the XLA compiler.

MaxText is the launching point for ambitious LLM projects both in research and production. We encourage you to start by experimenting with MaxText out of the box and then fork and modify MaxText to meet your needs.

Check out our [Read The Docs site](https://maxtext.readthedocs.io/en/latest/) or directly [Get Started](https://maxtext.readthedocs.io/en/latest/tutorials/first_run.html) with your first MaxText run. If you‚Äôre interested in Diffusion models (Wan 2.1, Flux, etc), see the [MaxDiffusion](https://github.com/AI-Hypercomputer/maxdiffusion) repository in our AI Hypercomputer GitHub organization. 

## Installation

We recommend installing MaxText inside a Python virtual environment.

### From PyPI (Recommended)
This is the easiest way to get started with the latest stable version.

```bash
# 1. Install uv, a fast Python package installer
pip install uv

# 2. Install MaxText and its dependencies
uv pip install maxtext --resolution=lowest
install_maxtext_github_deps
```
> **Note:** The `install_maxtext_github_deps` command is temporarily required to install dependencies directly from GitHub that are not yet available on PyPI.

> **Note:** The maxtext package contains a comprehensive list of all direct and transitive dependencies, with lower bounds, generated by [seed-env](https://github.com/google-ml-infra/actions/tree/main/python_seed_env). We highly recommend the `--resolution=lowest` flag. It instructs `uv` to install the specific, tested versions of dependencies defined by MaxText, rather than the latest available ones. This ensures a consistent and reproducible environment, which is critical for stable performance and for running benchmarks.

### From Source
If you plan to contribute to MaxText or need the latest unreleased features, install from source.

```bash
# 1. Clone the repository
git clone https://github.com/AI-Hypercomputer/maxtext.git
cd maxtext

# 2. Install dependencies in editable mode
pip install uv
uv pip install -e . --resolution=lowest
install_maxtext_github_deps
```

After installation, you can verify the package is available with `python3 -c "import MaxText"` and run training jobs with `python3 -m MaxText.train ...`.

## üî• Latest news üî•

* \[September 5, 2025\] MaxText has moved to an `src` layout as part of [RESTRUCTURE.md](RESTRUCTURE.md). For existing environments, please run `pip install -e .` from MaxText root.
* \[August 13, 2025\] The Qwen3 2507 MoE family of models is now supported: MoEs: 235B Thinking & 280B Coder as well as existing dense models: 0.6B, 4B, 8B, 14B, and 32B.  
* \[July 27, 2025\] Updated TFLOPS/s calculation ([PR](https://github.com/AI-Hypercomputer/maxtext/pull/1988)) to account for causal attention, dividing the attention flops in half. Accounted for sliding window and chunked attention reduced attention flops in [PR](https://github.com/AI-Hypercomputer/maxtext/pull/2009) and [PR](https://github.com/AI-Hypercomputer/maxtext/pull/2030). Changes impact large sequence configs, as explained in this [doc](https://github.com/AI-Hypercomputer/maxtext/blob/main/docs/guides/performance_metrics.md)  
* \[July 16, 2025\] We will be restructuring the MaxText repository for improved organization and clarity. Please review the [proposed structure](https://github.com/AI-Hypercomputer/maxtext/blob/main/RESTRUCTURE.md) and provide feedback.  
* \[July 11, 2025\] Multi-Token Prediction (MTP) training support\! Adds an auxiliary loss based on predicting multiple future tokens, inspired by [DeepSeek-V3 paper](https://arxiv.org/html/2412.19437v1), to enhance training efficiency.  
* \[June 25, 2025\] DeepSeek R1-0528 variant is now supported  
* \[April 24, 2025\] Llama 4 Maverick models are now supported

## Use cases

MaxText provides a library of models and demonstrates how to perform pre-training or post-training with high performance and scale. 

MaxText leverages [JAX AI libraries](https://docs.jaxstack.ai/en/latest/getting_started.html) and presents a cohesive and comprehensive demonstration of training at scale by using [Flax](https://flax.readthedocs.io/en/latest/) (neural networks), [Tunix](https://github.com/google/tunix) (post-training), [Orbax](https://orbax.readthedocs.io/en/latest/) (checkpointing), [Optax](https://optax.readthedocs.io/en/latest/) (optimization), and [Grain](https://google-grain.readthedocs.io/en/latest/) (dataloading).

In addition to pure text-based LLMs, we also support multi-modal training with Gemma 3 and Llama 4 VLMs.

### Pre-training

If you‚Äôre building models from scratch, MaxText can serve as a reference implementation for experimentation, ideation, and inspiration \- just fork and modify MaxText to train your model, whether it‚Äôs a small dense model like Llama 8B, or a large MoE like DeepSeek-V3. Experiment with configs and model design to build the most efficient model on TPU or GPU. 

MaxText provides opinionated implementations for how to achieve optimal performance across a wide variety of dimensions like sharding, quantization, and checkpointing. 

### Post-training

If you are post-training a model, whether it is proprietary or open source, MaxText provides a scalable framework using Tunix. For RL (like GRPO), we leverage vLLM for sampling and Pathways (soon) for multi-host. 

Our goal is to provide a variety of models (dimension ‚Äúa‚Äù) and techniques (dimension ‚Äúb‚Äù), so you can easily explore (a) \* (b) combinations and efficiently train the perfect model for your use case.

Check out these getting started guides:

* [SFT](https://github.com/AI-Hypercomputer/maxtext/blob/main/end_to_end/tpu/llama3.1/8b/run_sft.sh) (Supervised Fine Tuning)  
* [GRPO](https://maxtext.readthedocs.io/en/latest/tutorials/grpo.html) (Group Relative Policy Optimization)

### Model library

MaxText aims to provide you with the best OSS models, whether as a reference implementation, or to post-train and then serve with vLLM. 

**Supported JAX models in MaxText**

* Google  
  * Gemma 3 (4B, 12B, 27B)  
  * Gemma 2 (2B, 9B, 27B)  
  * Gemma 1 (2B, 7B)  
* Alibaba  
  * Qwen 3 MoE 2507 (235B, 480B)  
  * Qwen 3 MoE (30B, 235B)  
  * Qwen 3 Dense (0.6B, 1.7B, 4B, 8B, 14B, 32B)  
* DeepSeek  
  * DeepSeek-V2 (16B, 236B)  
  * DeepSeek-V3 0528 (671B)  
* Meta  
  * Llama 4 Scout (109B) & Maverick (400B)  
  * Llama 3.3 70B, 3.1 (8B, 70B, 405B), 3.0 (8B, 70B, 405B)  
  * Llama 2 (7B, 13B, 70B)  
* Open AI  
  * GPT3 (52k, 6B, 22B, 175B)  
* Mistral  
  * Mixtral (8x7B, 8x22B)  
  * Mistral (7B)  
* Diffusion Models  
  * See [MaxDiffusion](https://github.com/AI-Hypercomputer/maxdiffusion) (Wan 2.1, Flux, SDXL, etc)

## Get involved

Please join our [Discord Channel](https://discord.com/invite/2H9PhvTcDU) and if you have feedback, you can file a feature request, documentation request, or bug report [here](https://github.com/AI-Hypercomputer/maxtext/issues/new/choose).

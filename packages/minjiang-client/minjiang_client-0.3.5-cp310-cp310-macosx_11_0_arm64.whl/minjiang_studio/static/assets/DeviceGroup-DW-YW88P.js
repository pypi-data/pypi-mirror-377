import{d as X,b as Y,c as Z,z as ee,r as p,L as te,M as ae,o as oe,K as L,y as q,a7 as ne,aM as se,e as P,f as N,h as f,i as s,p as x,k as t,O as ie,N as re,t as g,w as r,a4 as le,a5 as ue,C as de,cy as S,J as C,B as ce,cz as pe,R as _e,S as me,q as ve,l as fe,I as ge,cA as ye,cB as he,U as Ge,cC as ke,cD as xe,aU as be,H as ze}from"./index-J5_wuFzQ.js";import{A as we}from"./Add-GkLiV60o.js";import{_ as Le,a as Ne}from"./Tabs-CR38P_Kp.js";import{_ as Ce}from"./Alert-BAyZP53g.js";import{_ as Ie,a as Ue}from"./FormItem-cRlJVOXw.js";import"./Add-C8P6H80E.js";import"./debounce-COzzVebV.js";const Me={class:"flex"},Be={class:"text-xl mt-[26px] flex items-center gap-1"},Re={class:"flex justify-between items-center w-full"},$e={class:"flex-1"},qe={class:"text-xl"},Pe={class:"flex justify-end"},Se=X({__name:"DeviceGroup",setup(Ve){const{t:n}=Y(),V=Z(),I=ee(),_=p(!1),U=p(),c=p({description:void 0,device_group_name:void 0}),O={description:{required:!0,message:n("deviceGroup.descriptionErrMsg")},device_group_name:{required:!0,message:n("deviceGroup.groupNameErrMsg")}},M=()=>{_.value=!1,c.value={description:void 0,device_group_name:void 0}},T=()=>{var o;d.value||(d.value=!0,(o=U.value)==null||o.validate(async e=>{if(e){d.value=!1;return}const[i,l]=await ye({...c.value,organization_id:u.value});d.value=!1,!i&&l&&l.status===0&&m()}))},A=o=>{o||M()},b=p(),y=te({page:1,per_page:ae,total:0}),d=p(!1),u=p(),m=async o=>{d.value=!0,b.value=void 0;const[e,i]=await he({...Ge(y),org_id:o||u.value});d.value=!1,!e&&i&&i.status===0&&(b.value=i.data.list,y.total=i.data.total),_.value&&M()},E=async(o,e)=>{const[i,l]=await ke({device_id:e,hidden:!o});!i&&(l==null?void 0:l.status)===0&&m()},h=p(),j=async()=>{var i,l;const[o,e]=await xe();if(!o&&(e==null?void 0:e.status)===0){h.value=(i=e.data)==null?void 0:i.organizations;const G=(l=e.data)==null?void 0:l.organizations;if(I.query.org)u.value=+I.query.org,be(()=>{m()});else if(G&&G.length>0){const v=G[0].organization_id;v&&(u.value=v,m(v))}}};oe(()=>{j()});const H=[{title:n("deviceGroup.id"),key:"create_uid"},{title:n("deviceGroup.groupId"),key:"device_group_id"},{title:n("deviceGroup.groupName"),key:"device_group_name"},{title:n("deviceGroup.description"),key:"description"},{title:n("deviceGroup.createTime"),key:"create_time"},{title:n("createuser"),key:"user_name"},{title:n("deviceGroup.status"),key:"status",render:o=>{var e;if(o.status)return L(ne,{type:((e=q[o.status])==null?void 0:e.type)||"default",bordered:!1},{default:()=>{var i;return n((i=q[o.status])==null?void 0:i.text)}})}},{title:n("deviceGroup.show2desktop"),key:"status",render:o=>{if(o.status)return L("div",{onClick:e=>e.stopPropagation()},L(se,{value:!o.hidden,onUpdateValue:e=>E(e,o.device_group_id)}))}}],K=({device_group_name:o})=>({class:"cursor-pointer",onClick:()=>{V.push({name:"taskList",query:{device_group_name:o}})}});return(o,e)=>{var R,$;const i=re,l=Le,G=Ne,v=ce,D=_e,F=Ce,z=Ue,B=fe,J=Ie,Q=ve,W=ge;return N(),P("div",Me,[f("div",null,[f("div",Be,[s(i,{component:t(ie)},null,8,["component"]),x(" "+g(t(n)("org.orgList")),1)]),s(G,{placement:"left","bar-width":300,type:"card",value:t(u),"onUpdate:value":[e[0]||(e[0]=a=>C(u)?u.value=a:null),m],class:"pr-5 mt-7"},{default:r(()=>[(N(!0),P(le,null,ue(t(h),a=>(N(),de(l,{key:a.organization_id,name:a.organization_id,disabled:t(d),class:"min-w-[200px]"},{default:r(()=>[f("div",Re,[x(g(a.organization_name)+" ",1),s(S,{role:a.user_role},null,8,["role"])])]),_:2},1032,["name","disabled"]))),128))]),_:1},8,["value"])]),f("div",$e,[s(pe,{title:($=(R=t(h))==null?void 0:R.find(a=>a.organization_id==t(u)))==null?void 0:$.organization_name},{tag:r(()=>{var a,k;return[s(S,{role:(k=(a=t(h))==null?void 0:a.find(w=>w.organization_id==t(u)))==null?void 0:k.user_role},null,8,["role"])]}),extra:r(()=>[s(v,{type:"primary",onClick:e[1]||(e[1]=a=>_.value=!0)},{icon:r(()=>[s(t(we))]),default:r(()=>[x(" "+g(t(n)("deviceGroup.create")),1)]),_:1})]),_:1},8,["title"]),s(D,{columns:H,data:t(b),pagination:!1,loading:t(d),"row-props":K},null,8,["data","loading"]),s(me,{"page-info":t(y),"onUpdate:pageInfo":e[2]||(e[2]=a=>C(y)?y.value=a:null),onUpdateList:m},null,8,["page-info"]),s(W,{show:t(_),"onUpdate:show":e[5]||(e[5]=a=>C(_)?_.value=a:null),"on-update:show":A},{default:r(()=>[s(Q,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:r(()=>[s(F,{type:"info",class:"mb-5",bordered:!1},{default:r(()=>[x(g(t(n)("deviceGroup.tips")),1)]),_:1}),s(J,{ref_key:"formRef",ref:U,model:t(c),rules:O},{default:r(()=>[s(z,{label:t(n)("deviceGroup.orgName"),path:"device_group_name"},{default:r(()=>{var a,k;return[f("div",qe,g((k=(a=t(h))==null?void 0:a.find(w=>w.organization_id==t(u)))==null?void 0:k.organization_name),1)]}),_:1},8,["label"]),s(z,{label:t(n)("deviceGroup.groupNameLabel"),path:"device_group_name"},{default:r(()=>[s(B,{value:t(c).device_group_name,"onUpdate:value":e[3]||(e[3]=a=>t(c).device_group_name=a),placeholder:t(n)("deviceGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(z,{label:t(n)("deviceGroup.descriptionLabel"),path:"description"},{default:r(()=>[s(B,{value:t(c).description,"onUpdate:value":e[4]||(e[4]=a=>t(c).description=a),placeholder:t(n)("deviceGroup.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),f("div",Pe,[s(v,{type:"primary",loading:t(d),onClick:T},{default:r(()=>[x(g(t(n)("deviceGroup.create")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])])}}}),De=ze(Se,[["__scopeId","data-v-8aa88ca5"]]);export{De as default};

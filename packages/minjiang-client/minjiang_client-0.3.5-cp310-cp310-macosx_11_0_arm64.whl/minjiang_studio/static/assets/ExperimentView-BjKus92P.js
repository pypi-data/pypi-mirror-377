import{d as A,e as z,f,h as r,aG as Bt,ae as qe,a2 as he,r as D,C as B,w as i,i as s,q as we,R as At,k as e,J as oe,I as ye,Y as zt,j as Se,a1 as St,aN as Ft,z as Me,c as Ve,Z as Mt,b0 as Ht,b as Ee,F as Qt,x as $,l as Vt,B as Et,p as E,t as p,o as Rt,aW as $t,aU as pe,$ as Jt,A as Lt,a4 as wt,N as ue,O as Gt,D as Wt,a7 as Kt,aX as Yt,V as Zt,a0 as Xt,b2 as yt,a8 as It,ad as me,aY as ea,aZ as ta,E as aa,a_ as ge,a$ as bt,aL as sa,K as _}from"./index-J5_wuFzQ.js";import{b as oa,c as na,e as la,f as ia,h as ra,s as ca,i as pa,d as ua,j as da,k as _a,g as fa}from"./exp-CY-VG9oB.js";import{A as kt,d as Ct,f as ma,F as qt}from"./FileSaver.min-19YhMP19.js";import{u as xa}from"./useInterval-DNMuo5vf.js";import{u as xe,n as va}from"./exp-BkI3wTfv.js";import{u as ga}from"./groupDetail-Ds_O6y5K.js";import{o as Ce,P as ha}from"./index-FTla-omU.js";import{D as wa,R as ya,E as Ia}from"./ExpsTpl-De6yTjBy.js";import{i as ba}from"./json-editor-vue-B6h867kq.js";import{_ as ka}from"./DynamicFormItem.vue_vue_type_script_setup_true_lang-Bgdb5gs3.js";import{_ as Ca,a as qa}from"./FormItem-cRlJVOXw.js";import{A as za}from"./Add-GkLiV60o.js";import{_ as Sa}from"./Alert-BAyZP53g.js";import{_ as Ma}from"./Badge-CDrYWspG.js";import{_ as Va,a as Ea}from"./Tabs-CR38P_Kp.js";import"./index-BypQeadj.js";import"./Copy16Filled-CVvtcQrC.js";import"./HandRight24Filled-jpv6sQr9.js";import"./Popconfirm-DjayWGkX.js";import"./task-B0ue0H1_.js";import"./DynamicForm.vue_vue_type_script_setup_true_lang-ERKaPvUp.js";import"./InputNumber-CR50tpzY.js";import"./Add-C8P6H80E.js";import"./debounce-COzzVebV.js";const Ra={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},$a=A({name:"AttachArrowRight20Filled",render:function(l,c){return f(),z("svg",Ra,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M5.28 10.609l5.304-5.304a2.75 2.75 0 0 1 4.064 3.697a5.487 5.487 0 0 1 1.611.285a4.252 4.252 0 0 0-6.736-5.042L4.22 9.548a.75.75 0 0 0 1.06 1.06zm2.829 4.95l.893-.894a5.48 5.48 0 0 0 .349 1.773l-.182.181A2.75 2.75 0 0 1 5.28 12.73l5.657-5.657a.75.75 0 1 1 1.06 1.06l-5.656 5.658a1.25 1.25 0 0 0 1.768 1.768zM19 14.5a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0zm-2.147.354l.003-.003a.499.499 0 0 0 .144-.348v-.006a.5.5 0 0 0-.146-.35l-2-2a.5.5 0 0 0-.708.707L15.293 14H12.5a.5.5 0 0 0 0 1h2.793l-1.147 1.146a.5.5 0 0 0 .708.708l2-2z",fill:"currentColor"})],-1)]))}}),La={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Da=A({name:"BookDatabase20Regular",render:function(l,c){return f(),z("svg",La,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M4 4v12a2 2 0 0 0 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2zm10-1a1 1 0 0 1 1 1v11H5V4a1 1 0 0 1 1-1h8zM8.483 6.345C8.126 6.552 8 6.787 8 7c0 .213.126.448.483.655C8.841 7.863 9.374 8 10 8c.626 0 1.159-.137 1.517-.345c.357-.207.483-.442.483-.655c0-.213-.126-.448-.483-.655C11.159 6.137 10.626 6 10 6c-.626 0-1.159.137-1.517.345zM12 8.531c-.544.31-1.254.469-2 .469c-.747 0-1.456-.16-2-.47V11c0 .123.107.365.496.607c.367.228.9.393 1.504.393s1.137-.165 1.504-.393c.389-.242.496-.484.496-.607V8.53zM7 7c0-.687.434-1.202.981-1.52C8.528 5.163 9.245 5 10 5c.755 0 1.472.163 2.019.48c.547.318.981.833.981 1.52v4c0 .627-.452 1.135-.968 1.456c-.538.334-1.256.544-2.032.544s-1.494-.21-2.032-.544C7.452 12.136 7 11.627 7 11V7z",fill:"currentColor"})],-1)]))}}),Oa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Dt=A({name:"Play24Regular",render:function(l,c){return f(),z("svg",Oa,c[0]||(c[0]=[r("g",{fill:"none"},[r("path",{d:"M7.608 4.615a.75.75 0 0 0-1.108.659v13.452a.75.75 0 0 0 1.108.659l12.362-6.726a.75.75 0 0 0 0-1.318L7.608 4.615zM5 5.274c0-1.707 1.826-2.792 3.325-1.977l12.362 6.726c1.566.853 1.566 3.101 0 3.953L8.325 20.702C6.826 21.518 5 20.432 5 18.726V5.274z",fill:"currentColor"})],-1)]))}}),Na={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Pa=A({name:"QuadrantPlot",render:function(l,c){return f(),z("svg",Na,c[0]||(c[0]=[Bt('<path d="M30 15H17V2h-2v13H2v2h13v13h2V17h13v-2z" fill="currentColor"></path><path d="M5 30a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M8 8a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M22 13a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><circle cx="11" cy="11" r="2" fill="currentColor"></circle><circle cx="11" cy="21" r="2" fill="currentColor"></circle><circle cx="21" cy="21" r="2" fill="currentColor"></circle><circle cx="22" cy="28" r="2" fill="currentColor"></circle><circle cx="28" cy="24" r="2" fill="currentColor"></circle><circle cx="4" cy="11" r="2" fill="currentColor"></circle><circle cx="28" cy="4" r="2" fill="currentColor"></circle>',11)]))}}),Ta={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Ua=A({name:"ScriptReference",render:function(l,c){return f(),z("svg",Ta,c[0]||(c[0]=[r("path",{d:"M4 20v2h4.586L2 28.586L3.414 30L10 23.414V28h2v-8H4z",fill:"currentColor"},null,-1),r("path",{d:"M27.17 26l-2.58 2.58L26 30l4-4l-4-4l-1.42 1.41L27.17 26z",fill:"currentColor"},null,-1),r("path",{d:"M18.83 26l2.58-2.58L20 22l-4 4l4 4l1.42-1.41L18.83 26z",fill:"currentColor"},null,-1),r("path",{d:"M25.7 9.3l-7-7A.909.909 0 0 0 18 2H8a2.006 2.006 0 0 0-2 2v12h2V4h8v6a2.006 2.006 0 0 0 2 2h6v6h2v-8a.91.91 0 0 0-.3-.7zM18 10V4.4l5.6 5.6z",fill:"currentColor"},null,-1)]))}}),ja={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Ba=A({name:"BellOutlined",render:function(l,c){return f(),z("svg",ja,c[0]||(c[0]=[r("path",{d:"M816 768h-24V428c0-141.1-104.3-257.7-240-277.1V112c0-22.1-17.9-40-40-40s-40 17.9-40 40v38.9c-135.7 19.4-240 136-240 277.1v340h-24c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h216c0 61.8 50.2 112 112 112s112-50.2 112-112h216c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM512 888c-26.5 0-48-21.5-48-48h96c0 26.5-21.5 48-48 48zM304 768V428c0-55.6 21.6-107.8 60.9-147.1S456.4 220 512 220c55.6 0 107.8 21.6 147.1 60.9S720 372.4 720 428v340H304z",fill:"currentColor"},null,-1)]))}});function ze(g){var n,m,t,d,S,b,C,O,h,R,H,re,ce,N,M,Q,J,q,Z,U,G,W,K,T,F;const l=xe();l.expInfo=g.data,l.program={waveform_script:(m=(n=g.data)==null?void 0:n.exp)==null?void 0:m.waveform_script,space_parameter_script:(d=(t=g.data)==null?void 0:t.exp)==null?void 0:d.space_parameter_script},l.running={formValue:{title:(b=(S=g.data)==null?void 0:S.exp)==null?void 0:b.title,desc:(O=(C=g.data)==null?void 0:C.exp)==null?void 0:O.desc,...(R=(h=g.data)==null?void 0:h.exp)==null?void 0:R.options},paramsList:[]};const c=JSON.parse(JSON.stringify(l.allQubits));let I=[];qe((ce=(re=(H=g.data)==null?void 0:H.exp)==null?void 0:re.wave_circuit)==null?void 0:ce.gates,P=>{I=I.concat(P.entity)}),I.length>0&&c.forEach(P=>{I.includes(P.value)?P.visible=!0:P.visible=!1}),l.allQubits=c,he((Q=(M=(N=g.data)==null?void 0:N.exp)==null?void 0:M.wave_circuit)==null?void 0:Q.gates)||(l.gates=(Z=(q=(J=g.data)==null?void 0:J.exp)==null?void 0:q.wave_circuit)==null?void 0:Z.gates),he((W=(G=(U=g.data)==null?void 0:U.exp)==null?void 0:G.wave_circuit)==null?void 0:W.layers)||(l.layers=Object.values((F=(T=(K=g.data)==null?void 0:K.exp)==null?void 0:T.wave_circuit)==null?void 0:F.layers))}const Aa=A({__name:"MsgView",setup(g,{expose:l}){const c=xe(),I=D(!1),n=[{title:"Message Id",key:"message_id",width:100},{title:"Sub Process Id",key:"sub_process_id",width:130},{title:"Message Level",key:"message_level",width:130},{title:"Message",key:"message"},{title:"Timestamp",key:"timestamp",width:180,render:d=>d.timestamp?new Date(d.timestamp).toLocaleString():""}],m=d=>{d||t()},t=()=>{I.value=!1};return l({open:()=>I.value=!0,close:t}),(d,S)=>{const b=At,C=we,O=ye;return f(),B(O,{show:e(I),"onUpdate:show":S[0]||(S[0]=h=>oe(I)?I.value=h:null),"on-update:show":m},{default:i(()=>[s(C,{style:{width:"80vw"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true",class:"!pt-0"},{default:i(()=>{var h,R;return[s(b,{columns:n,data:(R=(h=e(c))==null?void 0:h.expInfo)==null?void 0:R.exp_msg,pagination:!1,"scroll-x":1e3,"max-height":"500px"},null,8,["data"])]}),_:1})]),_:1},8,["show"])}}}),Fa=A({__name:"TemplateData",props:{templateData:{}},setup(g,{expose:l}){const c=D(),I=zt(),n=D(!1);return l({open:()=>{n.value=!0}}),(t,d)=>{const S=Se,b=St,C=we,O=ye;return f(),B(O,{show:e(n),"onUpdate:show":d[0]||(d[0]=h=>oe(n)?n.value=h:null)},{default:i(()=>[s(C,{style:{width:"700px"},"aria-hidden":""},{default:i(()=>[d[1]||(d[1]=r("div",{class:"text-xl text-center"},"Template Data",-1)),s(S,{class:"!my-2"}),s(b,{style:{"max-height":"600px","min-height":"200px"}},{default:i(()=>[s(e(ba),{class:Ft(["w-full",[e(I).baseColor==="#000"?"jse-theme-dark":""]]),"model-value":t.templateData,mode:"text",ref_key:"jsonEditorRef",ref:c},null,8,["class","model-value"])]),_:1})]),_:1})]),_:1},8,["show"])}}}),Ha={key:1,class:"pr-3"},Qa={class:"mt-7 w-full flex"},Ja=A({__name:"ExpSubmit",setup(g){const l=xe(),c=Me(),I=Ve(),n=Mt(),{expInfo:m,layers:t,gates:d,program:S,expOptions:b,running:C}=Ht(l),O=D(),{t:h}=Ee(),R=D(!1),H=Qt(()=>{const N={title:{required:!0,message:h("common.required")},desc:{required:!0,message:h("common.required")},options:{required:!0,message:h("common.required")}};return Object.keys(b.value||[]).forEach(M=>{N[M]={required:!0,message:h("common.required")}}),N}),re=async()=>{var G,W,K,T,F,P,j,ne,Y,L,ve,de,X;if(R.value)return;R.value=!0;const N={};t.value.forEach((Ie,le)=>{N[String(le)]=Ie});const{title:M,desc:Q,...J}=(G=C.value)==null?void 0:G.formValue,q={template_name:(K=(W=m==null?void 0:m.value)==null?void 0:W.exp)==null?void 0:K.template.split("/")[1],device_group_name:c.query.device_group_name,space_id:c.query.space_id,task_id:(T=m.value)==null?void 0:T.task_id,experiment_json:{...m.value||{},title:M,desc:Q,template:(P=(F=m==null?void 0:m.value)==null?void 0:F.exp)==null?void 0:P.template,template_data:(ne=(j=m==null?void 0:m.value)==null?void 0:j.exp)==null?void 0:ne.template_data,wave_circuit:{gates:d.value||{},layers:N},waveform_script:((Y=S.value)==null?void 0:Y.waveform_script)||[],space_parameter_script:((L=S.value)==null?void 0:L.space_parameter_script)||[],options:J}};(ve=q==null?void 0:q.experiment_json)!=null&&ve.exp&&((de=q==null?void 0:q.experiment_json)==null||delete de.exp),(X=q==null?void 0:q.experiment_json)==null||delete X.nr;const[Z,U]=await oa(q);R.value=!1,!Z&&(U==null?void 0:U.status)===0&&(n.success("Experiment Running"),l.showPlotParamsModal=!1,I.replace({name:"finalSetting",query:{...c.query,exp_id:U.data.exp_id}}).then(()=>{window.location.reload()}))},ce=N=>{N||(l.showPlotParamsModal=!1)};return(N,M)=>{const Q=Vt,J=qa,q=St,Z=Se,U=Et,G=Ca,W=we,K=ye;return f(),B(K,{show:e(l).showPlotParamsModal,"onUpdate:show":M[2]||(M[2]=T=>e(l).showPlotParamsModal=T),onChange:ce},{default:i(()=>[s(W,{style:{width:"800px",position:"fixed",right:"50px",top:"50px"}},{default:i(()=>{var T,F;return[s(G,{model:e(C).formValue,rules:e(H),ref_key:"formRef",ref:O,class:"min-w-[340px]",disabled:!!((F=(T=e(l))==null?void 0:T.expInfo)!=null&&F.exp_id)},{default:i(()=>{var P,j,ne,Y;return[s(q,{style:{"max-height":"calc(100vh - 370px)","padding-right":"12px"}},{default:i(()=>[r("div",null,[s(J,{label:"Exp Title",path:"title"},{default:i(()=>[s(Q,{value:e(C).formValue.title,"onUpdate:value":M[0]||(M[0]=L=>e(C).formValue.title=L)},null,8,["value"])]),_:1}),s(J,{label:"Exp Desc",path:"desc"},{default:i(()=>[s(Q,{type:"textarea",value:e(C).formValue.desc,"onUpdate:value":M[1]||(M[1]=L=>e(C).formValue.desc=L)},null,8,["value"])]),_:1})]),e(b)?(f(),B(ka,{key:0,paramsCfg:e(b),"form-value":e(C).formValue},null,8,["paramsCfg","form-value"])):$("",!0)]),_:1}),(j=(P=e(l))==null?void 0:P.expInfo)!=null&&j.exp_id?$("",!0):(f(),B(Z,{key:0,class:"!mb-0"})),(Y=(ne=e(l))==null?void 0:ne.expInfo)!=null&&Y.exp_id?$("",!0):(f(),z("div",Ha,[r("div",Qa,[s(U,{type:"primary",size:"small",loading:e(R),onClick:re,class:"w-full flex-1"},{icon:i(()=>[s(e(Dt))]),default:i(()=>[E(" "+p(e(h)("expInfo.submit")),1)]),_:1},8,["loading"])])]))]}),_:1},8,["model","rules","disabled"])]}),_:1})]),_:1},8,["show"])}}}),Ga={class:"min-h-[98px] flex justify-between"},Wa={key:0,class:"flex flex-col pr-4 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},Ka={class:"text-xl font-bold mr-2"},Ya={class:"text-xl font-bold"},Za={class:"text-sm font-light mt-2 opacity-60"},Xa={class:"flex-1 flex"},es={class:"flex flex-col gap-1.5 min-w-[260px] pr-5 mr-5",style:{"border-right":"1px solid rgba(56, 137, 197, 0.35)"}},ts={class:"flex"},as={class:"inline-block pr-1"},ss={class:"font-bold"},os={class:"inline-flex items-center"},ns={class:"flex-1 flex gap-1.5 min-w-[260px]"},ls={class:"flex flex-col gap-1.5 flex-1"},is={class:"flex"},rs={key:0,class:"pr-1"},cs={class:"font-bold"},ps={class:"flex items-center"},us={key:0,class:"italic opacity-70 pr-1 text-xs"},ds={key:1,class:"italic pr-1 text-xs"},_s={key:2,class:"ml-1"},fs={class:"flex"},ms={key:1,class:"flex flex-col gap-2 min-w-52"},xs={class:"flex gap-4 justify-between"},vs={key:1},gs={class:"flex gap-2"},hs={class:"flex items-center gap-2"},ws={class:"text-lg mb-4 flex justify-between"},ys={class:"text-lg mb-4 flex justify-between"},Is={class:"relative"},bs=A({__name:"ExpInfoView",setup(g){const{t:l}=Ee(),c=zt(),I=Mt(),n=Me(),m=Ve(),t=xe(),d=ga(),S=D(),b=D(),C=()=>{var o,a,u;(a=(o=t.expInfo)==null?void 0:o.exp)!=null&&a.template&&((u=b.value)==null||u.open())},O=D(),h=async()=>{const o=n.query.device_group_name;if(!o)return;const[a,u]=await aa({device_group_name:o});if(!a&&(u==null?void 0:u.status)===0){const{space_list:x,...k}=u.data;d.groupInfo=k,d.spaceList=x.map(w=>({...w,label:w.space_name,value:w.space_id}))}},R=async()=>{var u;if(n.query.exp_id===void 0||n.query.exp_id==="")return;const[o,a]=await fa({exp_id:n.query.exp_id,device_group_name:n.query.device_group_name,space_id:n.query.space_id});!o&&(a==null?void 0:a.status)===0&&((u=a.data)!=null&&u.data&&(a.data.data=JSON.parse(a.data.data)),t.result=a.data)},H=async()=>{t.loading=!0;const{device_group_name:o,exp_id:a}=n.query;if(!o||!a){t.loading=!1;return}const[u,x]=await da({device_group_name:o,exp_id:a});t.loading=!1,!u&&(x==null?void 0:x.status)===0&&(ze(x),pe(()=>{n.query.dup&&(G(),pe(()=>{setTimeout(()=>{m.replace({name:"waveforms",query:Ce(n.query,"dup")})},300)}))}),R())},re=async()=>{var u;if((u=t==null?void 0:t.expInfo)!=null&&u.status&&[me.COMPLETE,me.CANCELED,me.ERROR].includes(t.expInfo.status)){M();return}if(!n.query.exp_id)return;const[o,a]=await _a({device_group_name:n.query.device_group_name,exp_id:n.query.exp_id});!o&&(a==null?void 0:a.status)===0&&(t.expInfo={...t.expInfo,...a.data||{}})},ce=async()=>{var u,x;const[o,a]=await na();if(!o&&(a==null?void 0:a.status)===0){const k={};Object.keys(a.data).forEach(ee=>{k[ee]=a.data[ee].default?a.data[ee].default:void 0});const w=(x=(u=t.expInfo)==null?void 0:u.exp)==null?void 0:x.options;t.expOptions=a.data,t.running={...t.running,formValue:{...t.running.formValue,...he(w)?k:{}}}}},{start:N,stop:M}=xa(re,{isManual:!0,duration:3*1e3}),Q=async()=>{const[o,a]=await la();!o&&(a==null?void 0:a.status)===0&&(t.waveCompiler=a.data)},J=async()=>{const[o,a]=await ia();!o&&(a==null?void 0:a.status)===0&&(t.waveFunctions=a.data)},q=async()=>{const[o,a]=await ra({device_group_name:n.query.device_group_name,space_id:n.query.space_id});if(!o&&(a==null?void 0:a.status)===0){let u=[];if(qe(a.data,(x,k)=>{u=u.concat(x.map((w,ee)=>({id:va(),value:w,visible:ee<10,type:k})))}),t.allQubits=u,!n.query.exp_id){const x=JSON.parse(JSON.stringify(t.allQubits));let k=[];qe(t==null?void 0:t.gates,w=>{k=k.concat(w.entity)}),k.length>0&&x.forEach(w=>{k.includes(w.value)?w.visible=!0:w.visible=!1}),t.allQubits=x;return}pe(()=>{H(),N()})}},Z=()=>{var o;(o=O.value)==null||o.open()},U=()=>{const o=new URLSearchParams({device_group_name:n.query.device_group_name,task_id:n.query.task_id,task_title:n.query.task_title,space_id:n.query.space_id,exp_id:n.query.exp_id,dup:String(1)});window.open(`/experiment/waveforms?${o.toString()}`,"_blank")},G=()=>{const o=JSON.parse(JSON.stringify(t.expInfo));delete o.exp_id,delete o.progress,delete o.status,delete o.exp_msg,t.expInfo=o,t.result=void 0,pe(()=>{I.success("Duplicated successfully"),m.replace({name:"waveforms",query:Ce(n.query,["exp_id"])})})},W=async()=>{const[o,a]=await ca({exp_id:n.query.exp_id});!o&&(a==null?void 0:a.status)===0&&I.success("实验终止成功")},K=()=>{var o;(o=S.value)==null||o.open()};Rt(()=>{if(ce(),q(),h(),setTimeout(()=>{Q(),J()},100),n.query.create=="1"){const o=$t("t");o&&(ze(o),pe(()=>{setTimeout(()=>{m.replace({name:"waveforms",query:Ce(n.query,"combine")}).then(()=>{localStorage.removeItem("t")})},200)}))}});const T=()=>{t.showPlotParamsModal=!0};Jt(M);const F=async()=>{var u,x;const[o,a]=await pa({group_name:n.query.device_group_name,exp_id:String((u=t==null?void 0:t.expInfo)==null?void 0:u.exp_id)});!o&&(a==null?void 0:a.status)===0&&qt.saveAs(`${ge(location.origin)}/${ge((x=a==null?void 0:a.data)==null?void 0:x.filename)}`,bt(a.data.filename))},P=async()=>{var u,x;const[o,a]=await ua({group_name:n.query.device_group_name,space_id:n.query.space_id,version:String((u=t.expInfo)==null?void 0:u.space_timestamp)});!o&&(a==null?void 0:a.status)===0&&qt.saveAs(`${ge(location.origin)}/${ge((x=a==null?void 0:a.data)==null?void 0:x.filename)}`,bt(a.data.filename))},j=D(!1),ne=o=>{o||(j.value=!1)},Y=D(),L=D(),ve=()=>{var o;(o=Y.value)==null||o.refresh()},de=()=>{j.value=!0},X=D(!1),Ie=o=>{o||(X.value=!1,L.value="")},le=D(!1),Ot=o=>{o||(le.value=!1)},Nt=()=>{var o;(o=t.expInfo)!=null&&o.exp_id?le.value=!0:X.value=!0};return(o,a)=>{const u=ue,x=Lt("router-link"),k=Kt,w=Et,ee=Yt,Pt=Zt,Tt=Ma,Ut=Sa,Re=Se,be=we,ke=ye,jt=Vt;return f(),z(wt,null,[s(Ut,{type:"info","show-icon":!1},{default:i(()=>{var V,te,ae,se,ie,_e,$e,Le,De,Oe,Ne,Pe,Te,Ue,je,Be,Ae,Fe,He,Qe,Je,Ge,We,Ke,Ye,Ze,Xe,et,tt,at,st,ot,nt,lt,it,rt,ct,pt,ut,dt,_t,ft,mt,xt,vt,gt;return[r("div",Ga,[(V=e(d))!=null&&V.groupInfo?(f(),z("div",Wa,[s(x,{class:"underline underline-offset-4 inline-flex items-center gap-0.5",to:{name:"deviceGroup",query:{org:(ae=(te=e(d))==null?void 0:te.groupInfo)==null?void 0:ae.organization_id}}},{default:i(()=>{var v;return[r("span",Ka,[s(u,{component:e(Gt)},null,8,["component"]),E(" "+p((v=e(d).groupInfo)==null?void 0:v.organization_name),1)])]}),_:1},8,["to"]),s(x,{class:"underline underline-offset-4 inline-flex items-center gap-0.5",to:{name:"taskList",query:{device_group_name:e(n).query.device_group_name}}},{default:i(()=>{var v,y;return[s(u,{component:e(Wt)},null,8,["component"]),r("span",Ya,p((y=(v=e(d))==null?void 0:v.groupInfo)==null?void 0:y.device_group_name),1)]}),_:1},8,["to"]),r("span",Za,p((ie=(se=e(d))==null?void 0:se.groupInfo)==null?void 0:ie.description),1)])):$("",!0),r("div",Xa,[(_e=e(t))!=null&&_e.expInfo?(f(),z(wt,{key:0},[r("div",es,[r("div",ts,[r("span",as,[s(k,{type:"success",size:"small",color:{color:"#ff5722",textColor:"#fff"}},{default:i(()=>{var v,y;return[E(p(e(l)("expInfo.task"))+" "+p((y=(v=e(t))==null?void 0:v.expInfo)==null?void 0:y.task_id),1)]}),_:1})]),s(x,{to:{name:"experimentList",query:{device_group_name:e(n).query.device_group_name,task_id:(Le=($e=e(t))==null?void 0:$e.expInfo)==null?void 0:Le.task_id,task_title:(Oe=(De=e(t))==null?void 0:De.expInfo)==null?void 0:Oe.task_title,space_id:e(n).query.space_id}},class:"underline underline-offset-4"},{default:i(()=>{var v,y;return[r("span",ss,p((y=(v=e(t))==null?void 0:v.expInfo)==null?void 0:y.task_title),1)]}),_:1},8,["to"]),s(w,{type:"primary",size:"small",class:"!ml-2 !h-[22px]",onClick:K},{icon:i(()=>[s(e(za))]),default:i(()=>[E(" "+p(e(l)("expInfo.create")),1)]),_:1})]),r("div",null,[r("span",os,[E(p(e(l)("expInfo.space"))+"： ",1),s(k,{size:"small",class:"!cursor-pointer",type:"warning",onClick:Nt},{default:i(()=>{var v,y,fe,ht;return[E(p((y=(v=e(t))==null?void 0:v.expInfo)==null?void 0:y.space_name)+" ( "+p((ht=(fe=e(t))==null?void 0:fe.expInfo)==null?void 0:ht.space_time_str)+" ) ",1)]}),_:1}),s(ee,{trigger:"hover"},{trigger:i(()=>[s(w,{type:"info",class:"!ml-1",size:"tiny",onClick:P},{icon:i(()=>[s(e(kt))]),_:1})]),default:i(()=>[E(" "+p(e(l)("expInfo.downloadSpaceParams")),1)]),_:1})])]),r("div",null,p((Pe=(Ne=e(t))==null?void 0:Ne.expInfo)==null?void 0:Pe.task_desc),1)]),r("div",ns,[(Te=e(t).result)!=null&&Te.small_picture_url?(f(),B(Pt,{key:0,src:e(yt)((Ue=e(t).result)==null?void 0:Ue.small_picture_url,"t",String(+new Date)),"preview-src":((je=e(t).result)==null?void 0:je.big_picture_url)||e(yt)((Be=e(t).result)==null?void 0:Be.small_picture_url,"t",String(+new Date)),alt:"",class:"mr-2 h-fit p-[1px] w-[100px]",style:Xt({border:`1px solid ${e(c).dividerColor}`})},null,8,["src","preview-src","style"])):$("",!0),r("div",ls,[r("div",is,[(Fe=(Ae=e(t))==null?void 0:Ae.expInfo)!=null&&Fe.exp_id?(f(),z("span",rs,[s(k,{color:{color:"#7816ff",textColor:"#fff"},size:"small"},{default:i(()=>{var v,y;return[E(p(e(l)("expInfo.exp"))+" "+p((y=(v=e(t))==null?void 0:v.expInfo)==null?void 0:y.exp_id),1)]}),_:1})])):$("",!0),r("span",cs,p((Qe=(He=e(t))==null?void 0:He.expInfo)==null?void 0:Qe.exp_title),1)]),r("div",ps,[(Je=e(t).expInfo)!=null&&Je.exp_id?(f(),z("span",us,p((We=(Ge=e(t))==null?void 0:Ge.expInfo)==null?void 0:We.create_time),1)):(f(),z("span",ds,[s(k,{size:"small",bordered:!1,color:{color:"#f00",textColor:"#fff"}},{default:i(()=>[E(p(e(l)("expInfo.unsumbit")),1)]),_:1})])),r("span",null,[s(k,{type:"warning",size:"small",onClick:C,class:"!cursor-pointer"},{default:i(()=>{var v,y,fe;return[E(p(((fe=(y=(v=e(t))==null?void 0:v.expInfo)==null?void 0:y.exp)==null?void 0:fe.template)||e(l)("expInfo.notpl")),1)]}),_:1})]),(Ye=(Ke=e(t))==null?void 0:Ke.expInfo)!=null&&Ye.source?(f(),z("span",_s,[s(k,{type:"info",size:"small",class:"!cursor-pointer"},{default:i(()=>{var v,y;return[E(p(e(l)("expInfo.source"))+": "+p((y=(v=e(t))==null?void 0:v.expInfo)==null?void 0:y.source),1)]}),_:1})])):$("",!0),(Ze=e(t).expInfo)!=null&&Ze.exp_id?(f(),B(ee,{key:3,trigger:"hover"},{trigger:i(()=>[s(w,{type:"info",class:"!ml-1",size:"tiny",onClick:F},{icon:i(()=>[s(e(kt))]),_:1})]),default:i(()=>[E(" "+p(e(l)("expInfo.downloadExp")),1)]),_:1})):$("",!0)]),r("div",fs,p((et=(Xe=e(t))==null?void 0:Xe.expInfo)==null?void 0:et.exp_desc),1)])])],64)):$("",!0)]),(tt=e(t))!=null&&tt.expInfo?(f(),z("div",ms,[r("div",xs,[(st=(at=e(t))==null?void 0:at.expInfo)!=null&&st.status?(f(),B(k,{key:0,color:{color:e(It)[e(t).expInfo.status].color,textColor:"#fff"},size:"small"},{default:i(()=>[E(p(e(l)(e(It)[e(t).expInfo.status].text)),1)]),_:1},8,["color"])):$("",!0),(nt=(ot=e(t))==null?void 0:ot.expInfo)!=null&&nt.progress?(f(),z("span",vs,p((it=(lt=e(t))==null?void 0:lt.expInfo)==null?void 0:it.progress),1)):$("",!0),s(Tt,{value:(ct=(rt=e(t).expInfo)==null?void 0:rt.exp_msg)==null?void 0:ct.length,max:15,class:"cursor-pointer",onClick:Z},{default:i(()=>[s(u,{size:22},{default:i(()=>[s(e(Ba))]),_:1})]),_:1},8,["value"])]),r("div",gs,[s(w,{type:"info",size:"small",class:"flex-1",onClick:U,disabled:((dt=(ut=(pt=e(t))==null?void 0:pt.expInfo)==null?void 0:ut.exp)==null?void 0:dt.exp_mode)==="batch_circuit"||!e(n).query.exp_id},{icon:i(()=>[s(e(wa))]),default:i(()=>[E(p(e(l)("expInfo.duplicate"))+" ",1)]),_:1},8,["disabled"]),s(w,{type:"info",size:"small",class:"flex-1",disabled:![e(me).RUNNING,e(me).HOST_DOWNLOADED].includes((_t=e(t).expInfo)==null?void 0:_t.status),onClick:W},{icon:i(()=>[s(e(ya))]),default:i(()=>[E(p(e(l)("expInfo.stop"))+" ",1)]),_:1},8,["disabled"])]),r("div",hs,[s(w,{class:"flex-1",type:"primary",size:"small",onClick:T,disabled:!!((mt=(ft=e(t))==null?void 0:ft.expInfo)!=null&&mt.exp_id)},{icon:i(()=>[s(e(Dt))]),default:i(()=>[E(p(e(l)("expInfo.run"))+" ",1)]),_:1},8,["disabled"])])])):$("",!0),s(Aa,{ref_key:"msgViewRef",ref:O},null,512)]),s(Ia,{ref_key:"expsTplRef",ref:S},null,512),s(Fa,{ref_key:"tempalteDataRef",ref:b,"template-data":(gt=(vt=(xt=e(t))==null?void 0:xt.expInfo)==null?void 0:vt.exp)==null?void 0:gt.template_data},null,8,["template-data"]),s(Ja)]}),_:1}),s(ke,{show:e(le),"onUpdate:show":[a[0]||(a[0]=V=>oe(le)?le.value=V:null),Ot],size:"huge"},{default:i(()=>[s(be,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:i(()=>{var V,te,ae,se,ie,_e;return[r("div",ws,[r("div",null,p(e(l)("expInfo.space"))+"： "+p((te=(V=e(t))==null?void 0:V.expInfo)==null?void 0:te.space_name)+" ( "+p((se=(ae=e(t))==null?void 0:ae.expInfo)==null?void 0:se.space_time_str)+" ) ",1)]),s(Re,{class:"!my-4"}),e(n).query.space_id?(f(),B(Ct,{key:0,ref_key:"paramsLatestRef",ref:Y,"max-height":"65vh","read-only":"",version:(_e=(ie=e(t))==null?void 0:ie.expInfo)==null?void 0:_e.space_timestamp,"space-id":+e(n).query.space_id},null,8,["version","space-id"])):$("",!0)]}),_:1})]),_:1},8,["show"]),s(ke,{show:e(X),"onUpdate:show":[a[2]||(a[2]=V=>oe(X)?X.value=V:null),Ie],size:"huge"},{default:i(()=>[s(be,{style:{"min-height":"82vh",overflow:"auto",width:"1200px","min-width":"500px"}},{default:i(()=>{var V,te,ae,se;return[r("div",ys,[r("div",null,p(e(l)("expInfo.space"))+"： "+p((te=(V=e(t))==null?void 0:V.expInfo)==null?void 0:te.space_name)+" ( "+p((se=(ae=e(t))==null?void 0:ae.expInfo)==null?void 0:se.space_time_str)+" ) ",1),r("div",Is,[s(jt,{style:{width:"310px","padding-right":"20px"},value:e(L),"onUpdate:value":a[1]||(a[1]=ie=>oe(L)?L.value=ie:null),valueModifiers:{trim:!0},onKeyup:ea(de,["enter"]),placeholder:e(l)("groupDetail.parameterManager.searchPlaceholder")},null,8,["value","placeholder"]),r("div",{class:"absolute -right-4 top-1/2 -translate-1/2 h-full w-8 flex items-center justify-center cursor-pointer",onClick:de},[s(u,{color:e(c).primaryColor,component:e(ta)},null,8,["color","component"])])])]),s(Re,{class:"!my-4"}),e(n).query.space_id?(f(),B(Ct,{key:0,ref_key:"paramsLatestRef",ref:Y,"max-height":"65vh","space-id":+e(n).query.space_id},null,8,["space-id"])):$("",!0)]}),_:1})]),_:1},8,["show"]),s(ke,{show:e(j),"onUpdate:show":a[4]||(a[4]=V=>oe(j)?j.value=V:null),size:"huge",onUpdateShow:ne},{default:i(()=>[s(be,{style:{"min-height":"82vh",overflow:"auto",width:"1300px","max-width":"95vw","min-width":"500px"}},{default:i(()=>[e(n).query.space_id?(f(),B(ma,{key:0,search:"","space-id":+e(n).query.space_id,"hide-history-option":"",modelValue:e(L),"onUpdate:modelValue":a[3]||(a[3]=V=>oe(L)?L.value=V:null),onRefresh:ve},null,8,["space-id","modelValue"])):$("",!0)]),_:1})]),_:1},8,["show"])],64)}}}),ks={class:"flex mt-5"},Cs={class:"ml-5 flex-1"},Ks=A({__name:"ExperimentView",setup(g){const{t:l}=Ee(),c=Me(),I=Ve(),n=xe(),m=D(),t=d=>{I.push({name:d,query:c.query})};return sa(c,d=>{m.value=d.name},{deep:!0,immediate:!0}),Rt(()=>{const d=$t("t");he(d)||(n.reset(),pe(()=>{ze(d),localStorage.removeItem("t")}))}),(d,S)=>{const b=Va,C=Ea,O=Lt("router-view");return f(),z("div",null,[s(bs),r("div",ks,[s(C,{type:"card",animated:"",placement:"left",class:"!h-full !w-auto",value:e(m),"onUpdate:value":S[0]||(S[0]=h=>oe(m)?m.value=h:null),onUpdateValue:t},{default:i(()=>{var h,R,H;return[s(b,{name:"waveforms",tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(ha))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.waveforms"))])])},null,8,["tab"]),s(b,{name:"program",tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(Ua))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.program"))])])},null,8,["tab"]),s(b,{name:"finalSetting",disabled:!((h=e(n).expInfo)!=null&&h.exp_id),tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(Pa))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.plotter"))])])},null,8,["disabled","tab"]),s(b,{name:"result",disabled:!((R=e(n).expInfo)!=null&&R.exp_id),tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e(Da))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.fitting"))])])},null,8,["disabled","tab"]),s(b,{name:"attachment",disabled:!((H=e(n).expInfo)!=null&&H.exp_id),tab:_("div",{class:"flex items-center gap-2"},[_("div",{class:"flex items-center"},_(e(ue),{size:20},{default:()=>_(e($a))})),_("div",[_("div",{class:"font-bold"},e(l)("expInfo.attachment"))])])},null,8,["disabled","tab"])]}),_:1},8,["value"]),r("div",Cs,[s(O)])])])}}});export{Ks as default};

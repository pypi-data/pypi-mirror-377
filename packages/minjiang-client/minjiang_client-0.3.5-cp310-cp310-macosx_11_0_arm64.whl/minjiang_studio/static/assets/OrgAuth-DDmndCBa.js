import{d as I,r as d,b as M,o as $,C as L,f as w,I as H,k as e,J as K,w as o,i as n,q as j,h as C,l as G,m as J,B as A,p as v,t as u,cE as Y,cF as P,c as Q,Y as W,e as R,x as X,cz as Z,a4 as ee,a5 as ne,a6 as oe,a0 as V,cG as se,N as te,O as ae,a7 as le,a3 as re,cH as ie,aU as ce}from"./index-J5_wuFzQ.js";import{_ as _e,a as ue}from"./FormItem-cRlJVOXw.js";import{_ as T}from"./Space-CHofMqF1.js";import{A as de}from"./Add-GkLiV60o.js";import{U as B}from"./UserMultiple-Dbyrrw7n.js";const me={class:"flex justify-end"},pe=I({__name:"OrgModal",props:{type:{}},emits:["success"],setup(D,{expose:N,emit:O}){const m=d(),{t:l}=M(),y=O,b=d(!1),p=d(!1),h=()=>{p.value=!1,t.value={name:void 0,user_ids:void 0,admin_ids:void 0}},U=()=>{p.value=!0},c=d({name:{required:!0,message:l("common.required")},user_ids:{required:!0,message:l("common.required")},admin_ids:{required:!0,message:l("common.required")}}),r=d(null),t=d({name:void 0,user_ids:void 0,admin_ids:void 0}),x=()=>{var i;(i=r.value)==null||i.validate(async s=>{if(s)return;const[f,a]=await Y(t.value);!f&&(a==null?void 0:a.status)===0&&(y("success"),h())})},q=async()=>{var f;const[i,s]=await P();!i&&(s==null?void 0:s.status)===0&&(m.value=(f=s.data)==null?void 0:f.map(a=>({...a,label:a.user_name,value:a.user_id})))};return $(()=>{q()}),N({open:U,close:h}),(i,s)=>{const f=G,a=ue,k=J,z=_e,_=A,S=T,E=j,F=H;return w(),L(F,{show:e(p),"onUpdate:show":s[3]||(s[3]=g=>K(p)?p.value=g:null),"mask-closable":!1,"close-on-esc":!1},{default:o(()=>[n(E,{bordered:!1,"content-class":"!px-5",style:{width:"700px"}},{default:o(()=>[n(z,{ref_key:"formRef",ref:r,model:e(t),rules:e(c),size:"small"},{default:o(()=>[n(a,{label:e(l)("org.orgName"),path:"name"},{default:o(()=>[n(f,{disabled:i.type==="edit",value:e(t).name,"onUpdate:value":s[0]||(s[0]=g=>e(t).name=g)},null,8,["disabled","value"])]),_:1},8,["label"]),n(a,{label:e(l)("org.admin"),path:"admin_ids"},{default:o(()=>[n(k,{value:e(t).admin_ids,"onUpdate:value":s[1]||(s[1]=g=>e(t).admin_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"]),n(a,{label:e(l)("org.member"),path:"user_ids"},{default:o(()=>[n(k,{value:e(t).user_ids,"onUpdate:value":s[2]||(s[2]=g=>e(t).user_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),C("div",me,[n(S,null,{default:o(()=>[n(_,{onClick:h,loading:e(b)},{default:o(()=>[v(u(e(l)("common.cancel")),1)]),_:1},8,["loading"]),n(_,{type:"primary",onClick:x,loading:e(b)},{default:o(()=>[v(u(e(l)("common.OK")),1)]),_:1},8,["loading"])]),_:1})])]),_:1})]),_:1},8,["show"])}}}),fe=["onClick"],ge={class:"flex items-center gap-1"},ve={class:"flex items-center gap-1"},we=I({__name:"OrgAuth",setup(D){const N=Q(),O=W(),{t:m}=M(),l=d(),y=d(),b=d(),p=async()=>{var t;const[c,r]=await ie();!c&&(r==null?void 0:r.status)===0&&(b.value=(t=r==null?void 0:r.data)==null?void 0:t.organizations)},h=()=>{y.value={type:"insert",show:!0},ce(()=>{var c;(c=l.value)==null||c.open()})},U=c=>{N.push({name:"org",query:{id:c}})};return $(()=>{p()}),(c,r)=>{var k,z;const t=A,x=te,q=se,i=le,s=T,f=oe,a=re;return w(),R("div",null,[n(Z,{title:e(m)("org.orgList")},{extra:o(()=>[n(t,{type:"primary",onClick:h},{icon:o(()=>[n(e(de))]),default:o(()=>[v(" "+u(e(m)("org.createOrg")),1)]),_:1})]),_:1},8,["title"]),n(a,{cols:4,"x-gap":16,"y-gap":16},{default:o(()=>[(w(!0),R(ee,null,ne(e(b),_=>(w(),L(f,{key:_.organization_id},{default:o(()=>[C("div",{class:"border rounded-xl cursor-pointer",style:V({borderColor:e(O).dividerColor}),onClick:()=>U(_.organization_id)},[n(q,{class:"px-3 py-2 min-h-20 flex items-center"},{default:o(()=>[n(x,{class:"mr-1",component:e(ae)},null,8,["component"]),v(" "+u(_.organization_name),1)]),_:2},1024),C("div",{class:"px-2 py-3 border-t",style:V({borderColor:e(O).dividerColor})},[n(s,null,{default:o(()=>[n(i,{bordered:!1,type:"success",round:""},{default:o(()=>[v(" ID "+u(_.organization_id),1)]),_:2},1024),n(i,{bordered:!1,type:"warning",round:""},{default:o(()=>[C("div",ge,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(_.member_count)+" "+u(e(m)("org.cmember")),1)])]),_:2},1024),n(i,{bordered:!1,type:"info",round:""},{default:o(()=>[C("div",ve,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(_.device_count)+" "+u(e(m)("org.cdevice")),1)])]),_:2},1024)]),_:2},1024)],4)],12,fe)]),_:2},1024))),128))]),_:1}),(k=e(y))!=null&&k.show?(w(),L(pe,{key:0,type:(z=e(y))==null?void 0:z.type,ref_key:"orgModalRef",ref:l,onSuccess:p},null,8,["type"])):X("",!0)])}}});export{we as default};

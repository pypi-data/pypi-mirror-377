import{P as ae,u as J,G as se,d as ee,e as X,f as U,h as W,bj as ce,bk as Pe,i as h,w as M,a9 as Ue,aa as Ke,E as D,s as ie,z as Y,t as le,B as G,l as a,K as Ne,b as me,bl as xe,a3 as be,C as ve,r as E,aT as ze,Q as r,N as Z,ae as ge,R as Ge,S as Xe,aQ as pe,D as Je,U as Ce,V as Qe,M as de,L as ye,v as he,a2 as Ae,bm as N,J as Oe,k as We,m as Ye,p as Ze,bn as Ie,n as He,b5 as De,aR as et,aO as tt,ac as Fe,a7 as Te,bo as nt,o as at,aY as ot,b0 as st,b1 as rt,aX as re}from"./index-BRYl8bDl.js";import{a as it,_ as lt}from"./Tabs-BbQfpjxR.js";import{m as ut}from"./exp-CxwoNyZY.js";import{c as fe}from"./index-DxlcEGoi.js";import{C as ne}from"./Copy16Filled-gCrD6fhX.js";import{H as qe}from"./HandRight24Filled-emh13RDg.js";import{_ as Me}from"./Popconfirm-FEI9-H1i.js";import{i as ct}from"./json-editor-vue-BmtN2Xe8.js";import{N as pt}from"./Switch-Djz7O8eH.js";function dt(y){return ae(J.getParamsByTree,y)}function Ve(y){return ae(J.submitParams,y)}function $e(y){return ae(J.removeParams,y)}function ft(y){return se(J.getHistoryParams,y)}function mt(y){return se(J.searchSpaceParameters,y)}function qt(){return se(J.getSpaceInitializerList)}function Vt(y){return se(J.getSpaceInitializerSetup,y)}function $t(y){return ae(J.spaceInitializerPreview,y)}function Bt(y){return ae(J.submitInitializerPreview,y)}function Kt(y){return ae(J.insertSpace,y)}function Nt(y){return se(J.getSpaceAbstract,y)}const vt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},ke=ee({name:"AddCircle16Filled",render:function(B,_){return U(),X("svg",vt,_[0]||(_[0]=[W("g",{fill:"none"},[W("path",{d:"M2 8a6 6 0 1 1 12 0A6 6 0 0 1 2 8zm6-3a.5.5 0 0 0-.5.5v2h-2a.5.5 0 0 0 0 1h2v2a.5.5 0 0 0 1 0v-2h2a.5.5 0 0 0 0-1h-2v-2A.5.5 0 0 0 8 5z",fill:"currentColor"})],-1)]))}}),yt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Gt=ee({name:"ArrowDownload24Filled",render:function(B,_){return U(),X("svg",yt,_[0]||(_[0]=[W("g",{fill:"none"},[W("path",{d:"M5.25 20.5h13.498a.75.75 0 0 1 .101 1.494l-.101.006H5.25a.75.75 0 0 1-.102-1.493l.102-.007h13.498H5.25zm6.633-18.497L12 1.996a1 1 0 0 1 .993.883l.007.117v12.59l3.294-3.293a1 1 0 0 1 1.32-.083l.094.083a1 1 0 0 1 .083 1.32l-.083.095l-4.997 4.996a1 1 0 0 1-1.32.084l-.094-.083l-5.004-4.997a1 1 0 0 1 1.32-1.498l.094.083L11 15.58V2.996a1 1 0 0 1 .883-.993L12 1.996l-.117.007z",fill:"currentColor"})],-1)]))}}),ht={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},we=ee({name:"RefreshCircle",render:function(B,_){return U(),X("svg",ht,_[0]||(_[0]=[W("path",{d:"M256 48C141.31 48 48 141.32 48 256c0 114.86 93.14 208 208 208c114.69 0 208-93.31 208-208c0-114.87-93.13-208-208-208zm0 313a94 94 0 0 1 0-188h4.21l-14.11-14.1a14 14 0 0 1 19.8-19.8l40 40a14 14 0 0 1 0 19.8l-40 40a14 14 0 0 1-19.8-19.8l18-18c-2.38-.1-5.1-.1-8.1-.1a66 66 0 1 0 66 66a14 14 0 0 1 28 0a94.11 94.11 0 0 1-94 94z",fill:"currentColor"},null,-1)]))}}),_t={class:"flex justify-between items-center gap-2"},gt={key:0},kt={key:0,class:"flex justify-center w-full"},wt=ee({__name:"CategoryTabs",props:ce({readOnly:{type:Boolean},tabs:{}},{modelValue:{},modelModifiers:{}}),emits:ce(["insert","refresh"],["update:modelValue"]),setup(y,{emit:B}){const _=B,g=Pe(y,"modelValue"),I=(v="")=>{_("insert",{full_key:v})},C=()=>{_("refresh")};return(v,z)=>{const w=G,i=lt,l=it;return U(),X("div",null,[h(l,{type:"card",placement:"left",value:g.value,"onUpdate:value":z[1]||(z[1]=o=>g.value=o),class:"tabs",style:{"max-height":"calc(100vh - 340px)"}},{suffix:M(()=>[v.readOnly?Y("",!0):(U(),X("div",kt,[h(w,{type:"info",quaternary:"",onClick:z[0]||(z[0]=()=>I()),size:"small"},{icon:M(()=>[h(a(ke))]),_:1}),h(w,{type:"info",quaternary:"",onClick:C,size:"small"},{icon:M(()=>[h(a(we))]),_:1})]))]),default:M(()=>[(U(!0),X(Ue,null,Ke(v.tabs,(o,d)=>(U(),D(i,{name:o.node_name,class:"!flex-1 w-full",key:d},{default:M(()=>[W("div",_t,[ie(le(o.node_name)+" ",1),v.readOnly?Y("",!0):(U(),X("div",gt,[h(w,{type:"info",quaternary:"",onClick:()=>I(o.full_key),size:"small"},{icon:M(()=>[h(a(ke))]),_:2},1032,["onClick"]),h(w,{type:"info",quaternary:"",onClick:C,size:"small"},{icon:M(()=>[h(a(we))]),_:1})]))])]),_:2},1032,["name"]))),128))]),_:1},8,["value"])])}}}),xt=Ne(wt,[["__scopeId","data-v-6fd4e427"]]),Se=ee({__name:"ParamsHistory",props:{spaceId:{},hkey:{},maxHeight:{},hideHistoryOption:{type:Boolean},hideRevertOption:{type:Boolean}},emits:["update:success","close:modal"],setup(y,{expose:B,emit:_}){const g=y,I=_,{t:C}=me(),{copy:v,isSupported:z}=xe({legacy:!0}),w=be(),i=ve(),l=E(),o=E({show:!1,info:{k_full:void 0}}),d=async f=>{v(f),w.success(C("common.copied"))},x=ze(async f=>{const[O,R]=await Ve({keys:[f.k_full],values:[f.v],types:[f.t],device_group_name:i.query.device_group_name,space_id:g.spaceId});if(!O&&(R==null?void 0:R.status)===0){w.success(C("groupDetail.parameterManager.revertSuccess"));const m=f.k_full.replace(/(.*)\/.*$/,"$1").split("/");I("update:success",fe(m),!1),A()}},300),q=ze(f=>{o.value={show:!0,info:f}},300),T=[{title:C("groupDetail.parameterManager.keyPath"),key:"k_full",render:f=>r("div",{class:"inline-flex gap-2"},[r("div",f.k_full),z.value?r(Z,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>{d(f.k_full)}},{default:()=>r(ne)}):void 0])},{title:C("groupDetail.parameterManager.dataType"),key:"t",width:100},{title:C("groupDetail.parameterManager.value"),key:"v",render:f=>{if(f.v)return r("div",{class:"flex gap-2"},[r(ge,{tooltip:{show:!1}},{default:()=>f.v}),z.value?r(Z,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>{d(f.v)}},{default:()=>r(ne)}):void 0])}},{title:C("groupDetail.parameterManager.time"),key:"timestamp",width:180},{title:C("createuser"),key:"user_name"},{title:C("groupDetail.parameterManager.options"),key:"options",width:!g.hideHistoryOption&&!g.hideRevertOption?160:90,align:"center",render:f=>r("div",{class:"flex justify-center"},fe([g.hideRevertOption?null:r(Me,{onPositiveClick:()=>x(f),placement:"left"},{default:()=>C("groupDetail.parameterManager.revertConfirm"),trigger:()=>r(G,{quaternary:!0,type:"info",size:"small"},{default:()=>C("groupDetail.parameterManager.optionRevert")})}),g.hideHistoryOption?void 0:r(G,{size:"small",type:"info",quaternary:!0,onClick:()=>q(f)},{default:()=>C("groupDetail.parameterManager.optionHistory")})]))}],K=f=>({class:f.deleted_flag?"removed":""}),S=Ge({page:1,per_page:Xe,total:0}),A=async()=>{const f=i.query.device_group_name;if(!g.spaceId||!f)return;const[O,R]=await ft({device_group_name:f,space_id:g.spaceId,key:g.hkey,page:S.page,per_page:S.per_page});!O&&(R==null?void 0:R.status)===0&&(l.value=R.data.list,S.total=R.data.total)};pe(()=>g.spaceId,f=>{f&&A()},{immediate:!0}),B({refresh:A});const j=f=>{f||(o.value={show:!1,info:{k_full:void 0}},I("close:modal"))};return(f,O)=>{const R=Ce,m=Je("params-history",!0),s=he,u=ye;return U(),X("div",null,[h(R,{columns:T,data:a(l),pagination:!1,"row-props":K,"max-height":f.maxHeight||"calc(100vh - 420px)"},null,8,["data","max-height"]),h(Qe,{"page-info":a(S),"onUpdate:pageInfo":O[0]||(O[0]=b=>de(S)?S.value=b:null),onUpdateList:A},null,8,["page-info"]),h(u,{show:a(o).show,"onUpdate:show":O[1]||(O[1]=b=>a(o).show=b),size:"huge",onUpdateShow:j},{default:M(()=>[h(s,{style:{"min-height":"400px",overflow:"auto",width:"1200px","min-width":"500px"}},{default:M(()=>{var b;return[h(m,{"max-height":f.maxHeight,"space-id":f.spaceId,hkey:(b=a(o).info)==null?void 0:b.k_full,"hide-history-option":!0,"hide-revert-option":f.hideRevertOption,"onUpdate:success":A},null,8,["max-height","space-id","hkey","hide-revert-option"])]}),_:1})]),_:1},8,["show"])])}}}),bt={class:"flex gap-5"},Ct={class:"float-right"},Be=ee({__name:"ParamsAction",props:{info:{},spaceId:{},actionTye:{},hideParentTree:{type:Boolean},showHistoryEntry:{type:Boolean}},emits:["update:success","ok","update:hisotry:success"],setup(y,{expose:B,emit:_}){const{t:g}=me(),I=ve(),C=Ae(),v=E(!1),z=E(!1),w=y,i=_,l=E(null),o=E({types:N.str,keys:void 0,values:void 0}),d=E({keys:{required:!0},values:{required:!0},types:{required:!0}}),x=[N.float,N.str,N.int,N.complex],q=[N.list,N.tuple,N.dict,N.ndarray],T=()=>{z.value=!1,o.value={types:N.str,keys:void 0,values:void 0}},K=s=>{s||(o.value={types:N.str,keys:void 0,values:void 0})},S=Oe(()=>{var s,u;if((s=o.value)!=null&&s.types)return(u=o.value)==null?void 0:u.types}),A=()=>{var s;v.value||(v.value=!0,(s=l.value)==null||s.validate(async u=>{var k;if(u){v.value=!1;return}if(w.actionTye==="custom"){i("ok",o.value),T(),v.value=!1;return}const{keys:b,values:V,types:Q}=o.value,[t,c]=await Ve({keys:[`${f.value}/${b}`],values:[V||""],types:[Q],device_group_name:I.query.device_group_name,space_id:w.spaceId});v.value=!1,!t&&(c==null?void 0:c.status)===0&&(T(),i("update:success",((k=f.value)==null?void 0:k.split("/"))||[]))}))},j=s=>{o.value=s},f=Oe(()=>{var s,u,b,V;return((s=w.info)==null?void 0:s.type)==="add"?(u=w.info)==null?void 0:u.full_key:(V=(b=w.info)==null?void 0:b.full_key)==null?void 0:V.replace(/(.*)\/.*$/,"$1")}),O=E(!1),R=()=>{O.value=!0},m=()=>{i("update:success")};return pe(O,s=>{s&&T()}),B({open:()=>z.value=!0,close:T,setFormValue:j}),(s,u)=>{const b=Ze,V=Ye,Q=He,t=pt,c=G,k=We,P=he,e=ye;return U(),X(Ue,null,[h(e,{show:a(z),"onUpdate:show":u[5]||(u[5]=n=>de(z)?z.value=n:null),size:"huge",onUpdateShow:K},{default:M(()=>[h(P,{style:{"min-height":"400px",overflow:"auto",width:"800px","min-width":"500px"}},{default:M(()=>[h(k,{model:a(o),rules:a(d),ref_key:"formRef",ref:l},{default:M(()=>[W("div",bt,[h(V,{label:"Type",path:"types",class:"w-40"},{default:M(()=>[h(b,{options:a(Ie),value:a(o).types,"onUpdate:value":u[0]||(u[0]=n=>a(o).types=n)},null,8,["options","value"])]),_:1}),h(V,{label:"Key",path:"keys",class:"flex-1"},{default:M(()=>{var n;return[h(Q,{value:a(o).keys,"onUpdate:value":u[1]||(u[1]=p=>a(o).keys=p),disabled:((n=s.info)==null?void 0:n.type)==="edit"},De({_:2},[s.hideParentTree?void 0:{name:"prefix",fn:M(()=>[ie(le(a(f))+"/ ",1)]),key:"0"}]),1032,["value","disabled"])]}),_:1})]),h(V,{label:"Value",path:"values"},{default:M(()=>[a(S)&&x.includes(a(S))?(U(),D(Q,{key:0,value:a(o).values,"onUpdate:value":u[2]||(u[2]=n=>a(o).values=n)},null,8,["value"])):Y("",!0),a(S)&&a(S)===a(N).bool?(U(),D(t,{key:1,value:a(o).values,"onUpdate:value":u[3]||(u[3]=n=>a(o).values=n)},null,8,["value"])):Y("",!0),a(S)&&q.includes(a(S))?(U(),D(a(ct),{key:2,class:et(["w-full max-h-[65vh] overflow-auto",[a(C).baseColor==="#000"?"jse-theme-dark":""]]),modelValue:a(o).values,"onUpdate:modelValue":u[4]||(u[4]=n=>a(o).values=n),mode:"text"},null,8,["class","modelValue"])):Y("",!0)]),_:1}),W("div",Ct,[s.showHistoryEntry?(U(),D(c,{key:0,type:"info",class:"!mr-2",onClick:R},{default:M(()=>[ie(le(a(g)("groupDetail.parameterManager.history")),1)]),_:1})):Y("",!0),h(c,{type:"primary",loading:a(v),onClick:A},{default:M(()=>[ie(le(a(g)("common.OK")),1)]),_:1},8,["loading"])])]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["show"]),h(e,{show:a(O),"onUpdate:show":u[7]||(u[7]=n=>de(O)?O.value=n:null),size:"huge"},{default:M(()=>[h(P,{style:{"min-height":"400px",overflow:"auto",width:"1000px","min-width":"500px"}},{default:M(()=>{var n;return[h(Se,{"max-height":"auto","space-id":s.spaceId?Number(s.spaceId):void 0,hkey:(n=s.info)==null?void 0:n.full_key,"hide-history-option":"","onClose:modal":u[6]||(u[6]=()=>O.value=!1),"onUpdate:success":m},null,8,["space-id","hkey"])]}),_:1})]),_:1},8,["show"])],64)}}});var _e,Ee;function It(){if(Ee)return _e;Ee=1;var y=9007199254740991,B="[object Arguments]",_="[object Function]",g="[object GeneratorFunction]",I=/^(?:0|[1-9]\d*)$/;function C(e,n){for(var p=-1,H=e?e.length:0;++p<H&&n(e[p],p,e)!==!1;);return e}function v(e,n){for(var p=-1,H=Array(e);++p<e;)H[p]=n(p);return H}function z(e,n){return function(p){return e(n(p))}}var w=Object.prototype,i=w.hasOwnProperty,l=w.toString,o=w.propertyIsEnumerable,d=z(Object.keys,Object);function x(e,n){var p=s(e)||m(e)?v(e.length,String):[],H=p.length,L=!!H;for(var $ in e)i.call(e,$)&&!(L&&($=="length"||f($,H)))&&p.push($);return p}var q=A(K),T=j();function K(e,n){return e&&T(e,n,k)}function S(e){if(!O(e))return d(e);var n=[];for(var p in Object(e))i.call(e,p)&&p!="constructor"&&n.push(p);return n}function A(e,n){return function(p,H){if(p==null)return p;if(!u(p))return e(p,H);for(var L=p.length,$=-1,F=Object(p);++$<L&&H(F[$],$,F)!==!1;);return p}}function j(e){return function(n,p,H){for(var L=-1,$=Object(n),F=H(n),te=F.length;te--;){var oe=F[++L];if(p($[oe],oe,$)===!1)break}return n}}function f(e,n){return n=n??y,!!n&&(typeof e=="number"||I.test(e))&&e>-1&&e%1==0&&e<n}function O(e){var n=e&&e.constructor,p=typeof n=="function"&&n.prototype||w;return e===p}function R(e,n){var p=s(e)?C:q;return p(e,typeof n=="function"?n:P)}function m(e){return b(e)&&i.call(e,"callee")&&(!o.call(e,"callee")||l.call(e)==B)}var s=Array.isArray;function u(e){return e!=null&&Q(e.length)&&!V(e)}function b(e){return c(e)&&u(e)}function V(e){var n=t(e)?l.call(e):"";return n==_||n==g}function Q(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=y}function t(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function c(e){return!!e&&typeof e=="object"}function k(e){return u(e)?x(e):S(e)}function P(e){return e}return _e=R,_e}var Mt=It();const Le=tt(Mt),St={class:"flex gap-5"},Xt=ee({__name:"ParamsLatest",props:{spaceId:{},maxHeight:{},readOnly:{type:Boolean},version:{}},setup(y,{expose:B}){const _=y,g=ve(),{t:I}=me(),{copy:C,isSupported:v}=xe({legacy:!0}),z=be(),w=E(),i=E(!1),l=E(),o=E(),d=E({show:!1,info:void 0}),x=E(),q=E(),T=E(),K=t=>{C(t),z.success(I("common.copied"))},S=t=>{var c;(c=x.value)==null||c.open(),q.value={...t,type:"add"}},A=t=>{var c,k;(c=x.value)==null||c.open(),(k=x.value)==null||k.setFormValue({types:t.t,keys:t.node_name,values:t.v}),q.value={...t,type:"edit"}},j=(t,c,k)=>{const P=JSON.parse(JSON.stringify(o.value));let e=!1;const n=(p,H)=>{Le(p,(L,$)=>{var F;if(e)return!1;if(L.full_key===t){switch(c){case"rchildren":delete L.children;break;case"rself":(F=H.children)==null||F.splice($,1);break;case"update":k&&(L.children=k);break;case"insert":L.children=k}return e=!0,!1}L.children&&n(L.children,L)})};n(P,{children:P}),o.value=P},f=async t=>{const[c,k]=await $e({key:t.full_key,device_group_name:g.query.device_group_name,space_id:_.spaceId});!c&&(k==null?void 0:k.status)===0&&j(t.full_key,"rself")},O=(t,c)=>{var k;b(t,void 0,c!==void 0?c:((k=q.value)==null?void 0:k.type)==="add")},R=t=>{d.value={show:!0,info:t}},m=()=>{b([l.value])},s=t=>{b(t.full_key.split("/"));const c=(T.value||[]).concat(t.full_key);T.value=[...new Set(c)]},u=[{title:I("groupDetail.parameterManager.key"),key:"node_name",render:t=>t.expandable?r("div",{class:"inline-flex items-center gap-1"},fe([r("span",t.node_name),_.readOnly?null:r(G,{quaternary:!0,type:"info",size:"small",onClick:()=>S(t)},{icon:()=>r(ke)}),_.readOnly?null:r(G,{quaternary:!0,type:"info",size:"small",onClick:()=>s(t)},{icon:()=>r(we)})])):r("div",{class:"inline-flex gap-2"},[r("div",t.node_name),v.value?r(Z,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>K(t.full_key)},{default:()=>r(ne)}):void 0])},{title:I("groupDetail.parameterManager.dataType"),key:"t",width:100,render:t=>{if(t.expandable)return;const c=Ie.find(k=>k.value===t.t);return r(Fe,{size:"small",bordered:!1,color:{textColor:"#fff",color:(c==null?void 0:c.color)||"#2080f0"},class:"min-w-16 text-center inline-flex justify-center"},{default:()=>t.t})}},{title:I("groupDetail.parameterManager.value"),key:"v",render:t=>t.expandable?t.v:r("div",{class:"flex gap-2"},[r(ge,{tooltip:{show:!1}},{default:()=>t.v}),v.value?r(Z,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>K(t.v)},{default:()=>r(ne)}):void 0])},{title:I("groupDetail.parameterManager.paramsDesc"),key:"desc",render:t=>t.expandable?t.v:r("div",{class:"flex gap-2"},[r(ge,{class:"opacity-80"},{default:()=>t.desc})])}];_.readOnly||u.push({title:I("groupDetail.parameterManager.options"),key:"options",width:260,align:"center",render:t=>{if(!(t!=null&&t.isLeaf))return;const c={quaternary:!0,type:"info",size:"small"},k=r(G,{...c,onClick:()=>{A(t)}},{default:()=>I("groupDetail.parameterManager.optionEdit")}),P=r(G,{...c,onClick:()=>R(t)},{default:()=>I("groupDetail.parameterManager.optionHistory")}),e=r(Me,{onPositiveClick:()=>f(t)},{default:()=>I("groupDetail.parameterManager.removeConfirm"),icon:()=>r(Z,{color:"#e88080",size:22},r(qe)),trigger:()=>r(G,{...c,type:"error"},{default:()=>I("groupDetail.parameterManager.optionRemove")})});return r("div",{class:"flex justify-end"},[k,P,e])}});const b=async(t=[],c,k)=>{var e;if(!_.spaceId||i.value)return;i.value=!0;const P=fe(t);try{const[n,p]=await dt({device_group_name:g.query.device_group_name,space_id:_.spaceId,parent_tree:P,version:_.version});if(i.value=!1,n||(p==null?void 0:p.status)!==0)return;if(P.length===0){w.value=p.data,p.data&&p.data.length>0&&b([p.data[0].node_name]),Te(p.data)&&(o.value=[]);return}const H="/"+P.join("/"),L=p.data.map(F=>({...F,isLeaf:!F.expandable})),$=(e=L.filter(F=>F.isLeaf))==null?void 0:e.map(F=>F.full_key);if(!Te($)){const[F,te]=await ut({full_key_list:$.join(","),language:localStorage.getItem("lang")||"en"});!F&&(te==null?void 0:te.status)===0&&Le(L,oe=>{const Re=te.data[oe.full_key];Re&&(oe.desc=Re)})}if(c)return c.resolve(),L;P.length===1?o.value=L:k?j(H,"insert",L):j(H,"update",L)}catch{c&&c.reject(),i.value=!1}},V=t=>new Promise(async(c,k)=>{const P=await b(t.full_key.split("/"),{resolve:c,reject:k});t.children=P}),Q=t=>{const[c]=nt(T.value,t);c&&j(c,"rchildren"),T.value=t};return pe(()=>_.spaceId,t=>{t&&b()},{immediate:!0}),pe(l,t=>{t&&(T.value=[],o.value=[],b([t]))}),B({refresh:b}),(t,c)=>{const k=Ce,P=he,e=ye;return U(),X("div",St,[a(w)?(U(),D(xt,{key:0,tabs:a(w),modelValue:a(l),"onUpdate:modelValue":c[0]||(c[0]=n=>de(l)?l.value=n:null),onInsert:S,onRefresh:m,"read-only":t.readOnly},null,8,["tabs","modelValue","read-only"])):Y("",!0),h(k,{size:"small","max-height":t.maxHeight?t.maxHeight:"calc(100vh - 340px)",columns:u,data:a(o),loading:a(i),"row-key":n=>n.full_key,"expanded-row-keys":a(T),onLoad:V,onUpdateExpandedRowKeys:Q},null,8,["max-height","data","loading","row-key","expanded-row-keys"]),t.spaceId?(U(),D(Be,{key:1,info:a(q),ref_key:"actionInfoRef",ref:x,"space-id":t.spaceId,"onUpdate:success":O},null,8,["info","space-id"])):Y("",!0),h(e,{show:a(d).show,"onUpdate:show":c[1]||(c[1]=n=>a(d).show=n),size:"huge"},{default:M(()=>[h(P,{style:{"min-height":"400px",overflow:"auto",width:"1000px","min-width":"500px"}},{default:M(()=>{var n;return[h(Se,{"max-height":"auto","space-id":t.spaceId,hkey:(n=a(d).info)==null?void 0:n.full_key,"hide-history-option":"","onUpdate:success":O},null,8,["space-id","hkey"])]}),_:1})]),_:1},8,["show"])])}}}),Rt={class:"relative mb-2 w-[450px]"},Jt=ee({__name:"ParamsSearch",props:ce({spaceId:{}},{modelValue:{},modelModifiers:{}}),emits:ce(["refresh"],["update:modelValue"]),setup(y,{emit:B}){const _=B,g=y,I=ve(),C=Ae(),{t:v}=me(),{copy:z,isSupported:w}=xe({legacy:!0}),i=be(),l=E(!1),o=E(),d=Pe(y,"modelValue"),x=E({show:!1,info:void 0}),q=E(),T=E(),K=m=>{z(m),i.success(v("common.copied"))},S=m=>{var s,u;(s=q.value)==null||s.open(),(u=q.value)==null||u.setFormValue({types:m.t,keys:m.full_key.replace(/^.*\/([^\/]*)$/,"$1"),values:m.v}),T.value={...m,type:"edit"}},A=async m=>{const[s,u]=await $e({key:m.full_key,device_group_name:I.query.device_group_name,space_id:g.spaceId});!s&&(u==null?void 0:u.status)===0&&(R(),_("refresh"))},j=()=>{R(),_("refresh")},f=m=>{x.value={show:!0,info:m}},O=[{title:v("groupDetail.parameterManager.key"),key:"full_key",render:m=>r("div",{class:"inline-flex gap-2"},[r("div",m.full_key),r(Z,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>K(m.full_key)},{default:()=>r(ne)})])},{title:v("groupDetail.parameterManager.dataType"),key:"t",width:100,render:m=>{if(m.expandable)return;const s=Ie.find(u=>u.value===m.t);return r(Fe,{size:"small",bordered:!1,color:{textColor:"#fff",color:(s==null?void 0:s.color)||"#2080f0"},class:"min-w-16 text-center inline-flex justify-center"},{default:()=>m.t})}},{title:v("groupDetail.parameterManager.value"),key:"v",ellipsis:{tooltip:!0},render:m=>m.expandable?m.v:r("div",{class:"flex gap-2"},[r("div",m.v),w.value?r(Z,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>K(m.v)},{default:()=>r(ne)}):void 0])},{title:v("groupDetail.parameterManager.options"),key:"options",width:260,align:"center",render:m=>{const s={quaternary:!0,type:"info",size:"small"},u=r(G,{...s,onClick:()=>{S(m)}},{default:()=>v("groupDetail.parameterManager.optionEdit")}),b=r(G,{...s,onClick:()=>f(m)},{default:()=>v("groupDetail.parameterManager.optionHistory")}),V=r(Me,{onPositiveClick:()=>A(m),placement:"left-start"},{default:()=>v("groupDetail.parameterManager.removeConfirm"),icon:()=>r(Z,{color:"#e88080",size:22},r(qe)),trigger:()=>r(G,{...s,type:"error"},{default:()=>v("groupDetail.parameterManager.optionRemove")})});return r("div",{class:"flex justify-end"},[u,b,V])}}],R=async()=>{var u;if(!((u=d.value)!=null&&u.trim())||!g.spaceId||l.value)return;l.value=!0;const[m,s]=await mt({device_group_name:I.query.device_group_name,space_id:g.spaceId,search_word:d.value});l.value=!1,(m||(s==null?void 0:s.status)==0)&&(o.value=s==null?void 0:s.data)};return at(()=>{ot(()=>{setTimeout(()=>{R()},200)})}),(m,s)=>{const u=He,b=Ce,V=he,Q=ye;return U(),X("div",null,[W("div",Rt,[h(u,{style:{width:"450px","padding-right":"20px"},value:d.value,"onUpdate:value":s[0]||(s[0]=t=>d.value=t),valueModifiers:{trim:!0},placeholder:a(v)("groupDetail.parameterManager.searchPlaceholder"),onKeyup:st(R,["enter"])},null,8,["value","placeholder"]),W("div",{class:"absolute -right-4 top-1/2 -translate-1/2 h-full w-8 flex items-center justify-center cursor-pointer",onClick:R},[h(a(Z),{color:a(C).primaryColor,component:a(rt)},null,8,["color","component"])])]),h(b,{size:"small","max-height":"calc(100vh - 340px)",columns:O,data:a(o),loading:a(l),"row-key":t=>t.full_key},null,8,["data","loading","row-key"]),m.spaceId?(U(),D(Be,{key:0,info:a(T),ref_key:"actionInfoRef",ref:q,"space-id":m.spaceId,"onUpdate:success":j},null,8,["info","space-id"])):Y("",!0),h(Q,{show:a(x).show,"onUpdate:show":s[1]||(s[1]=t=>a(x).show=t),size:"huge"},{default:M(()=>[h(V,{style:{"min-height":"400px",overflow:"auto",width:"1000px","min-width":"500px"}},{default:M(()=>{var t;return[h(Se,{"max-height":"auto","space-id":m.spaceId,hkey:(t=a(x).info)==null?void 0:t.full_key,"hide-history-option":"","onUpdate:success":j},null,8,["space-id","hkey"])]}),_:1})]),_:1},8,["show"])])}}});var ue={exports:{}},zt=ue.exports,je;function Ot(){return je||(je=1,function(y,B){(function(_,g){g()})(zt,function(){function _(i,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}function g(i,l,o){var d=new XMLHttpRequest;d.open("GET",i),d.responseType="blob",d.onload=function(){w(d.response,l,o)},d.onerror=function(){console.error("could not download file")},d.send()}function I(i){var l=new XMLHttpRequest;l.open("HEAD",i,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}function C(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(l)}}var v=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof re=="object"&&re.global===re?re:void 0,z=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),w=v.saveAs||(typeof window!="object"||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!z?function(i,l,o){var d=v.URL||v.webkitURL,x=document.createElement("a");l=l||i.name||"download",x.download=l,x.rel="noopener",typeof i=="string"?(x.href=i,x.origin===location.origin?C(x):I(x.href)?g(i,l,o):C(x,x.target="_blank")):(x.href=d.createObjectURL(i),setTimeout(function(){d.revokeObjectURL(x.href)},4e4),setTimeout(function(){C(x)},0))}:"msSaveOrOpenBlob"in navigator?function(i,l,o){if(l=l||i.name||"download",typeof i!="string")navigator.msSaveOrOpenBlob(_(i,o),l);else if(I(i))g(i,l,o);else{var d=document.createElement("a");d.href=i,d.target="_blank",setTimeout(function(){C(d)})}}:function(i,l,o,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof i=="string")return g(i,l,o);var x=i.type==="application/octet-stream",q=/constructor/i.test(v.HTMLElement)||v.safari,T=/CriOS\/[\d]+/.test(navigator.userAgent);if((T||x&&q||z)&&typeof FileReader<"u"){var K=new FileReader;K.onloadend=function(){var j=K.result;j=T?j:j.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=j:location=j,d=null},K.readAsDataURL(i)}else{var S=v.URL||v.webkitURL,A=S.createObjectURL(i);d?d.location=A:location.href=A,d=null,setTimeout(function(){S.revokeObjectURL(A)},4e4)}});v.saveAs=w.saveAs=w,y.exports=w})}(ue)),ue.exports}var Qt=Ot();export{Gt as A,Qt as F,Be as _,qt as a,Vt as b,Bt as c,Xt as d,Se as e,Jt as f,Nt as g,Kt as i,$t as s};

from core.types import *
from core.util import *

import json

from dataclasses import asdict, dataclass
from datetime import datetime
from typing import Optional

__all__ = [
    'MultiModel'
]

multi_enum_options = [
    'giraffe', 
    'elephant', 
    'zebra'
]

field_list = [
    'multi_bool',
    'multi_int',
    'multi_float',
    'multi_string',
    'multi_enum',
    'multi_datetime',
    'user_id',
]

longest_field_name_length = max([len(name) for name in field_list])

@dataclass
class MultiModel:

    multi_bool: list[bool]
    multi_int: list[int]
    multi_float: list[float]
    multi_string: list[str]
    multi_enum: list[str]
    multi_datetime: list[datetime]
    user_id: str = ''
    id: Optional[str] = None

    def convert_types(self) -> 'MultiModel':
        return self

    def validate(self) -> 'MultiModel':

        if not isinstance(self.id, str) and self.id is not None:
            raise TypeError('invalid type for id')

        
        return self   

    def to_dict(self) -> dict:
        data = asdict(self)
        if self.id is None:
            del data['id']
        return data
    
    def to_json(self) -> str:
        return to_json(self.to_dict())

    @classmethod
    def example(cls) -> 'MultiModel':
        return cls(
            user_id='',
			multi_bool=[True, False],
			multi_int=[7, 11],
			multi_float=[3.14, 2.718],
			multi_string=['banana'],
            multi_enum=['giraffe', 'elephant'],
            multi_datetime=[datetime.strptime('2000-01-11T12:34:56', datetime_format_str)],
        ) 

    @classmethod
    def random(cls) -> 'MultiModel':
        return cls(
			multi_bool=random_list('bool'),
			multi_int=random_list('int'),
			multi_float=random_list('float'),
			multi_string=random_list('str'),
            multi_enum=random_list('str', multi_enum_options),
            multi_datetime=random_list('datetime'),
        )
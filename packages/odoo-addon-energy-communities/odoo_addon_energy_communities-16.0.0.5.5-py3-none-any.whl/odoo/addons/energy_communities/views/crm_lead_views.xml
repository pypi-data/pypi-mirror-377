<odoo>
	<!--
	<record model="ir.actions.act_window" id="crm.crm_lead_opportunities_tree_view">
		<field name="name">Pipeline</field>
		<field name="res_model">crm.lead</field>
		<field name="view_mode">kanban,tree,graph,pivot,form,calendar,activity</field>
		<field name="domain">[('type','=','opportunity')]</field>
		<field name="context">
			{
            'default_type': 'opportunity',
            'search_default_assigned_to_me': 0
			}
		</field>
		<field name="search_view_id" ref="crm.view_crm_case_opportunities_filter" />
	</record>
	-->
	<record id="ce_view_crm_case_opportunities_filter" model="ir.ui.view">
		<field name="name">ce.view.crm.opportunities.leads.filter</field>
		<field name="model">crm.lead</field>
		<field name="inherit_id" ref="crm.view_crm_case_opportunities_filter" />
		<field name="arch" type="xml">
			<filter name="assigned_to_me" position="before">
				<filter
          name="ce_source_existing_ce_info"
          string="Newsletter CE"
          domain="[('source_id','=', %(ce_source_existing_ce_info)d)]"
        />
				<filter
          name="ce_source_existing_ce_contact"
          string="Contact CE"
          domain="[('source_id','=', %(ce_source_existing_ce_contact)d)]"
        />
				<filter
          name="ce_source_creation_ce_proposal"
          string="CE creation"
          domain="[('source_id','=', %(ce_source_creation_ce_proposal)d)]"
        />
				<filter
          name="ce_source_coord_web_hiring"
          string="Hire COORD"
          domain="[('source_id','=', %(ce_source_coord_web_hiring)d)]"
        />
				<filter
          name="ce_source_coord_web_other"
          string="Other COORD"
          domain="[('source_id','=', %(ce_source_coord_web_other)d)]"
        />
				<filter
          name="no_web_form_origin"
          string="No web form origin"
          domain="[('source_id','=', False)]"
        />
				<separator />
			</filter>
		</field>
	</record>

	<record id="ce_view_crm_case_opportunities_filter_platform_admins" model="ir.ui.view">
		<field name="name">ce.view.crm.opportunities.leads.filter.platform.admins</field>
		<field name="model">crm.lead</field>
		<field
      name="inherit_id"
      ref="energy_communities.ce_view_crm_case_opportunities_filter"
    />
		<field
      name="groups_id"
      eval="[(ref('energy_communities.role_platform_admin_res_groups'))]"
    />
		<field name="arch" type="xml">
			<filter name="ce_source_existing_ce_info" position="before">
				<filter
          name="ce_source_general_info"
          string="Newsletter SomComunitats"
          domain="[('source_id','=', %(ce_source_general_info)d)]"
        />
						<filter
          name="ce_source_general_contact"
          string="Contact SomComunitats"
          domain="[('source_id','=', %(ce_source_general_contact)d)]"
        />
		</filter>
		</field>
	</record>

	<record id="ce_crm_lead_view_form" model="ir.ui.view">
		<field name="name">ce.crm.lead.view.form</field>
		<field name="model">crm.lead</field>
		<field name="inherit_id" ref="crm.crm_lead_view_form" />
		<field name="arch" type="xml">
			<xpath expr="//sheet" position="before">
        <header>
          <field name="source_id" invisible="1" />
          <field name="finished" invisible="1" />
          <field name="company_hierarchy_level" invisible="1" />
          <field name="can_be_assigned_to_coordinator" invisible="1" />
					<button
            name="action_assign_crm_to_coordinator_company"
            type="object"
            string="Assing CRM to coordinator company"
            groups="energy_communities.group_platform_manager"
            attrs="{'invisible':[('can_be_assigned_to_coordinator', '!=', True)]}"
          />
          <button
            name="action_create_community"
            type="object"
            string="Create community"
            groups="energy_communities.group_platform_manager"
            attrs="{'invisible':['|',('source_id', '!=', %(ce_source_creation_ce_proposal)d),('probability','>=',100)]}"
          />
				</header>
      </xpath>
      <field name="company_id" position="after">
        <field name="external_id" readonly="1" />
		<field
          name="ce_child_lead_id"
          string="Crm lead child"
          readonly="1"
          attrs="{'invisible':['|',('source_id', '!=', %(ce_source_creation_ce_proposal)d), ('company_hierarchy_level', '!=', 'instance')]}"
        />
      </field>
		</field>
	</record>

	<record id="ce_crm_lead_opportunities_form_view" model="ir.ui.view">
		<field name="name">crm.lead.form.opportunity</field>
		<field name="model">crm.lead</field>
		<field name="inherit_id" ref="crm.quick_create_opportunity_form" />
		<field name="arch" type="xml">
			<field name="title" position="after">
				<field
          name="ce_tag_ids"
          widget="many2many_tags"
          options="{'color_field': 'color', 'no_create_edit': True}"
          attrs="{'invisible':[('source_id', '!=', %(ce_source_creation_ce_proposal)d)]}"
        />
				<field name="source_id" />
				<field name="community_company_id" readonly="1" />
			</field>
		</field>
	</record>

	<record id="ce_quick_create_opportunity_form" model="ir.ui.view">
		<field name="name">crm.lead.form.quick_create</field>
		<field name="model">crm.lead</field>
		<field name="inherit_id" ref="crm.quick_create_opportunity_form" />
		<field name="arch" type="xml">
			<field name="partner_id" position="after">
				<field name="source_id" />
			</field>
		</field>
	</record>

	<!-- Crm lead tags -->
	<record id="ce_crm_lead_tags_action" model="ir.actions.act_window">
		<field name="name">Energy Actions</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">crm.tag</field>
		<field name="view_mode">tree,form</field>
		<field name="search_view_id" eval="False" /> <!-- Force empty -->
		<field name="view_id" eval="False" /> <!-- Force empty -->
		<field name="help" type="html">
			<p class="oe_view_nocontent_create">
                Click to define a new tag.
            </p>
		</field>
	</record>

	<record id="ce_crm_lead_tags_form_view" model="ir.ui.view">
		<field name="name">crm.lead.tag.form</field>
		<field name="model">crm.tag</field>
		<field name="inherit_id" ref="sales_team.sales_team_crm_tag_view_form" />
		<field name="arch" type="xml">
			<field name="name" position="after">
				<field name="tag_ext_id" />
				<field name="id" />
			</field>
		</field>
	</record>

	<record id="ce_crm_lead_tags_tree_view" model="ir.ui.view">
		<field name="name">crm.lead.tag.tree</field>
		<field name="model">crm.tag</field>
		<field name="inherit_id" ref="sales_team.sales_team_crm_tag_view_tree" />
		<field name="arch" type="xml">
			<field name="name" position="after">
				<field name="tag_ext_id" />
				<field name="id" />
			</field>
		</field>
	</record>

</odoo>

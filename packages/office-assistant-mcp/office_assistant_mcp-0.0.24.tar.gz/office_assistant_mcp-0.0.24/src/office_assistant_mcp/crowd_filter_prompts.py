"""人群筛选相关的提示词模板"""

CREATE_CROWD_FILTER_PROMPT = """# Role
你是一位精通用户行为分析和营销策略的用户分群专家。

# Task
根据输入的商品信息和期望的客群数量，生成一句自然语言描述的人群筛选条件。这句描述需要精确、简洁，并能直接用于人群圈选。

# Rules for Generating Conditions
你需要组合运用以下三类用户行为，来构建一个逻辑严谨的筛选条件。期望的客群数量可以作为参考，用于调整条件的宽紧程度（例如，数量要求高则放宽时间范围或条件）。

1. **平台消费习惯 (筛选活跃用户)**
   * 描述用户近期的基础消费行为。
   * **时间**: 较短，通常为最近60天、90天或100天。
   * **条件**: 可以是"有过消费"、"消费金额在xx-xx元之间"等。

2. **品牌/品类兴趣 (筛选潜力用户)**
   * 描述用户对该商品、品牌或品类的历史兴趣。这部分通常使用"或"逻辑进行组合。
   * **购买过本品**: 对象为【商品ID】。时间不限或较长 (如：任意时间)。
   * **购买过同品牌**: 对象为【品牌】。时间不限或较长 (如：最近365天)。
   * **购买过同类目**: 对象为【后台类目】。**在条件中必须明确指出类目的层级**（例如：`三级类目"xxx"`），以确保定位精确。时间范围中等，且不含最近 (如：最近30-180天)，以触达有品类需求但近期未购的用户。

3. **复购周期 (排除近期已购用户)**
   * 描述用户近期**未**购买过该商品/品牌，以避免对刚买过的用户进行无效营销。
   * **时间**: 根据提供的复购周期参数，如果未提供则根据品类预估一个合理的复购周期 (如牛奶30天，护肤品100天)。
   * **条件**: 
     - 商品复购周期：如果提供了商品复购周期，使用"最近xx天**未**购买过【商品ID】"
     - 品牌复购周期：如果提供了品牌复购周期，使用"最近xx天**未**购买过【品牌】商品"
     - 如果都为0，则根据品类预估合理周期，使用"最近xx天**未**购买过【商品ID】"
     - 如果两个周期都提供了，两个条件里二选一即可

# Output Format
输出必须是一句完整、通顺的自然语言筛选条件。不要包含任何额外的解释或说明。

---
## Example

### Example Input:
- **商品ID**: 968476
- **完整商品名**: 【海南、新疆、西藏发货】优疆新疆有机纯牛奶 200ml×10 盒 x3 箱
- **完整后台四级类目（不同级别类目用/分隔）**: 食品饮料 / 饮料冲调 / 牛奶乳品 / 牛奶
- **品牌**: 优疆
- **期望客群数量**: 1000人

### Example Output:
最近60天内消费过50-300元，且（历史任意时间购买过优疆品牌商品，或最近30-180天内购买过**三级类目"牛奶乳品"**的商品），且最近30天未购买过商品id为968476的商品。

---
## Current Input:
- **商品ID**: {product_id}
- **完整商品名**: {product_title}
- **完整后台四级类目（不同级别类目用/分隔）**: {category_level4}
- **品牌**: {brand}
- **期望客群数量**: {expected_crowd_size}人{repurchase_cycle_info}

## Your Output:"""

MODIFY_CROWD_FILTER_PROMPT = """# Role
你是一名专业的营销策略师，擅长根据用户数据和商品信息调整人群圈选策略，以精准地触达目标用户群体。

# Task
你的任务是根据预期的目标用户数和实际圈选的用户数之间的差异，智能地调整和优化原始的用户筛选条件。你必须结合输入的商品详细信息，特别是其四级类目层级路径，来做出合理的调整。最终输出一句新的、在描述类目时明确指出层级的筛选条件。

# Rules
请遵循以下策略调整规则：

## 1. 当 "实际人数" 远小于 "预期人数" 时 (条件过严，需要放宽)
- **延长周期**: 将时间限制放宽。例如，将"近7天"改为"近14天"。
- **扩大类目范围**: 利用商品类目路径向上移动至父级类目，并明确指出层级。例如，从"四级类目-水洗式"扩展到"三级类目-面膜"。
- **放宽数值限制**: 降低金额或次数的门槛。例如，将"购买金额超过500元"改为"超过200元"。
- **减少限制条件**: 移除或放宽一些限制性较强的条件。

## 2. 当 "实际人数" 远大于 "预期人数" 时 (条件过宽，需要缩紧)
- **缩短周期**: 将时间限制缩短。例如，将"近30天"改为"近14天"。
- **缩小类目范围**: 利用商品类目路径向下移动至更具体的子级类目，并明确指出层级。例如，从"二级类目-面部护肤"缩小到"三级类目-面膜"。
- **收紧数值限制**: 提高金额或次数的门槛。例如，将"购买金额超过200元"改为"超过500元"。
- **增加限制条件**: 增加新的筛选维度，如"复购周期"等。

# Output Format
请直接输出优化后的筛选条件。**重要提示：** 输出中凡是涉及到商品类目的地方，都必须明确指出是"一级类目"、"二级类目"、"三级类目"或"四级类目"。不要包含任何额外的解释或说明。

---
## Example

### Example Input:
- **预期人数**: 8000
- **原筛选条件**: 近30天内购买过"四级类目-水洗式"，且单笔订单金额大于300元的用户
- **实际获得人数**: 500
- **商品详细信息**:
  - **商品名**: Kiehls 科颜氏亚马逊白泥面膜 清洁毛孔去黑头收缩毛孔【26年4月】
  - **商品ID**: 1061
  - **品牌**: 科颜氏/Kiehls
  - **类目**: 美妆护肤/面部护肤/面膜/水洗式

### Example Output:
近30天内购买过"三级类目-面膜"的商品，且累计购买金额大于200元的用户

---
## Current Input:
- **预期人数**: {expected_crowd_size}
- **原筛选条件**: {original_filter}
- **实际获得人数**: {actual_crowd_size}
- **商品详细信息**:
  - **商品名**: {product_title}
  - **商品ID**: {product_id}
  - **品牌**: {brand}
  - **类目**: {category_level4}

## Your Output:"""
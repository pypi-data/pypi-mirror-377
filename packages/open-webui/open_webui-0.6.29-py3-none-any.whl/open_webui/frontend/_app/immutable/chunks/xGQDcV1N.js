import{S as Oe,i as Pe,s as Ve,H as Ce,I as We,C as j,D as K,E as q,K as je,q as w,r as I,F as G,v as Ke,k as he,e as U,c as R,a as N,d as m,f as _,g as M,x as Tt,z as Ct,A as It,B as Dt,l as J,p as X,t as re,b as se,h as L,j as ae,m as _e,y as te,u as le,w as St,_ as At,a0 as Ut,G as fe,O as Rt,V as Le,n as oe,M as ie,N as Ie,J as tl,W as nt,X as rt}from"./G5mHU2ZO.js";import{e as Me}from"./Bno_0ZUi.js";import"./IHki7fMi.js";import{t as ue}from"./DjBxNUjk.js";import{d as ll,n as nl,g as ze,e as st,a as rl,c as sl,m as al}from"./C7CLP60P.js";import{j as il,k as ol,v as cl,n as ul,a as fl,o as dl,p as ml,q as gl,r as hl,t as _l,u as pl,w as bl}from"./CueazCI5.js";import{g as vl}from"./dJ1dhnQj.js";import{T as De}from"./BOU1-HoI.js";import{V as wl,R as kl}from"./itp82EBs.js";import"./DcZItv_e.js";import{b as yl,c as at}from"./BEEpJ9XI.js";import{f as El}from"./g5t9vw8M.js";import{D as Tl}from"./Db7yB6Rs.js";import{C as Cl,a as Il,g as He,I as Dl,b as Sl}from"./BmkELENF.js";import{u as Al,F as Ul}from"./DNTdbxbk.js";import{I as Rl}from"./CNfLt7c7.js";import{F as Ll}from"./Bwz7T5Cq.js";import{L as Ml,H as Vl}from"./DrhMxXQG.js";import{s as Nl}from"./tIqtdclk.js";import{S as Bl}from"./CJLQ23NZ.js";function Fl(s){let e;const l=s[6].default,t=Tt(l,s,s[11],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,r){t&&t.m(n,r),e=!0},p(n,r){t&&t.p&&(!e||r&2048)&&Ct(t,l,n,n[11],e?Dt(l,n[11],r,null):It(n[11]),null)},i(n){e||(w(t,n),e=!0)},o(n){I(t,n),e=!1},d(n){t&&t.d(n)}}}function Hl(s){let e,l;return e=new De({props:{content:s[4].t("More"),$$slots:{default:[Fl]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){q(e,t,n),l=!0},p(t,n){const r={};n&16&&(r.content=t[4].t("More")),n&2048&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function zl(s){let e,l,t,n=s[4].t("Upload Files")+"",r,i;return e=new Cl({}),{c(){j(e.$$.fragment),l=J(),t=U("div"),r=re(n),this.h()},l(c){K(e.$$.fragment,c),l=X(c),t=R(c,"DIV",{class:!0});var a=N(t);r=se(a,n),a.forEach(m),this.h()},h(){_(t,"class","line-clamp-1")},m(c,a){q(e,c,a),M(c,l,a),M(c,t,a),L(t,r),i=!0},p(c,a){(!i||a&16)&&n!==(n=c[4].t("Upload Files")+"")&&ae(r,n)},i(c){i||(w(e.$$.fragment,c),i=!0)},o(c){I(e.$$.fragment,c),i=!1},d(c){c&&(m(l),m(t)),G(e,c)}}}function Ol(s){let e,l,t,n=s[4].t("Capture")+"",r,i;return e=new Il({}),{c(){j(e.$$.fragment),l=J(),t=U("div"),r=re(n),this.h()},l(c){K(e.$$.fragment,c),l=X(c),t=R(c,"DIV",{class:!0});var a=N(t);r=se(a,n),a.forEach(m),this.h()},h(){_(t,"class","line-clamp-1")},m(c,a){q(e,c,a),M(c,l,a),M(c,t,a),L(t,r),i=!0},p(c,a){(!i||a&16)&&n!==(n=c[4].t("Capture")+"")&&ae(r,n)},i(c){i||(w(e.$$.fragment,c),i=!0)},o(c){I(e.$$.fragment,c),i=!1},d(c){c&&(m(l),m(t)),G(e,c)}}}function Pl(s){let e,l,t,n;return e=new at({props:{class:"flex gap-2 items-center px-3 py-1.5 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[zl]},$$scope:{ctx:s}}}),e.$on("click",s[7]),t=new at({props:{class:"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[Ol]},$$scope:{ctx:s}}}),t.$on("click",s[8]),{c(){j(e.$$.fragment),l=J(),j(t.$$.fragment)},l(r){K(e.$$.fragment,r),l=X(r),K(t.$$.fragment,r)},m(r,i){q(e,r,i),M(r,l,i),q(t,r,i),n=!0},p(r,i){const c={};i&2064&&(c.$$scope={dirty:i,ctx:r}),e.$set(c);const a={};i&2064&&(a.$$scope={dirty:i,ctx:r}),t.$set(a)},i(r){n||(w(e.$$.fragment,r),w(t.$$.fragment,r),n=!0)},o(r){I(e.$$.fragment,r),I(t.$$.fragment,r),n=!1},d(r){r&&m(l),G(e,r),G(t,r)}}}function Wl(s){let e,l,t;return l=new yl({props:{class:"w-full max-w-[200px] rounded-2xl px-1 py-1  border border-gray-100  dark:border-gray-800 z-999 bg-white dark:bg-gray-850 dark:text-white shadow-lg transition",sideOffset:4,alignOffset:-6,side:"bottom",align:"start",transition:El,$$slots:{default:[Pl]},$$scope:{ctx:s}}}),{c(){e=U("div"),j(l.$$.fragment),this.h()},l(n){e=R(n,"DIV",{slot:!0});var r=N(e);K(l.$$.fragment,r),r.forEach(m),this.h()},h(){_(e,"slot","content")},m(n,r){M(n,e,r),q(l,e,null),t=!0},p(n,r){const i={};r&2067&&(i.$$scope={dirty:r,ctx:n}),l.$set(i)},i(n){t||(w(l.$$.fragment,n),t=!0)},o(n){I(l.$$.fragment,n),t=!1},d(n){n&&m(e),G(l)}}}function jl(s){let e,l,t;function n(i){s[9](i)}let r={$$slots:{content:[Wl],default:[Hl]},$$scope:{ctx:s}};return s[3]!==void 0&&(r.show=s[3]),e=new Tl({props:r}),Ce.push(()=>We(e,"show",n)),e.$on("change",s[10]),{c(){j(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,c){q(e,i,c),t=!0},p(i,[c]){const a={};c&2067&&(a.$$scope={dirty:c,ctx:i}),!l&&c&8&&(l=!0,a.show=i[3],je(()=>l=!1)),e.$set(a)},i(i){t||(w(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Kl(s,e,l){let t,{$$slots:n={},$$scope:r}=e;const i=Ke("i18n");he(s,i,T=>l(4,t=T));let{screenCaptureHandler:c}=e,{uploadFilesHandler:a}=e,{onClose:f=()=>{}}=e,d=!1;const D=async()=>{},p=()=>{a()},k=()=>{c()};function v(T){d=T,l(3,d)}const y=T=>{T.detail===!1&&f()};return s.$$set=T=>{"screenCaptureHandler"in T&&l(0,c=T.screenCaptureHandler),"uploadFilesHandler"in T&&l(1,a=T.uploadFilesHandler),"onClose"in T&&l(2,f=T.onClose),"$$scope"in T&&l(11,r=T.$$scope)},s.$$.update=()=>{s.$$.dirty&8&&d&&D()},[c,a,f,d,t,i,n,p,k,v,y,r]}class ql extends Oe{constructor(e){super(),Pe(this,e,Kl,jl,Ve,{screenCaptureHandler:0,uploadFilesHandler:1,onClose:2})}}function it(s,e,l){const t=s.slice();return t[23]=e[l],t[25]=l,t}function ot(s){let e,l,t,n=Me(s[1]),r=[];for(let c=0;c<n.length;c+=1)r[c]=ut(it(s,n,c));const i=c=>I(r[c],1,1,()=>{r[c]=null});return{c(){e=U("div"),l=U("div");for(let c=0;c<r.length;c+=1)r[c].c();this.h()},l(c){e=R(c,"DIV",{class:!0,id:!0});var a=N(e);l=R(a,"DIV",{class:!0});var f=N(l);for(let d=0;d<r.length;d+=1)r[d].l(f);f.forEach(m),a.forEach(m),this.h()},h(){_(l,"class","overflow-y-auto scrollbar-thin max-h-60"),_(e,"class","mention-list text-black dark:text-white rounded-2xl shadow-lg border border-gray-200 dark:border-gray-800 flex flex-col bg-white dark:bg-gray-850 w-72 p-1"),_(e,"id","suggestions-container")},m(c,a){M(c,e,a),L(e,l);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(l,null);t=!0},p(c,a){if(a&23){n=Me(c[1]);let f;for(f=0;f<n.length;f+=1){const d=it(c,n,f);r[f]?(r[f].p(d,a),w(r[f],1)):(r[f]=ut(d),r[f].c(),w(r[f],1),r[f].m(l,null))}for(te(),f=n.length;f<r.length;f+=1)i(f);le()}},i(c){if(!t){for(let a=0;a<n.length;a+=1)w(r[a]);t=!0}},o(c){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)I(r[a]);t=!1},d(c){c&&m(e),Ut(r,c)}}}function ct(s){let e;function l(r,i){var c,a,f;if(((c=r[23])==null?void 0:c.type)==="user")return Yl;if(((a=r[23])==null?void 0:a.type)==="model")return Zl;if(((f=r[23])==null?void 0:f.type)==="channel")return Gl}let t=l(s),n=t&&t(s);return{c(){e=U("div"),n&&n.c(),this.h()},l(r){e=R(r,"DIV",{class:!0});var i=N(e);n&&n.l(i),i.forEach(m),this.h()},h(){_(e,"class","px-2 text-xs text-gray-500 py-1")},m(r,i){M(r,e,i),n&&n.m(e,null)},p(r,i){t===(t=l(r))&&n?n.p(r,i):(n&&n.d(1),n=t&&t(r),n&&(n.c(),n.m(e,null)))},d(r){r&&m(e),n&&n.d()}}}function Gl(s){let e=s[2].t("Channels")+"",l;return{c(){l=re(e)},l(t){l=se(t,e)},m(t,n){M(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Channels")+"")&&ae(l,e)},d(t){t&&m(l)}}}function Zl(s){let e=s[2].t("Models")+"",l;return{c(){l=re(e)},l(t){l=se(t,e)},m(t,n){M(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Models")+"")&&ae(l,e)},d(t){t&&m(l)}}}function Yl(s){let e=s[2].t("Users")+"",l;return{c(){l=re(e)},l(t){l=se(t,e)},m(t,n){M(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Users")+"")&&ae(l,e)},d(t){t&&m(l)}}}function Jl(s){let e,l,t;return{c(){e=U("img"),this.h()},l(n){e=R(n,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){var n;Le(e.src,l=`${ze}/users/${s[23].id}/profile/image`)||_(e,"src",l),_(e,"alt",t=((n=s[23])==null?void 0:n.label)??s[23].id),_(e,"class","rounded-full size-5 items-center mr-2")},m(n,r){M(n,e,r)},p(n,r){var i;r&2&&!Le(e.src,l=`${ze}/users/${n[23].id}/profile/image`)&&_(e,"src",l),r&2&&t!==(t=((i=n[23])==null?void 0:i.label)??n[23].id)&&_(e,"alt",t)},i:oe,o:oe,d(n){n&&m(e)}}}function Xl(s){let e,l,t;return{c(){e=U("img"),this.h()},l(n){e=R(n,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){var n,r,i,c,a,f;Le(e.src,l=((c=(i=(r=(n=s[23])==null?void 0:n.data)==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:c.profile_image_url)??`${st}/static/favicon.png`)||_(e,"src",l),_(e,"alt",t=((f=(a=s[23])==null?void 0:a.data)==null?void 0:f.name)??s[23].id),_(e,"class","rounded-full size-5 items-center mr-2")},m(n,r){M(n,e,r)},p(n,r){var i,c,a,f,d,D;r&2&&!Le(e.src,l=((f=(a=(c=(i=n[23])==null?void 0:i.data)==null?void 0:c.info)==null?void 0:a.meta)==null?void 0:f.profile_image_url)??`${st}/static/favicon.png`)&&_(e,"src",l),r&2&&t!==(t=((D=(d=n[23])==null?void 0:d.data)==null?void 0:D.name)??n[23].id)&&_(e,"alt",t)},i:oe,o:oe,d(n){n&&m(e)}}}function Ql(s){let e,l,t,n;const r=[xl,$l],i=[];function c(a,f){var d,D;return((D=(d=a[23])==null?void 0:d.data)==null?void 0:D.access_control)===null?0:1}return l=c(s),t=i[l]=r[l](s),{c(){e=U("div"),t.c(),this.h()},l(a){e=R(a,"DIV",{class:!0});var f=N(e);t.l(f),f.forEach(m),this.h()},h(){_(e,"class","size-4 justify-center flex items-center mr-0.5")},m(a,f){M(a,e,f),i[l].m(e,null),n=!0},p(a,f){let d=l;l=c(a),l!==d&&(te(),I(i[d],1,1,()=>{i[d]=null}),le(),t=i[l],t||(t=i[l]=r[l](a),t.c()),w(t,1),t.m(e,null))},i(a){n||(w(t),n=!0)},o(a){I(t),n=!1},d(a){a&&m(e),i[l].d()}}}function $l(s){let e,l;return e=new Ml({props:{className:"size-[15px]",strokeWidth:"2"}}),{c(){j(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){q(e,t,n),l=!0},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function xl(s){let e,l;return e=new Vl({props:{className:"size-3",strokeWidth:"2.5"}}),{c(){j(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){q(e,t,n),l=!0},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function en(s){let e=s[2].t("Channel")+"",l;return{c(){l=re(e)},l(t){l=se(t,e)},m(t,n){M(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Channel")+"")&&ae(l,e)},d(t){t&&m(l)}}}function tn(s){let e=s[2].t("Model")+"",l;return{c(){l=re(e)},l(t){l=se(t,e)},m(t,n){M(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Model")+"")&&ae(l,e)},d(t){t&&m(l)}}}function ln(s){let e=s[2].t("User")+"",l;return{c(){l=re(e)},l(t){l=se(t,e)},m(t,n){M(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("User")+"")&&ae(l,e)},d(t){t&&m(l)}}}function nn(s){let e,l,t,n,r,i=s[23].label+"",c,a,f,d,D,p,k,v,y;const T=[Ql,Xl,Jl],F=[];function H(S,A){return S[23].type==="channel"?0:S[23].type==="model"?1:S[23].type==="user"?2:-1}~(l=H(s))&&(t=F[l]=T[l](s));function ee(S,A){if(S[23].type==="user")return ln;if(S[23].type==="model")return tn;if(S[23].type==="channel")return en}let V=ee(s),C=V&&V(s);function z(){return s[16](s[25])}function x(){return s[17](s[25])}return{c(){e=U("button"),t&&t.c(),n=J(),r=U("div"),c=re(i),a=J(),f=U("div"),C&&C.c(),p=J(),this.h()},l(S){e=R(S,"BUTTON",{type:!0,class:!0,"data-selected":!0});var A=N(e);t&&t.l(A),n=X(A),r=R(A,"DIV",{class:!0});var u=N(r);c=se(u,i),u.forEach(m),a=X(A),f=R(A,"DIV",{class:!0});var b=N(f);C&&C.l(b),b.forEach(m),A.forEach(m),p=X(S),this.h()},h(){_(r,"class","truncate flex-1 pr-2"),_(f,"class","shrink-0 text-xs text-gray-500"),_(e,"type","button"),_(e,"class",d="flex items-center justify-between px-2.5 py-1.5 rounded-xl w-full text-left "+(s[25]===s[0]?"bg-gray-50 dark:bg-gray-800 selected-command-option-button":"")),_(e,"data-selected",D=s[25]===s[0])},m(S,A){M(S,e,A),~l&&F[l].m(e,null),L(e,n),L(e,r),L(r,c),L(e,a),L(e,f),C&&C.m(f,null),M(S,p,A),k=!0,v||(y=[fe(e,"click",z),fe(e,"mousemove",x)],v=!0)},p(S,A){s=S;let u=l;l=H(s),l===u?~l&&F[l].p(s,A):(t&&(te(),I(F[u],1,1,()=>{F[u]=null}),le()),~l?(t=F[l],t?t.p(s,A):(t=F[l]=T[l](s),t.c()),w(t,1),t.m(e,n)):t=null),(!k||A&2)&&i!==(i=s[23].label+"")&&ae(c,i),V===(V=ee(s))&&C?C.p(s,A):(C&&C.d(1),C=V&&V(s),C&&(C.c(),C.m(f,null))),(!k||A&1&&d!==(d="flex items-center justify-between px-2.5 py-1.5 rounded-xl w-full text-left "+(s[25]===s[0]?"bg-gray-50 dark:bg-gray-800 selected-command-option-button":"")))&&_(e,"class",d),(!k||A&1&&D!==(D=s[25]===s[0]))&&_(e,"data-selected",D)},i(S){k||(w(t),k=!0)},o(S){I(t),k=!1},d(S){S&&(m(e),m(p)),~l&&F[l].d(),C&&C.d(),v=!1,Rt(y)}}}function ut(s){var r,i,c;let e,l,t,n=(s[25]===0||((r=s[23])==null?void 0:r.type)!==((i=s[1][s[25]-1])==null?void 0:i.type))&&ct(s);return l=new De({props:{content:(c=s[23])==null?void 0:c.id,placement:"top-start",$$slots:{default:[nn]},$$scope:{ctx:s}}}),{c(){n&&n.c(),e=J(),j(l.$$.fragment)},l(a){n&&n.l(a),e=X(a),K(l.$$.fragment,a)},m(a,f){n&&n.m(a,f),M(a,e,f),q(l,a,f),t=!0},p(a,f){var D,p,k;a[25]===0||((D=a[23])==null?void 0:D.type)!==((p=a[1][a[25]-1])==null?void 0:p.type)?n?n.p(a,f):(n=ct(a),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null);const d={};f&2&&(d.content=(k=a[23])==null?void 0:k.id),f&67108871&&(d.$$scope={dirty:f,ctx:a}),l.$set(d)},i(a){t||(w(l.$$.fragment,a),t=!0)},o(a){I(l.$$.fragment,a),t=!1},d(a){a&&m(e),n&&n.d(a),G(l,a)}}}function rn(s){let e,l,t=s[1].length&&ot(s);return{c(){t&&t.c(),e=_e()},l(n){t&&t.l(n),e=_e()},m(n,r){t&&t.m(n,r),M(n,e,r),l=!0},p(n,[r]){n[1].length?t?(t.p(n,r),r&2&&w(t,1)):(t=ot(n),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(te(),I(t,1,1,()=>{t=null}),le())},i(n){l||(w(t),l=!0)},o(n){I(t),l=!1},d(n){n&&m(e),t&&t.d(n)}}}function sn(s,e,l){let t,n,r,i;he(s,ll,u=>l(18,n=u)),he(s,nl,u=>l(19,r=u));const c=Ke("i18n");he(s,c,u=>l(2,i=u));let{query:a=""}=e,{command:f}=e,{selectedIndex:d=0}=e,{label:D=""}=e,{triggerChar:p="@"}=e,{modelSuggestions:k=!1}=e,{userSuggestions:v=!1}=e,{channelSuggestions:y=!1}=e,T=[],F=[],H=[];const ee=async()=>{const u=await Nl(localStorage.token,a).catch(b=>null);u&&l(14,F=[...u.users.map(b=>({type:"user",id:b.id,label:b.name}))].sort((b,Z)=>b.label.localeCompare(Z.label)))},V=u=>{const b=t[u];b&&b&&f({id:`${b.type==="user"?"U":b.type==="model"?"M":"C"}:${b.id}|${b.label}`,label:b.label})},C=u=>{if(!["ArrowUp","ArrowDown","Enter","Tab","Escape"].includes(u.key))return!1;if(u.key==="ArrowUp"){l(0,d=Math.max(0,d-1));const b=document.querySelector('[data-selected="true"]');return b==null||b.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"}),!0}if(u.key==="ArrowDown"){l(0,d=Math.min(d+1,t.length-1));const b=document.querySelector('[data-selected="true"]');return b==null||b.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"}),!0}return u.key==="Enter"||u.key==="Tab"?(V(d),u.key==="Enter"&&u.preventDefault(),!0):u.key==="Escape"};function z(u){return C(u)}const x=u=>{u.key==="Enter"&&(u.preventDefault(),V(d))};St(async()=>{window.addEventListener("keydown",x),y?l(15,H=[...r.map(u=>({type:"channel",id:u.id,label:u.name,data:u}))]):(v&&await ee(),k&&l(13,T=[...n.map(u=>({type:"model",id:u.id,label:u.name,data:u}))]))}),At(()=>{window.removeEventListener("keydown",x)});const S=u=>V(u),A=u=>{l(0,d=u)};return s.$$set=u=>{"query"in u&&l(5,a=u.query),"command"in u&&l(6,f=u.command),"selectedIndex"in u&&l(0,d=u.selectedIndex),"label"in u&&l(7,D=u.label),"triggerChar"in u&&l(8,p=u.triggerChar),"modelSuggestions"in u&&l(9,k=u.modelSuggestions),"userSuggestions"in u&&l(10,v=u.userSuggestions),"channelSuggestions"in u&&l(11,y=u.channelSuggestions)},s.$$.update=()=>{s.$$.dirty&57376&&l(1,t=[...F,...T,...H].filter(u=>u.label.toLowerCase().includes(a.toLowerCase())||u.id.toLowerCase().includes(a.toLowerCase()))),s.$$.dirty&1056&&a!==null&&v&&ee()},[d,t,i,c,V,a,f,D,p,k,v,y,z,T,F,H,S,A]}class ft extends Oe{constructor(e){super(),Pe(this,e,sn,rn,Ve,{query:5,command:6,selectedIndex:0,label:7,triggerChar:8,modelSuggestions:9,userSuggestions:10,channelSuggestions:11,_onKeyDown:12})}get _onKeyDown(){return this.$$.ctx[12]}}const an=s=>({}),dt=s=>({});function mt(s,e,l){const t=s.slice();return t[70]=e[l],t[72]=l,t}function gt(s){let e,l,t,n,r,i,c,a,f,d,D,p,k,v,y,T,F;e=new Ll({props:{show:s[11]}});let H=s[6]&&ht(s);function ee(u){s[42](u)}let V={variables:s[18],onSave:s[17]};s[16]!==void 0&&(V.show=s[16]),n=new Dl({props:V}),Ce.push(()=>We(n,"show",ee));let C=s[1]===!1&&_t(s),z=s[2].length>0&&pt(s);const x=[cn,on],S=[];function A(u,b){return u[12]?0:1}return y=A(s),T=S[y]=x[y](s),{c(){j(e.$$.fragment),l=J(),H&&H.c(),t=J(),j(n.$$.fragment),i=J(),c=U("div"),a=U("div"),f=U("div"),d=U("div"),D=U("div"),C&&C.c(),p=J(),z&&z.c(),k=J(),v=U("div"),T.c(),this.h()},l(u){K(e.$$.fragment,u),l=X(u),H&&H.l(u),t=X(u),K(n.$$.fragment,u),i=X(u),c=R(u,"DIV",{class:!0});var b=N(c);a=R(b,"DIV",{class:!0});var Z=N(a);f=R(Z,"DIV",{class:!0});var B=N(f);d=R(B,"DIV",{class:!0});var E=N(d);D=R(E,"DIV",{class:!0});var O=N(D);C&&C.l(O),O.forEach(m),p=X(E),z&&z.l(E),E.forEach(m),B.forEach(m),k=X(Z),v=R(Z,"DIV",{class:!0});var Q=N(v);T.l(Q),Q.forEach(m),Z.forEach(m),b.forEach(m),this.h()},h(){_(D,"class","relative"),_(d,"class","flex flex-col px-3 w-full"),_(f,"class","absolute top-0 left-0 right-0 mx-auto inset-x-0 bg-transparent flex justify-center"),_(v,"class",""),_(a,"class","max-w-full mx-auto inset-x-0 relative"),_(c,"class","bg-transparent")},m(u,b){q(e,u,b),M(u,l,b),H&&H.m(u,b),M(u,t,b),q(n,u,b),M(u,i,b),M(u,c,b),L(c,a),L(a,f),L(f,d),L(d,D),C&&C.m(D,null),L(d,p),z&&z.m(d,null),L(a,k),L(a,v),S[y].m(v,null),F=!0},p(u,b){const Z={};b[0]&2048&&(Z.show=u[11]),e.$set(Z),u[6]?H?H.p(u,b):(H=ht(u),H.c(),H.m(t.parentNode,t)):H&&(H.d(1),H=null);const B={};b[0]&262144&&(B.variables=u[18]),b[0]&131072&&(B.onSave=u[17]),!r&&b[0]&65536&&(r=!0,B.show=u[16],je(()=>r=!1)),n.$set(B),u[1]===!1?C?C.p(u,b):(C=_t(u),C.c(),C.m(D,null)):C&&(C.d(1),C=null),u[2].length>0?z?(z.p(u,b),b[0]&4&&w(z,1)):(z=pt(u),z.c(),w(z,1),z.m(d,null)):z&&(te(),I(z,1,1,()=>{z=null}),le());let E=y;y=A(u),y===E?S[y].p(u,b):(te(),I(S[E],1,1,()=>{S[E]=null}),le(),T=S[y],T?T.p(u,b):(T=S[y]=x[y](u),T.c()),w(T,1),T.m(v,null))},i(u){F||(w(e.$$.fragment,u),w(n.$$.fragment,u),w(z),w(T),F=!0)},o(u){I(e.$$.fragment,u),I(n.$$.fragment,u),I(z),I(T),F=!1},d(u){u&&(m(l),m(t),m(i),m(c)),G(e,u),H&&H.d(u),G(n,u),C&&C.d(),z&&z.d(),S[y].d()}}}function ht(s){let e,l,t;return{c(){e=U("input"),this.h()},l(n){e=R(n,"INPUT",{type:!0}),this.h()},h(){_(e,"type","file"),e.hidden=!0,e.multiple=!0},m(n,r){M(n,e,r),s[39](e),l||(t=[fe(e,"change",s[40]),fe(e,"change",s[41])],l=!0)},p:oe,d(n){n&&m(e),s[39](null),l=!1,Rt(t)}}}function _t(s){let e,l,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',n,r;return{c(){e=U("div"),l=U("button"),l.innerHTML=t,this.h()},l(i){e=R(i,"DIV",{class:!0});var c=N(e);l=R(c,"BUTTON",{class:!0,"data-svelte-h":!0}),Ie(l)!=="svelte-1wiokab"&&(l.innerHTML=t),c.forEach(m),this.h()},h(){_(l,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),_(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(i,c){M(i,e,c),L(e,l),n||(r=fe(l,"click",s[43]),n=!0)},p:oe,d(i){i&&m(e),n=!1,r()}}}function pt(s){let e,l,t,n,r,i,c=s[2].map(Et).join(", ")+"",a,f,d=s[21].t("is typing...")+"",D,p,k;return t=new Bl({props:{size:"xs"}}),{c(){e=U("div"),l=U("div"),j(t.$$.fragment),n=J(),r=U("div"),i=U("span"),a=re(c),f=J(),D=re(d),this.h()},l(v){e=R(v,"DIV",{class:!0});var y=N(e);l=R(y,"DIV",{class:!0});var T=N(l);K(t.$$.fragment,T),n=X(T),r=R(T,"DIV",{});var F=N(r);i=R(F,"SPAN",{class:!0});var H=N(i);a=se(H,c),H.forEach(m),f=X(F),D=se(F,d),F.forEach(m),T.forEach(m),y.forEach(m),this.h()},h(){_(i,"class","font-normal text-black dark:text-white"),_(l,"class","text-xs px-1 mt-1.5 flex items-center gap-1.5"),_(e,"class",p="-mt-7 pb-2.5 bg-gradient-to-t to-transparent "+s[7]+" pointer-events-none select-none")},m(v,y){M(v,e,y),L(e,l),q(t,l,null),L(l,n),L(l,r),L(r,i),L(i,a),L(r,f),L(r,D),k=!0},p(v,y){(!k||y[0]&4)&&c!==(c=v[2].map(Et).join(", ")+"")&&ae(a,c),(!k||y[0]&2097152)&&d!==(d=v[21].t("is typing...")+"")&&ae(D,d),(!k||y[0]&128&&p!==(p="-mt-7 pb-2.5 bg-gradient-to-t to-transparent "+v[7]+" pointer-events-none select-none"))&&_(e,"class",p)},i(v){k||(w(t.$$.fragment,v),k=!0)},o(v){I(t.$$.fragment,v),k=!1},d(v){v&&m(e),G(t)}}}function on(s){var B;let e,l,t,n,r,i=(B=s[20])==null?void 0:B.richTextInput,c,a,f,d,D,p,k,v,y,T,F,H,ee,V=s[13].length>0&&bt(s),C=wt(s);const z=s[38].menu,x=Tt(z,s,s[58],dt),S=x||mn(s);let A=s[8]===""&&yt(s);const u=[_n,hn],b=[];function Z(E,O){return E[3]&&E[4]?0:1}return v=Z(s),y=b[v]=u[v](s),{c(){e=U("form"),l=U("div"),V&&V.c(),t=J(),n=U("div"),r=U("div"),C.c(),c=J(),a=U("div"),f=U("div"),S&&S.c(),d=J(),D=U("div"),A&&A.c(),p=J(),k=U("div"),y.c(),this.h()},l(E){e=R(E,"FORM",{class:!0});var O=N(e);l=R(O,"DIV",{class:!0,dir:!0});var Q=N(l);V&&V.l(Q),t=X(Q),n=R(Q,"DIV",{class:!0});var de=N(n);r=R(de,"DIV",{class:!0});var ce=N(r);C.l(ce),ce.forEach(m),de.forEach(m),c=X(Q),a=R(Q,"DIV",{class:!0});var me=N(a);f=R(me,"DIV",{class:!0});var Te=N(f);S&&S.l(Te),Te.forEach(m),d=X(me),D=R(me,"DIV",{class:!0});var pe=N(D);A&&A.l(pe),p=X(pe),k=R(pe,"DIV",{class:!0});var Se=N(k);y.l(Se),Se.forEach(m),pe.forEach(m),me.forEach(m),Q.forEach(m),O.forEach(m),this.h()},h(){var E;_(r,"class","scrollbar-hidden rtl:text-right ltr:text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-2.5 pb-[5px] px-1 resize-none h-fit max-h-96 overflow-auto"),_(n,"class","px-2.5"),_(f,"class","ml-1 self-end flex space-x-1 flex-1"),_(k,"class","flex items-center"),_(D,"class","self-end flex space-x-1 mr-1"),_(a,"class","flex justify-between mb-2.5 mx-0.5"),_(l,"class","flex-1 flex flex-col relative w-full shadow-lg rounded-3xl border border-gray-50 dark:border-gray-850 hover:border-gray-100 focus-within:border-gray-100 hover:dark:border-gray-800 focus-within:dark:border-gray-800 transition px-1 bg-white/90 dark:bg-gray-400/5 dark:text-gray-100"),_(l,"dir",T=((E=s[20])==null?void 0:E.chatDirection)??"auto"),_(e,"class","w-full flex gap-1.5")},m(E,O){M(E,e,O),L(e,l),V&&V.m(l,null),L(l,t),L(l,n),L(n,r),C.m(r,null),L(l,c),L(l,a),L(a,f),S&&S.m(f,null),L(a,d),L(a,D),A&&A.m(D,null),L(D,p),L(D,k),b[v].m(k,null),F=!0,H||(ee=fe(e,"submit",tl(s[57])),H=!0)},p(E,O){var de,ce;E[13].length>0?V?(V.p(E,O),O[0]&8192&&w(V,1)):(V=bt(E),V.c(),w(V,1),V.m(l,t)):V&&(te(),I(V,1,1,()=>{V=null}),le()),O[0]&1048576&&Ve(i,i=(de=E[20])==null?void 0:de.richTextInput)?(te(),I(C,1,1,oe),le(),C=wt(E),C.c(),w(C,1),C.m(r,null)):C.p(E,O),x?x.p&&(!F||O[1]&134217728)&&Ct(x,z,E,E[58],F?Dt(z,E[58],O,an):It(E[58]),dt):S&&S.p&&(!F||O[0]&16448)&&S.p(E,F?O:[-1,-1,-1]),E[8]===""?A?(A.p(E,O),O[0]&256&&w(A,1)):(A=yt(E),A.c(),w(A,1),A.m(D,p)):A&&(te(),I(A,1,1,()=>{A=null}),le());let Q=v;v=Z(E),v===Q?b[v].p(E,O):(te(),I(b[Q],1,1,()=>{b[Q]=null}),le(),y=b[v],y?y.p(E,O):(y=b[v]=u[v](E),y.c()),w(y,1),y.m(k,null)),(!F||O[0]&1048576&&T!==(T=((ce=E[20])==null?void 0:ce.chatDirection)??"auto"))&&_(l,"dir",T)},i(E){F||(w(V),w(C),w(S,E),w(A),w(y),F=!0)},o(E){I(V),I(C),I(S,E),I(A),I(y),F=!1},d(E){E&&m(e),V&&V.d(),C.d(E),S&&S.d(E),A&&A.d(),b[v].d(),H=!1,ee()}}}function cn(s){let e,l,t;function n(i){s[46](i)}let r={onCancel:s[44],onConfirm:s[45]};return s[12]!==void 0&&(r.recording=s[12]),e=new wl({props:r}),Ce.push(()=>We(e,"recording",n)),{c(){j(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,c){q(e,i,c),t=!0},p(i,c){const a={};c[0]&4097&&(a.onCancel=i[44]),c[0]&4097&&(a.onConfirm=i[45]),!l&&c[0]&4096&&(l=!0,a.recording=i[12],je(()=>l=!1)),e.$set(a)},i(i){t||(w(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function bt(s){let e,l,t=Me(s[13]),n=[];for(let i=0;i<t.length;i+=1)n[i]=vt(mt(s,t,i));const r=i=>I(n[i],1,1,()=>{n[i]=null});return{c(){e=U("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=R(i,"DIV",{class:!0});var c=N(e);for(let a=0;a<n.length;a+=1)n[a].l(c);c.forEach(m),this.h()},h(){_(e,"class","mx-2 mt-2.5 -mb-1 flex flex-wrap gap-2")},m(i,c){M(i,e,c);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null);l=!0},p(i,c){if(c[0]&8192){t=Me(i[13]);let a;for(a=0;a<t.length;a+=1){const f=mt(i,t,a);n[a]?(n[a].p(f,c),w(n[a],1)):(n[a]=vt(f),n[a].c(),w(n[a],1),n[a].m(e,null))}for(te(),a=t.length;a<n.length;a+=1)r(a);le()}},i(i){if(!l){for(let c=0;c<t.length;c+=1)w(n[c]);l=!0}},o(i){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)I(n[c]);l=!1},d(i){i&&m(e),Ut(n,i)}}}function un(s){var r;let e,l;function t(){return s[48](s[72])}function n(){return s[49](s[70])}return e=new Ul({props:{item:s[70],name:s[70].name,type:s[70].type,size:(r=s[70])==null?void 0:r.size,small:!0,loading:s[70].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",t),e.$on("click",n),{c(){j(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,c){q(e,i,c),l=!0},p(i,c){var f;s=i;const a={};c[0]&8192&&(a.item=s[70]),c[0]&8192&&(a.name=s[70].name),c[0]&8192&&(a.type=s[70].type),c[0]&8192&&(a.size=(f=s[70])==null?void 0:f.size),c[0]&8192&&(a.loading=s[70].status==="uploading"),e.$set(a)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){I(e.$$.fragment,i),l=!1},d(i){G(e,i)}}}function fn(s){let e,l,t,n,r,i,c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',a,f,d,D;t=new Rl({props:{src:s[70].url,alt:"",imageClassName:" size-10 rounded-xl object-cover"}});function p(){return s[47](s[72])}return{c(){e=U("div"),l=U("div"),j(t.$$.fragment),n=J(),r=U("div"),i=U("button"),i.innerHTML=c,a=J(),this.h()},l(k){e=R(k,"DIV",{class:!0});var v=N(e);l=R(v,"DIV",{class:!0});var y=N(l);K(t.$$.fragment,y),y.forEach(m),n=X(v),r=R(v,"DIV",{class:!0});var T=N(r);i=R(T,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Ie(i)!=="svelte-ixwiqw"&&(i.innerHTML=c),T.forEach(m),a=X(v),v.forEach(m),this.h()},h(){_(l,"class","relative"),_(i,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),_(i,"type","button"),_(r,"class","absolute -top-1 -right-1"),_(e,"class","relative group")},m(k,v){M(k,e,v),L(e,l),q(t,l,null),L(e,n),L(e,r),L(r,i),L(e,a),f=!0,d||(D=fe(i,"click",p),d=!0)},p(k,v){s=k;const y={};v[0]&8192&&(y.src=s[70].url),t.$set(y)},i(k){f||(w(t.$$.fragment,k),f=!0)},o(k){I(t.$$.fragment,k),f=!1},d(k){k&&m(e),G(t),d=!1,D()}}}function vt(s){let e,l,t,n;const r=[fn,un],i=[];function c(a,f){return a[70].type==="image"?0:1}return e=c(s),l=i[e]=r[e](s),{c(){l.c(),t=_e()},l(a){l.l(a),t=_e()},m(a,f){i[e].m(a,f),M(a,t,f),n=!0},p(a,f){let d=e;e=c(a),e===d?i[e].p(a,f):(te(),I(i[d],1,1,()=>{i[d]=null}),le(),l=i[e],l?l.p(a,f):(l=i[e]=r[e](a),l.c()),w(l,1),l.m(t.parentNode,t))},i(a){n||(w(l),n=!0)},o(a){I(l),n=!1},d(a){a&&m(t),i[e].d(a)}}}function wt(s){var n,r,i,c;let e,l,t={id:"chat-input",json:!0,messageInput:!0,richText:((n=s[20])==null?void 0:n.richTextInput)??!0,showFormattingToolbar:((r=s[20])==null?void 0:r.showFormattingToolbar)??!1,shiftEnter:!(((i=s[20])==null?void 0:i.ctrlEnterToSend)??!1)&&(!s[22]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),largeTextAsFile:((c=s[20])==null?void 0:c.largeTextAsFile)??!1,floatingMenuPlacement:"top-start",suggestions:s[19],onChange:s[50]};return e=new kl({props:t}),s[51](e),e.$on("keydown",s[52]),e.$on("paste",s[53]),{c(){j(e.$$.fragment)},l(a){K(e.$$.fragment,a)},m(a,f){q(e,a,f),l=!0},p(a,f){var D,p,k,v;const d={};f[0]&1048576&&(d.richText=((D=a[20])==null?void 0:D.richTextInput)??!0),f[0]&1048576&&(d.showFormattingToolbar=((p=a[20])==null?void 0:p.showFormattingToolbar)??!1),f[0]&5242880&&(d.shiftEnter=!(((k=a[20])==null?void 0:k.ctrlEnterToSend)??!1)&&(!a[22]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))),f[0]&1048576&&(d.largeTextAsFile=((v=a[20])==null?void 0:v.largeTextAsFile)??!1),f[0]&524288&&(d.suggestions=a[19]),f[0]&768&&(d.onChange=a[50]),e.$set(d)},i(a){l||(w(e.$$.fragment,a),l=!0)},o(a){I(e.$$.fragment,a),l=!1},d(a){s[51](null),G(e,a)}}}function kt(s){let e,l;return e=new ql({props:{screenCaptureHandler:s[26],uploadFilesHandler:s[54],$$slots:{default:[dn]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){q(e,t,n),l=!0},p(t,n){const r={};n[0]&16384&&(r.uploadFilesHandler=t[54]),n[1]&134217728&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function dn(s){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=U("button"),e.innerHTML=l,this.h()},l(t){e=R(t,"BUTTON",{class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),Ie(e)!=="svelte-7kvx70"&&(e.innerHTML=l),this.h()},h(){_(e,"class","bg-transparent hover:bg-white/80 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden"),_(e,"type","button"),_(e,"aria-label","More")},m(t,n){M(t,e,n)},p:oe,d(t){t&&m(e)}}}function mn(s){let e,l,t=s[6]&&kt(s);return{c(){t&&t.c(),e=_e()},l(n){t&&t.l(n),e=_e()},m(n,r){t&&t.m(n,r),M(n,e,r),l=!0},p(n,r){n[6]?t?(t.p(n,r),r[0]&64&&w(t,1)):(t=kt(n),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(te(),I(t,1,1,()=>{t=null}),le())},i(n){l||(w(t),l=!0)},o(n){I(t),l=!1},d(n){n&&m(e),t&&t.d(n)}}}function yt(s){let e,l;return e=new De({props:{content:s[21].t("Record voice"),$$slots:{default:[gn]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){q(e,t,n),l=!0},p(t,n){const r={};n[0]&2097152&&(r.content=t[21].t("Record voice")),n[0]&2101248|n[1]&134217728&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function gn(s){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',t,n;return{c(){e=U("button"),e.innerHTML=l,this.h()},l(r){e=R(r,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),Ie(e)!=="svelte-wjtw32"&&(e.innerHTML=l),this.h()},h(){_(e,"id","voice-input-button"),_(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),_(e,"type","button"),_(e,"aria-label","Voice Input")},m(r,i){M(r,e,i),t||(n=fe(e,"click",s[55]),t=!0)},p:oe,d(r){r&&m(e),t=!1,n()}}}function hn(s){let e,l,t;return l=new De({props:{content:s[21].t("Send message"),$$slots:{default:[pn]},$$scope:{ctx:s}}}),{c(){e=U("div"),j(l.$$.fragment),this.h()},l(n){e=R(n,"DIV",{class:!0});var r=N(e);K(l.$$.fragment,r),r.forEach(m),this.h()},h(){_(e,"class","flex items-center")},m(n,r){M(n,e,r),q(l,e,null),t=!0},p(n,r){const i={};r[0]&2097152&&(i.content=n[21].t("Send message")),r[0]&8448|r[1]&134217728&&(i.$$scope={dirty:r,ctx:n}),l.$set(i)},i(n){t||(w(l.$$.fragment,n),t=!0)},o(n){I(l.$$.fragment,n),t=!1},d(n){n&&m(e),G(l)}}}function _n(s){let e,l,t;return l=new De({props:{content:s[21].t("Stop"),$$slots:{default:[bn]},$$scope:{ctx:s}}}),{c(){e=U("div"),j(l.$$.fragment),this.h()},l(n){e=R(n,"DIV",{class:!0});var r=N(e);K(l.$$.fragment,r),r.forEach(m),this.h()},h(){_(e,"class","flex items-center")},m(n,r){M(n,e,r),q(l,e,null),t=!0},p(n,r){const i={};r[0]&2097152&&(i.content=n[21].t("Stop")),r[0]&16|r[1]&134217728&&(i.$$scope={dirty:r,ctx:n}),l.$set(i)},i(n){t||(w(l.$$.fragment,n),t=!0)},o(n){I(l.$$.fragment,n),t=!1},d(n){n&&m(e),G(l)}}}function pn(s){let e,l,t,n,r;return{c(){e=U("button"),l=nt("svg"),t=nt("path"),this.h()},l(i){e=R(i,"BUTTON",{id:!0,class:!0,type:!0});var c=N(e);l=rt(c,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=N(l);t=rt(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),N(t).forEach(m),a.forEach(m),c.forEach(m),this.h()},h(){_(t,"fill-rule","evenodd"),_(t,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),_(t,"clip-rule","evenodd"),_(l,"xmlns","http://www.w3.org/2000/svg"),_(l,"viewBox","0 0 16 16"),_(l,"fill","currentColor"),_(l,"class","size-5"),_(e,"id","send-message-button"),_(e,"class",n=(s[8]!==""||s[13].length!==0?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center"),_(e,"type","submit"),e.disabled=r=s[8]===""&&s[13].length===0},m(i,c){M(i,e,c),L(e,l),L(l,t)},p(i,c){c[0]&8448&&n!==(n=(i[8]!==""||i[13].length!==0?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center")&&_(e,"class",n),c[0]&8448&&r!==(r=i[8]===""&&i[13].length===0)&&(e.disabled=r)},d(i){i&&m(e)}}}function bn(s){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',t,n;return{c(){e=U("button"),e.innerHTML=l,this.h()},l(r){e=R(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ie(e)!=="svelte-ciuta7"&&(e.innerHTML=l),this.h()},h(){_(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(r,i){M(r,e,i),t||(n=fe(e,"click",s[56]),t=!0)},p:oe,d(r){r&&m(e),t=!1,n()}}}function vn(s){let e,l,t=s[10]&&gt(s);return{c(){t&&t.c(),e=_e()},l(n){t&&t.l(n),e=_e()},m(n,r){t&&t.m(n,r),M(n,e,r),l=!0},p(n,r){n[10]?t?(t.p(n,r),r[0]&1024&&w(t,1)):(t=gt(n),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(te(),I(t,1,1,()=>{t=null}),le())},i(n){l||(w(t),l=!0)},o(n){I(t),l=!1},d(n){n&&m(e),t&&t.d(n)}}}const Et=s=>s.name;function wn(s,e,l){let t,n,r,i;he(s,rl,o=>l(20,t=o)),he(s,sl,o=>l(60,r=o)),he(s,al,o=>l(22,i=o));let{$$slots:c={},$$scope:a}=e;const f=Ke("i18n");he(s,f,o=>l(21,n=o));let{placeholder:d=n.t("Send a Message")}=e,{id:D=null}=e,{chatInputElement:p}=e,{typingUsers:k=[]}=e,{inputLoading:v=!1}=e,{onSubmit:y=o=>{}}=e,{onChange:T=o=>{}}=e,{onStop:F=o=>{}}=e,{scrollEnd:H=!0}=e,{scrollToBottom:ee=()=>{}}=e,{acceptFiles:V=!0}=e,{showFormattingToolbar:C=!0}=e,{userSuggestions:z=!1}=e,{channelSuggestions:x=!1}=e,{typingUsersClassName:S="from-white dark:from-gray-900"}=e,A=!1,u=!1,b=!1,Z="",B=[],E,O,Q=!1,de,ce={},me={};const Te=async o=>(l(18,ce=ul(o)),Object.keys(ce).length===0?o:(l(16,Q=!0),await new Promise(g=>{l(17,de=h=>{me={...me,...h},Se(me),l(16,Q=!1),g(o)})}))),pe=async o=>{if(o.includes("{{CLIPBOARD}}")){const h=await navigator.clipboard.readText().catch(ne=>(ue.error(n.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),W=await navigator.clipboard.read();let Y=null;for(const ne of W)for(const be of ne.types)if(be.startsWith("image/")){const ve=await ne.getType(be);Y=URL.createObjectURL(ve)}Y&&l(13,B=[...B,{type:"image",url:Y}]),o=o.replaceAll("{{CLIPBOARD}}",h)}if(o.includes("{{USER_LOCATION}}")){let h;try{h=await fl()}catch{ue.error(n.t("Location access not allowed")),h="LOCATION_UNKNOWN"}o=o.replaceAll("{{USER_LOCATION}}",String(h))}const g=await vl(localStorage.token);if(o.includes("{{USER_NAME}}")){const h=(g==null?void 0:g.name)||"User";o=o.replaceAll("{{USER_NAME}}",h)}if(o.includes("{{USER_BIO}}")){const h=(g==null?void 0:g.bio)||"";h&&(o=o.replaceAll("{{USER_BIO}}",h))}if(o.includes("{{USER_GENDER}}")){const h=(g==null?void 0:g.gender)||"";h&&(o=o.replaceAll("{{USER_GENDER}}",h))}if(o.includes("{{USER_BIRTH_DATE}}")){const h=(g==null?void 0:g.date_of_birth)||"";h&&(o=o.replaceAll("{{USER_BIRTH_DATE}}",h))}if(o.includes("{{USER_AGE}}")){const h=(g==null?void 0:g.date_of_birth)||"";if(h){const W=dl(h);o=o.replaceAll("{{USER_AGE}}",W)}}if(o.includes("{{USER_LANGUAGE}}")){const h=localStorage.getItem("locale")||"en-US";o=o.replaceAll("{{USER_LANGUAGE}}",h)}if(o.includes("{{CURRENT_DATE}}")){const h=ml();o=o.replaceAll("{{CURRENT_DATE}}",h)}if(o.includes("{{CURRENT_TIME}}")){const h=gl();o=o.replaceAll("{{CURRENT_TIME}}",h)}if(o.includes("{{CURRENT_DATETIME}}")){const h=hl();o=o.replaceAll("{{CURRENT_DATETIME}}",h)}if(o.includes("{{CURRENT_TIMEZONE}}")){const h=_l();o=o.replaceAll("{{CURRENT_TIMEZONE}}",h)}if(o.includes("{{CURRENT_WEEKDAY}}")){const h=pl();o=o.replaceAll("{{CURRENT_WEEKDAY}}",h)}return o},Se=o=>{document.getElementById("chat-input")&&(p.replaceVariables(o),p.focus())},Lt=async(o,g)=>{document.getElementById("chat-input")&&(o!==""&&(o=await pe(o||"")),p==null||p.setText(o),p==null||p.focus(),o!==""&&(o=await Te(o)),await ie(),g&&await g(o))},qe=()=>{const o=document.getElementById("chat-input");let g="";return o&&(g=p==null?void 0:p.getWordAtDocPos()),g},Mt=o=>{document.getElementById("chat-input")&&(p==null||p.replaceCommandWithText(o))},Ne=async o=>{const g=document.getElementById("chat-input");if(!g)return;o=await pe(o),we?Mt(o):p==null||p.insertContent(o),await ie(),o=await Te(o),await ie();const h=document.getElementById("chat-input-container");h&&(h.scrollTop=h.scrollHeight),await ie(),g&&(g.focus(),g.dispatchEvent(new Event("input")),il(prompt).length>0?await ie():g.scrollTop=g.scrollHeight)};let we="",{showCommands:Be=!1}=e,Ge=null;const Vt=async()=>{try{const o=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),g=document.createElement("video");g.srcObject=o,await g.play();const h=document.createElement("canvas");h.width=g.videoWidth,h.height=g.videoHeight,h.getContext("2d").drawImage(g,0,0,h.width,h.height),o.getTracks().forEach(ne=>ne.stop()),window.focus();const Y=h.toDataURL("image/png");l(13,B=[...B,{type:"image",url:Y}]),g.srcObject=null}catch(o){}},Ae=async o=>{o.forEach(async g=>{var h,W,Y,ne;if(console.info("Processing file:",{name:g.name,type:g.type,size:g.size,extension:g.name.split(".").at(-1)}),(((h=r==null?void 0:r.file)==null?void 0:h.max_size)??null)!==null&&g.size>(((W=r==null?void 0:r.file)==null?void 0:W.max_size)??0)*1024*1024){g.size,(((Y=r==null?void 0:r.file)==null?void 0:Y.max_size)??0)*1024*1024,ue.error(n.t("File size should not exceed {{maxSize}} MB.",{maxSize:(ne=r==null?void 0:r.file)==null?void 0:ne.max_size}));return}if(g.type.startsWith("image/")){const be=async(ge,$={},P={})=>{var Qe,$e,xe,et,tt,lt;const ke=($==null?void 0:$.imageCompression)??!1,Ue=(($e=(Qe=P==null?void 0:P.file)==null?void 0:Qe.image_compression)==null?void 0:$e.width)??null,Re=((et=(xe=P==null?void 0:P.file)==null?void 0:xe.image_compression)==null?void 0:et.height)??null;if(!ke&&!Ue&&!Re)return ge;let ye=null,Ee=null;return ke&&(ye=((tt=$==null?void 0:$.imageCompressionSize)==null?void 0:tt.width)??null,Ee=((lt=$==null?void 0:$.imageCompressionSize)==null?void 0:lt.height)??null),Ue&&(ye===null||ye>Ue)&&(ye=Ue),Re&&(Ee===null||Ee>Re)&&(Ee=Re),ye||Ee?await bl(ge,ye,Ee):ge};let ve=new FileReader;ve.onload=async ge=>{let $=ge.target.result;t!=null&&t.imageCompression&&(t!=null&&t.imageCompressionInChannels)&&($=await be($,t,r)),l(13,B=[...B,{type:"image",url:`${$}`}])},ve.readAsDataURL(g.type==="image/heic"?await ol(g):g)}else Nt(g)})},Nt=async o=>{var W,Y,ne,be,ve,ge;const g=cl(),h={type:"file",file:"",id:null,url:"",name:o.name,collection_name:"",status:"uploading",size:o.size,error:"",itemId:g};if(h.size==0)return ue.error(n.t("You cannot upload an empty file.")),null;l(13,B=[...B,h]);try{let $=null;(o.type.startsWith("audio/")||o.type.startsWith("video/"))&&((Y=(W=t==null?void 0:t.audio)==null?void 0:W.stt)!=null&&Y.language)&&($={language:(be=(ne=t==null?void 0:t.audio)==null?void 0:ne.stt)==null?void 0:be.language});const P=await Al(localStorage.token,o,$);P?(console.info("File upload completed:",{id:P.id,name:h.name,collection:(ve=P==null?void 0:P.meta)==null?void 0:ve.collection_name}),P.error&&(P.error,ue.warning(P.error)),h.status="uploaded",h.file=P,h.id=P.id,h.collection_name=((ge=P==null?void 0:P.meta)==null?void 0:ge.collection_name)||(P==null?void 0:P.collection_name),h.url=`${ze}/files/${P.id}`,l(13,B)):l(13,B=B.filter(ke=>(ke==null?void 0:ke.itemId)!==g))}catch($){ue.error(`${$}`),l(13,B=B.filter(P=>(P==null?void 0:P.itemId)!==g))}},Ze=o=>{o.key==="Escape"&&l(11,u=!1)},Ye=o=>{var g,h;o.preventDefault(),(h=(g=o.dataTransfer)==null?void 0:g.types)!=null&&h.includes("Files")?l(11,u=!0):l(11,u=!1)},Je=()=>{l(11,u=!1)},Xe=async o=>{var g,h;if(o.preventDefault(),(g=o.dataTransfer)!=null&&g.files&&V){const W=Array.from((h=o.dataTransfer)==null?void 0:h.files);W&&W.length>0&&Ae(W)}l(11,u=!1)},Fe=async()=>{Z===""&&B.length===0||(y({content:Z,data:{files:B}}),l(8,Z=""),l(13,B=[]),p&&(p==null||p.setText(""),await ie(),p.focus()))};St(async()=>{l(19,Ge=[{char:"@",render:He(ft,{i18n:f,triggerChar:"@",modelSuggestions:!0,userSuggestions:z})},...x?[{char:"#",render:He(ft,{i18n:f,triggerChar:"#",channelSuggestions:x})}]:[],{char:"/",render:He(Sl,{i18n:f,onSelect:g=>{var Y;const{type:h,data:W}=g;(Y=document.getElementById("chat-input"))==null||Y.focus()},insertTextHandler:Ne,onUpload:g=>{const{type:h,data:W}=g;if(h==="file"){if(B.find(Y=>Y.id===W.id))return;l(13,B=[...B,{...W,status:"processed"}])}}})}]),l(10,A=!0),window.setTimeout(()=>{p&&p.focus()},100),window.addEventListener("keydown",Ze),await ie();const o=document.getElementById("channel-container");o==null||o.addEventListener("dragover",Ye),o==null||o.addEventListener("drop",Xe),o==null||o.addEventListener("dragleave",Je)}),At(()=>{window.removeEventListener("keydown",Ze);const o=document.getElementById("channel-container");o&&(o==null||o.removeEventListener("dragover",Ye),o==null||o.removeEventListener("drop",Xe),o==null||o.removeEventListener("dragleave",Je))});function Bt(o){Ce[o?"unshift":"push"](()=>{E=o,l(14,E)})}function Ft(){O=this.files,l(15,O)}const Ht=async()=>{O&&O.length>0?Ae(Array.from(O)):ue.error(n.t("File not found.")),l(14,E.value="",E)};function zt(o){Q=o,l(16,Q)}const Ot=()=>{l(1,H=!0),ee()},Pt=async()=>{l(12,b=!1),await ie(),p&&p.focus()},Wt=async o=>{const{text:g,filename:h}=o;l(12,b=!1),await ie(),Ne(g),await ie(),p&&p.focus()};function jt(o){b=o,l(12,b)}const Kt=o=>{B.splice(o,1),l(13,B)},qt=o=>{B.splice(o,1),l(13,B)},Gt=o=>{},Zt=o=>{const{md:g}=o;l(8,Z=g),l(9,we=qe())};function Yt(o){Ce[o?"unshift":"push"](()=>{p=o,l(0,p)})}const Jt=async o=>{o=o.detail.event,o.ctrlKey||o.metaKey,document.getElementById("suggestions-container")||(!i||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(o.keyCode===13&&!o.shiftKey&&o.preventDefault(),Z!==""&&o.keyCode===13&&!o.shiftKey&&Fe()),o.key==="Escape"&&console.info("Escape")},Xt=async o=>{o=o.detail.event;const g=o.clipboardData||window.clipboardData;if(g&&g.items){for(const h of g.items)if(h.type.indexOf("image")!==-1){const W=h.getAsFile(),Y=new FileReader;Y.onload=function(ne){l(13,B=[...B,{type:"image",url:`${ne.target.result}`}])},Y.readAsDataURL(W)}else if((h==null?void 0:h.kind)==="file"){const W=h.getAsFile();W&&(await Ae([W]),o.preventDefault())}}},Qt=()=>{E.click()},$t=async()=>{try{let o=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(g){return ue.error(n.t("Permission denied when accessing microphone: {{error}}",{error:g})),null});o&&(l(12,b=!0),o.getTracks().forEach(h=>h.stop())),o=null}catch{ue.error(n.t("Permission denied when accessing microphone"))}},xt=()=>{F()},el=()=>{Fe()};return s.$$set=o=>{"placeholder"in o&&l(30,d=o.placeholder),"id"in o&&l(31,D=o.id),"chatInputElement"in o&&l(0,p=o.chatInputElement),"typingUsers"in o&&l(2,k=o.typingUsers),"inputLoading"in o&&l(3,v=o.inputLoading),"onSubmit"in o&&l(32,y=o.onSubmit),"onChange"in o&&l(33,T=o.onChange),"onStop"in o&&l(4,F=o.onStop),"scrollEnd"in o&&l(1,H=o.scrollEnd),"scrollToBottom"in o&&l(5,ee=o.scrollToBottom),"acceptFiles"in o&&l(6,V=o.acceptFiles),"showFormattingToolbar"in o&&l(34,C=o.showFormattingToolbar),"userSuggestions"in o&&l(35,z=o.userSuggestions),"channelSuggestions"in o&&l(36,x=o.channelSuggestions),"typingUsersClassName"in o&&l(7,S=o.typingUsersClassName),"showCommands"in o&&l(29,Be=o.showCommands),"$$scope"in o&&l(58,a=o.$$scope)},s.$$.update=()=>{s.$$.dirty[0]&512&&l(29,Be=["/"].includes(we==null?void 0:we.charAt(0))),s.$$.dirty[0]&256|s.$$.dirty[1]&4&&Z&&T()},[p,H,k,v,F,ee,V,S,Z,we,A,u,b,B,E,O,Q,de,ce,Ge,t,n,i,f,qe,Ne,Vt,Ae,Fe,Be,d,D,y,T,C,z,x,Lt,c,Bt,Ft,Ht,zt,Ot,Pt,Wt,jt,Kt,qt,Gt,Zt,Yt,Jt,Xt,Qt,$t,xt,el,a]}class Pn extends Oe{constructor(e){super(),Pe(this,e,wn,vn,Ve,{placeholder:30,id:31,chatInputElement:0,typingUsers:2,inputLoading:3,onSubmit:32,onChange:33,onStop:4,scrollEnd:1,scrollToBottom:5,acceptFiles:6,showFormattingToolbar:34,userSuggestions:35,channelSuggestions:36,typingUsersClassName:7,setText:37,showCommands:29},null,[-1,-1,-1])}get setText(){return this.$$.ctx[37]}}export{Pn as M};
//# sourceMappingURL=xGQDcV1N.js.map

<!-- API Key Generated Success Response for HTMX -->
<div class="notification is-success" x-data="{ visible: true }" x-show="visible" x-transition>
    <button class="delete" @click="visible = false"></button>
    <p class="has-text-weight-bold">
        <span class="icon">
            <i class="fas fa-check-circle"></i>
        </span>
        API Key Generated Successfully!
    </p>
    <div class="content mt-3">
        <div class="notification is-warning">
            <p class="has-text-weight-bold">
                <span class="icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </span>
                Important: Save your API key now!
            </p>
            <p>This is the only time you will see your API key. Copy it now and store it securely.</p>
        </div>
        
        <div class="field" x-data="{ 
            copied: false,
            async copyKey() {
                try {
                    await navigator.clipboard.writeText('{{ full_key|escapejs }}');
                    this.copied = true;
                    setTimeout(() => this.copied = false, 2000);
                } catch (err) {
                    // Fallback for older browsers
                    this.$refs.apiKeyInput.select();
                    document.execCommand('copy');
                    this.copied = true;
                    setTimeout(() => this.copied = false, 2000);
                }
            }
        }" x-init="setTimeout(() => $refs.apiKeyInput.select(), 100)">
            <label class="label">Your New API Key</label>
            <div class="field has-addons">
                <div class="control is-expanded">
                    <input 
                        class="input is-family-monospace" 
                        type="text" 
                        value="{{ full_key }}" 
                        readonly 
                        x-ref="apiKeyInput"
                    >
                </div>
                <div class="control">
                    <button 
                        class="button is-primary" 
                        @click="copyKey()"
                        :class="{ 'is-success': copied }"
                    >
                        <span class="icon">
                            <i class="fas" :class="copied ? 'fa-check' : 'fa-copy'"></i>
                        </span>
                        <span x-text="copied ? 'Copied!' : 'Copy'"></span>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="content">
            <p><strong>Key Details:</strong></p>
            <ul>
                <li><strong>Name:</strong> {{ api_key.name|default:"Unnamed Key" }}</li>
                <li><strong>Key ID:</strong> <code>{{ api_key.prefix }}...****</code></li>
                <li><strong>Created:</strong> {{ api_key.created_at|date:'F j, Y \a\t g:i A' }}</li>
            </ul>
        </div>
    </div>
</div>

<!-- Include the updated API keys list -->
{% include "users/partials/api_keys_list.html" %}

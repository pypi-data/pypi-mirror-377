name: Publish to PyPI

on:
    push:
        tags:
            - 'v*'

jobs:
    release:
        name: Publish to PyPI
        runs-on: ubuntu-latest
        environment: pypi
        permissions:
            id-token: write
            contents: read
        steps:
            - uses: actions/checkout@v5
              with:
                  fetch-depth: 0 # Fetch full history so hatch-vcs can find tags

            - name: Install uv and setup the python version
              uses: astral-sh/setup-uv@v5

            - name: Install the project
              run: uv sync --all-groups

            - name: Build wheel
              run: uv build

            - name: Publish package
              run: uv publish

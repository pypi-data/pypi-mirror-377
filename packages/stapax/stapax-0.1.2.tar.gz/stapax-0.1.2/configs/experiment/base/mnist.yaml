# @package _global_

defaults:
    - /dataset: mnist_seq
    - _self_

train:
    lr:
        name: warmup_cosine_decay_schedule
        init_value: 1e-4
        peak_value: 1e-3
        warmup_steps: 500
        decay_steps: 5000
    #max_epochs: 60
    max_steps: 10
    batch_size: 80
    val_check_interval: 300
    checkpoint:
        every_n_steps: 5
        metric: 'val/classification/one_hot_accuracy'
    early_stopping:
        metric: 'val/classification/one_hot_accuracy'

model:
    heads:
        - name: 'classification'
          metrics: ['one_hot_accuracy']
          loss_fns:
              - name: 'cross_entropy'

<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>UCI Parse Library &#8212; uciparse 0.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=6625fa76" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=ec641305" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <script src="_static/documentation_options.js?v=938c9ccc"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="autoapi/index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="uci-parse-library">
<h1>UCI Parse Library<a class="headerlink" href="#uci-parse-library" title="Link to this heading">¶</a></h1>
<p>Release v0.2.0</p>
<a class="reference external image-reference" href="https://pypi.org/project/uciparse/"><img alt="https://img.shields.io/pypi/v/uciparse.svg" src="https://img.shields.io/pypi/v/uciparse.svg" />
</a>
<a class="reference external image-reference" href="https://github.com/pronovic/uci-parse/blob/main/LICENSE"><img alt="https://img.shields.io/pypi/l/uciparse.svg" src="https://img.shields.io/pypi/l/uciparse.svg" />
</a>
<a class="reference external image-reference" href="https://pypi.org/project/uciparse/"><img alt="https://img.shields.io/pypi/wheel/uciparse.svg" src="https://img.shields.io/pypi/wheel/uciparse.svg" />
</a>
<a class="reference external image-reference" href="https://pypi.org/project/uciparse/"><img alt="https://img.shields.io/pypi/pyversions/uciparse.svg" src="https://img.shields.io/pypi/pyversions/uciparse.svg" />
</a>
<a class="reference external image-reference" href="https://github.com/pronovic/uci-parse/actions?query=workflow%3A%22Test+Suite%22"><img alt="https://github.com/pronovic/uci-parse/workflows/Test%20Suite/badge.svg" src="https://github.com/pronovic/uci-parse/workflows/Test%20Suite/badge.svg" />
</a>
<a class="reference external image-reference" href="https://uci-parse.readthedocs.io/en/stable/"><img alt="https://readthedocs.org/projects/uci-parse/badge/?version=stable&amp;style=flat" src="https://readthedocs.org/projects/uci-parse/badge/?version=stable&amp;style=flat" />
</a>
<a class="reference external image-reference" href="https://coveralls.io/github/pronovic/uci-parse?branch=main"><img alt="https://coveralls.io/repos/github/pronovic/uci-parse/badge.svg?branch=main" src="https://coveralls.io/repos/github/pronovic/uci-parse/badge.svg?branch=main" />
</a>
<p>Python 3 library and command line tools to parse, diff, and normalize OpenWRT
<a class="reference external" href="https://openwrt.org/docs/guide-user/base-system/uci">UCI</a> configuration files.</p>
<p>These tools were written to ease OpenWRT upgrades, making it easier to see the
differences between two config files.  As of this writing (mid-2020), OpenWRT
upgrades often don’t normalize upgraded config files in the same way from
version to version.  For instance, the new version from <code class="docutils literal notranslate"><span class="pre">opkg</span> <span class="pre">upgrade</span></code> (saved
off with a <code class="docutils literal notranslate"><span class="pre">-opkg</span></code> filename) might use single quotes on all lines, while the
original version on disk might not use quotes at all.  This makes it very
difficult understand the often-minimal differences between an upgraded file and
the original file.</p>
<section id="developer-documentation">
<h2>Developer Documentation<a class="headerlink" href="#developer-documentation" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="autoapi/tests/index.html">tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoapi/uciparse/index.html">uciparse</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="installing-the-package">
<h2>Installing the Package<a class="headerlink" href="#installing-the-package" title="Link to this heading">¶</a></h2>
<p>Installing this package on your OpenWRT router is not as simple as it could be.
A lot of routers do not have enough space available to install a full version
of Python including <code class="docutils literal notranslate"><span class="pre">pip</span></code> or <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>.  If yours does have lots of
space, it’s as simple as this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ opkg update
$ opkg install python3-pip
$ pip3 install uciparse
</pre></div>
</div>
<p>If not, it gets a little ugly.  First, install <code class="docutils literal notranslate"><span class="pre">wget</span></code> with support for HTTPS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ opkg update
$ opkg install wget ca-bundle ca-certificates
</pre></div>
</div>
<p>Then, go to <a class="reference external" href="https://pypi.org/project/uciparse/#files">PyPI</a> and copy the URL for the source package <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> file.
Retrieve the source package with <code class="docutils literal notranslate"><span class="pre">wget</span></code> and then manually extract it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://files.pythonhosted.org/.../uciparse-0.1.2.tar.gz
$ tar zxvf uciparse-0.1.2.tar.gz
$ cd uciparse-0.1.2
</pre></div>
</div>
<p>Finally, run the custom install script provided with the source package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sh ./scripts/install
</pre></div>
</div>
<p>This installs the OpenWRT <code class="docutils literal notranslate"><span class="pre">python3-light</span></code> package, then copies the Python
packages into the right <code class="docutils literal notranslate"><span class="pre">site-packages</span></code> directory and the <code class="docutils literal notranslate"><span class="pre">uciparse</span></code> and
<code class="docutils literal notranslate"><span class="pre">ucidiff</span></code> scripts to <code class="docutils literal notranslate"><span class="pre">/usr/bin</span></code>.</p>
</section>
<section id="using-the-tools">
<h2>Using the Tools<a class="headerlink" href="#using-the-tools" title="Link to this heading">¶</a></h2>
<p>Once you have installed the package as described above, the <code class="docutils literal notranslate"><span class="pre">uciparse</span></code> and
<code class="docutils literal notranslate"><span class="pre">ucidiff</span></code> tools will be available in your path.</p>
<section id="ucidiff">
<h3>ucidiff<a class="headerlink" href="#ucidiff" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ucidiff</span></code> tool is probably the tool you’ll use most often when updating
your router.  It reads two UCI configuration files from disk, normalizes both in
memory (without making changes on disk), and then compares them.  The result is
a unified diff, like <code class="docutils literal notranslate"><span class="pre">diff</span> <span class="pre">-Naur</span></code>.  This gives you a way to understand the real
differences between two files without ever having to change anything on disk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ucidiff --help
usage: ucidiff [-h] a b

Diff two UCI configuration files.

positional arguments:
  a           Path to the first UCI file to compare
  b           Path to the second UCI file to compare

optional arguments:
  -h, --help  show this help message and exit

The comparison is equivalent to a &#39;diff -Naur&#39; between the normalized versions
of the files. If either file can&#39;t be parsed, then an error will be returned
and no diff will be shown.
</pre></div>
</div>
</section>
<section id="uciparse">
<h3>uciparse<a class="headerlink" href="#uciparse" title="Link to this heading">¶</a></h3>
<p>If you would prefer to clean up and normalize your configuration files on disk,
then you can use the <code class="docutils literal notranslate"><span class="pre">uciparse</span></code> tool.  It reads a UCI config file from disk or
from <code class="docutils literal notranslate"><span class="pre">stdin</span></code>, parses it, and prints normalized output to <code class="docutils literal notranslate"><span class="pre">stdout</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ uciparse --help
usage: uciparse [-h] uci

Parse and normalize a UCI configuration file.

positional arguments:
  uci         Path to the UCI file to normalize, or &#39;-&#39; for stdin

optional arguments:
  -h, --help  show this help message and exit

Results will be printed to stdout. If the file can&#39;t be parsed then an error
will be returned and no output will be generated.
</pre></div>
</div>
<p>Before using <code class="docutils literal notranslate"><span class="pre">uciparse</span></code>, you should make a backup of any config file that you
are going to normalized.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">uciparse</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=pronovic&repo=uci-parse&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="autoapi/index.html" title="next chapter">API Reference</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;(c) Kenneth J. Pronovici.
      
    </div>

    
    <a href="https://github.com/pronovic/uci-parse" class="github">
        <img src="_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>